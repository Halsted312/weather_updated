nohup: ignoring input
14:09:53 [INFO] __main__: ============================================================
14:09:53 [INFO] __main__: CHICAGO Optuna Training (150 trials)
14:09:53 [INFO] __main__: Optimization objective: auc
14:09:53 [INFO] __main__: ============================================================
14:09:53 [INFO] __main__: Loading from training cache: data/training_cache/chicago/full.parquet
14:09:54 [INFO] __main__: Loaded 486,912 rows, 237 columns
14:09:54 [INFO] __main__: Data range after filtering: 2023-01-01 to 2025-12-03
14:09:55 [INFO] __main__: Total days: 1068
14:09:55 [INFO] __main__: Training: 2023-01-01 to 2025-05-04 (855 days)
14:09:55 [INFO] __main__: Testing:  2025-05-05 to 2025-12-03 (213 days)
14:09:55 [INFO] __main__: 
Training samples: 389,784
14:09:55 [INFO] __main__: Training days: 855
14:09:55 [INFO] __main__: Test samples: 97,128
14:09:55 [INFO] __main__: Test days: 213
14:09:55 [INFO] __main__: 
Station-city features: ['station_city_temp_gap', 'station_city_max_gap_sofar', 'station_city_mean_gap_sofar', 'station_city_gap_std', 'station_city_gap_trend', 'station_city_gap_x_fcst_gap']
14:09:55 [INFO] __main__:   station_city_temp_gap: 389,592/389,784 non-null (100.0%)
14:09:55 [INFO] __main__:   station_city_max_gap_sofar: 389,592/389,784 non-null (100.0%)
14:09:55 [INFO] __main__:   station_city_mean_gap_sofar: 389,592/389,784 non-null (100.0%)
14:09:55 [INFO] __main__:   station_city_gap_std: 389,592/389,784 non-null (100.0%)
14:09:55 [INFO] __main__:   station_city_gap_trend: 389,583/389,784 non-null (99.9%)
14:09:55 [INFO] __main__:   station_city_gap_x_fcst_gap: 388,680/389,784 non-null (99.7%)
14:09:55 [INFO] __main__: 
Multi-horizon features: ['fcst_multi_mean', 'fcst_multi_median', 'fcst_multi_ema', 'fcst_multi_std', 'fcst_multi_range', 'fcst_multi_t1_t2_diff', 'fcst_multi_drift', 'fcst_multi_cv', 'fcst_multi_range_pct']
14:09:55 [INFO] __main__:   fcst_multi_mean: 389,784/389,784 non-null (100.0%)
14:09:55 [INFO] __main__:   fcst_multi_median: 389,784/389,784 non-null (100.0%)
14:09:55 [INFO] __main__:   fcst_multi_ema: 389,784/389,784 non-null (100.0%)
14:09:55 [INFO] __main__:   fcst_multi_std: 389,784/389,784 non-null (100.0%)
14:09:55 [INFO] __main__:   fcst_multi_range: 389,784/389,784 non-null (100.0%)
14:09:55 [INFO] __main__:   fcst_multi_t1_t2_diff: 387,960/389,784 non-null (99.5%)
14:09:55 [INFO] __main__:   fcst_multi_drift: 387,960/389,784 non-null (99.5%)
14:09:55 [INFO] __main__:   fcst_multi_cv: 389,784/389,784 non-null (100.0%)
14:09:55 [INFO] __main__:   fcst_multi_range_pct: 389,784/389,784 non-null (100.0%)
14:09:57 [INFO] models.training.ordinal_trainer: Training ordinal model (catboost) on 389784 samples
14:09:57 [INFO] models.training.ordinal_trainer: City delta range: [-12, 12]
14:09:57 [INFO] models.training.ordinal_trainer: Training 24 threshold classifiers: [-11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12]
14:09:57 [INFO] models.training.ordinal_trainer: Starting Optuna tuning with 150 trials (objective=auc)

============================================================
OPTUNA TRAINING (150 trials, objective=auc)
============================================================
  0%|          | 0/150 [00:00<?, ?it/s]Best trial: 0. Best value: 0.916967:   0%|          | 0/150 [00:25<?, ?it/s]Best trial: 0. Best value: 0.916967:   1%|          | 1/150 [00:25<1:04:27, 25.95s/it]Best trial: 1. Best value: 0.938277:   1%|          | 1/150 [00:37<1:04:27, 25.95s/it]Best trial: 1. Best value: 0.938277:   1%|▏         | 2/150 [00:37<43:21, 17.58s/it]  Best trial: 1. Best value: 0.938277:   1%|▏         | 2/150 [01:06<43:21, 17.58s/it]Best trial: 1. Best value: 0.938277:   2%|▏         | 3/150 [01:06<56:08, 22.92s/it]Best trial: 1. Best value: 0.938277:   2%|▏         | 3/150 [01:38<56:08, 22.92s/it]Best trial: 1. Best value: 0.938277:   3%|▎         | 4/150 [01:38<1:04:19, 26.43s/it]Best trial: 1. Best value: 0.938277:   3%|▎         | 4/150 [02:05<1:04:19, 26.43s/it]Best trial: 1. Best value: 0.938277:   3%|▎         | 5/150 [02:05<1:03:58, 26.47s/it]Best trial: 1. Best value: 0.938277:   3%|▎         | 5/150 [02:58<1:03:58, 26.47s/it]Best trial: 1. Best value: 0.938277:   4%|▍         | 6/150 [02:58<1:25:35, 35.67s/it]Best trial: 6. Best value: 0.940449:   4%|▍         | 6/150 [03:12<1:25:35, 35.67s/it]Best trial: 6. Best value: 0.940449:   5%|▍         | 7/150 [03:12<1:08:07, 28.58s/it]Best trial: 6. Best value: 0.940449:   5%|▍         | 7/150 [03:27<1:08:07, 28.58s/it]Best trial: 6. Best value: 0.940449:   5%|▌         | 8/150 [03:27<57:16, 24.20s/it]  Best trial: 6. Best value: 0.940449:   5%|▌         | 8/150 [03:43<57:16, 24.20s/it]Best trial: 6. Best value: 0.940449:   6%|▌         | 9/150 [03:43<50:32, 21.51s/it]Best trial: 6. Best value: 0.940449:   6%|▌         | 9/150 [04:07<50:32, 21.51s/it]Best trial: 6. Best value: 0.940449:   7%|▋         | 10/150 [04:07<52:31, 22.51s/it]Best trial: 6. Best value: 0.940449:   7%|▋         | 10/150 [04:18<52:31, 22.51s/it]Best trial: 6. Best value: 0.940449:   7%|▋         | 11/150 [04:18<43:38, 18.84s/it]Best trial: 6. Best value: 0.940449:   7%|▋         | 11/150 [04:31<43:38, 18.84s/it]Best trial: 6. Best value: 0.940449:   8%|▊         | 12/150 [04:31<39:03, 16.98s/it]Best trial: 6. Best value: 0.940449:   8%|▊         | 12/150 [04:44<39:03, 16.98s/it]Best trial: 6. Best value: 0.940449:   9%|▊         | 13/150 [04:44<36:13, 15.86s/it]Best trial: 6. Best value: 0.940449:   9%|▊         | 13/150 [05:04<36:13, 15.86s/it]Best trial: 6. Best value: 0.940449:   9%|▉         | 14/150 [05:04<38:35, 17.03s/it]Best trial: 6. Best value: 0.940449:   9%|▉         | 14/150 [05:15<38:35, 17.03s/it]Best trial: 6. Best value: 0.940449:  10%|█         | 15/150 [05:15<34:43, 15.43s/it]Best trial: 6. Best value: 0.940449:  10%|█         | 15/150 [06:05<34:43, 15.43s/it]Best trial: 6. Best value: 0.940449:  11%|█         | 16/150 [06:05<57:41, 25.83s/it]Best trial: 6. Best value: 0.940449:  11%|█         | 16/150 [06:19<57:41, 25.83s/it]Best trial: 6. Best value: 0.940449:  11%|█▏        | 17/150 [06:19<48:53, 22.05s/it]Best trial: 6. Best value: 0.940449:  11%|█▏        | 17/150 [06:48<48:53, 22.05s/it]Best trial: 6. Best value: 0.940449:  12%|█▏        | 18/150 [06:48<53:22, 24.26s/it]Best trial: 6. Best value: 0.940449:  12%|█▏        | 18/150 [07:15<53:22, 24.26s/it]Best trial: 6. Best value: 0.940449:  13%|█▎        | 19/150 [07:15<54:47, 25.09s/it]Best trial: 6. Best value: 0.940449:  13%|█▎        | 19/150 [07:25<54:47, 25.09s/it]Best trial: 6. Best value: 0.940449:  13%|█▎        | 20/150 [07:25<44:30, 20.54s/it]Best trial: 6. Best value: 0.940449:  13%|█▎        | 20/150 [07:39<44:30, 20.54s/it]Best trial: 6. Best value: 0.940449:  14%|█▍        | 21/150 [07:39<39:57, 18.58s/it]Best trial: 6. Best value: 0.940449:  14%|█▍        | 21/150 [07:54<39:57, 18.58s/it]Best trial: 6. Best value: 0.940449:  15%|█▍        | 22/150 [07:54<37:12, 17.44s/it]Best trial: 6. Best value: 0.940449:  15%|█▍        | 22/150 [08:08<37:12, 17.44s/it]Best trial: 6. Best value: 0.940449:  15%|█▌        | 23/150 [08:08<34:54, 16.50s/it]Best trial: 6. Best value: 0.940449:  15%|█▌        | 23/150 [08:20<34:54, 16.50s/it]Best trial: 6. Best value: 0.940449:  16%|█▌        | 24/150 [08:20<31:52, 15.18s/it]Best trial: 6. Best value: 0.940449:  16%|█▌        | 24/150 [08:36<31:52, 15.18s/it]Best trial: 6. Best value: 0.940449:  17%|█▋        | 25/150 [08:36<31:58, 15.35s/it]Best trial: 6. Best value: 0.940449:  17%|█▋        | 25/150 [08:50<31:58, 15.35s/it]Best trial: 6. Best value: 0.940449:  17%|█▋        | 26/150 [08:50<30:45, 14.88s/it]Best trial: 6. Best value: 0.940449:  17%|█▋        | 26/150 [09:05<30:45, 14.88s/it]Best trial: 6. Best value: 0.940449:  18%|█▊        | 27/150 [09:05<30:31, 14.89s/it]Best trial: 6. Best value: 0.940449:  18%|█▊        | 27/150 [09:18<30:31, 14.89s/it]Best trial: 6. Best value: 0.940449:  19%|█▊        | 28/150 [09:18<29:14, 14.38s/it]Best trial: 6. Best value: 0.940449:  19%|█▊        | 28/150 [09:32<29:14, 14.38s/it]Best trial: 6. Best value: 0.940449:  19%|█▉        | 29/150 [09:32<28:59, 14.37s/it]Best trial: 6. Best value: 0.940449:  19%|█▉        | 29/150 [09:49<28:59, 14.37s/it]Best trial: 6. Best value: 0.940449:  20%|██        | 30/150 [09:49<30:24, 15.21s/it]Best trial: 6. Best value: 0.940449:  20%|██        | 30/150 [10:05<30:24, 15.21s/it]Best trial: 6. Best value: 0.940449:  21%|██        | 31/150 [10:05<30:40, 15.46s/it]Best trial: 6. Best value: 0.940449:  21%|██        | 31/150 [10:18<30:40, 15.46s/it]Best trial: 6. Best value: 0.940449:  21%|██▏       | 32/150 [10:18<28:27, 14.47s/it]Best trial: 6. Best value: 0.940449:  21%|██▏       | 32/150 [10:31<28:27, 14.47s/it]Best trial: 6. Best value: 0.940449:  22%|██▏       | 33/150 [10:31<27:18, 14.00s/it]Best trial: 6. Best value: 0.940449:  22%|██▏       | 33/150 [10:44<27:18, 14.00s/it]Best trial: 6. Best value: 0.940449:  23%|██▎       | 34/150 [10:44<26:29, 13.70s/it]Best trial: 6. Best value: 0.940449:  23%|██▎       | 34/150 [11:02<26:29, 13.70s/it]Best trial: 6. Best value: 0.940449:  23%|██▎       | 35/150 [11:02<29:13, 15.25s/it]Best trial: 6. Best value: 0.940449:  23%|██▎       | 35/150 [11:16<29:13, 15.25s/it]Best trial: 6. Best value: 0.940449:  24%|██▍       | 36/150 [11:16<28:01, 14.75s/it]Best trial: 36. Best value: 0.941002:  24%|██▍       | 36/150 [11:27<28:01, 14.75s/it]Best trial: 36. Best value: 0.941002:  25%|██▍       | 37/150 [11:27<25:49, 13.71s/it]Best trial: 36. Best value: 0.941002:  25%|██▍       | 37/150 [11:42<25:49, 13.71s/it]Best trial: 36. Best value: 0.941002:  25%|██▌       | 38/150 [11:42<26:00, 13.93s/it]Best trial: 36. Best value: 0.941002:  25%|██▌       | 38/150 [11:53<26:00, 13.93s/it]Best trial: 36. Best value: 0.941002:  26%|██▌       | 39/150 [11:53<24:18, 13.14s/it]Best trial: 36. Best value: 0.941002:  26%|██▌       | 39/150 [12:03<24:18, 13.14s/it]Best trial: 36. Best value: 0.941002:  27%|██▋       | 40/150 [12:03<22:30, 12.28s/it]Best trial: 36. Best value: 0.941002:  27%|██▋       | 40/150 [12:16<22:30, 12.28s/it]Best trial: 36. Best value: 0.941002:  27%|██▋       | 41/150 [12:16<22:23, 12.32s/it]Best trial: 36. Best value: 0.941002:  27%|██▋       | 41/150 [12:27<22:23, 12.32s/it]Best trial: 36. Best value: 0.941002:  28%|██▊       | 42/150 [12:27<21:49, 12.12s/it]Best trial: 36. Best value: 0.941002:  28%|██▊       | 42/150 [12:38<21:49, 12.12s/it]Best trial: 36. Best value: 0.941002:  29%|██▊       | 43/150 [12:38<20:57, 11.75s/it]Best trial: 36. Best value: 0.941002:  29%|██▊       | 43/150 [12:50<20:57, 11.75s/it]Best trial: 36. Best value: 0.941002:  29%|██▉       | 44/150 [12:50<20:56, 11.86s/it]Best trial: 36. Best value: 0.941002:  29%|██▉       | 44/150 [13:10<20:56, 11.86s/it]Best trial: 36. Best value: 0.941002:  30%|███       | 45/150 [13:10<24:42, 14.12s/it]Best trial: 36. Best value: 0.941002:  30%|███       | 45/150 [13:21<24:42, 14.12s/it]Best trial: 36. Best value: 0.941002:  31%|███       | 46/150 [13:21<22:55, 13.23s/it]Best trial: 36. Best value: 0.941002:  31%|███       | 46/150 [13:34<22:55, 13.23s/it]Best trial: 36. Best value: 0.941002:  31%|███▏      | 47/150 [13:34<22:27, 13.08s/it]Best trial: 36. Best value: 0.941002:  31%|███▏      | 47/150 [13:47<22:27, 13.08s/it]Best trial: 36. Best value: 0.941002:  32%|███▏      | 48/150 [13:47<22:36, 13.30s/it]Best trial: 36. Best value: 0.941002:  32%|███▏      | 48/150 [14:03<22:36, 13.30s/it]Best trial: 36. Best value: 0.941002:  33%|███▎      | 49/150 [14:03<23:38, 14.05s/it]Best trial: 36. Best value: 0.941002:  33%|███▎      | 49/150 [14:16<23:38, 14.05s/it]Best trial: 36. Best value: 0.941002:  33%|███▎      | 50/150 [14:16<22:53, 13.73s/it]Best trial: 36. Best value: 0.941002:  33%|███▎      | 50/150 [14:30<22:53, 13.73s/it]Best trial: 36. Best value: 0.941002:  34%|███▍      | 51/150 [14:30<22:35, 13.69s/it]Best trial: 36. Best value: 0.941002:  34%|███▍      | 51/150 [14:42<22:35, 13.69s/it]Best trial: 36. Best value: 0.941002:  35%|███▍      | 52/150 [14:42<21:28, 13.15s/it]Best trial: 52. Best value: 0.942171:  35%|███▍      | 52/150 [14:54<21:28, 13.15s/it]Best trial: 52. Best value: 0.942171:  35%|███▌      | 53/150 [14:54<20:46, 12.85s/it]Best trial: 52. Best value: 0.942171:  35%|███▌      | 53/150 [15:10<20:46, 12.85s/it]Best trial: 52. Best value: 0.942171:  36%|███▌      | 54/150 [15:10<22:10, 13.86s/it]Best trial: 52. Best value: 0.942171:  36%|███▌      | 54/150 [15:21<22:10, 13.86s/it]Best trial: 52. Best value: 0.942171:  37%|███▋      | 55/150 [15:21<20:37, 13.02s/it]Best trial: 52. Best value: 0.942171:  37%|███▋      | 55/150 [15:47<20:37, 13.02s/it]Best trial: 52. Best value: 0.942171:  37%|███▋      | 56/150 [15:47<26:24, 16.86s/it]Best trial: 52. Best value: 0.942171:  37%|███▋      | 56/150 [15:59<26:24, 16.86s/it]Best trial: 52. Best value: 0.942171:  38%|███▊      | 57/150 [15:59<24:01, 15.50s/it]Best trial: 52. Best value: 0.942171:  38%|███▊      | 57/150 [16:16<24:01, 15.50s/it]Best trial: 52. Best value: 0.942171:  39%|███▊      | 58/150 [16:16<24:14, 15.81s/it]Best trial: 52. Best value: 0.942171:  39%|███▊      | 58/150 [16:30<24:14, 15.81s/it]Best trial: 52. Best value: 0.942171:  39%|███▉      | 59/150 [16:30<23:16, 15.35s/it]Best trial: 52. Best value: 0.942171:  39%|███▉      | 59/150 [16:53<23:16, 15.35s/it]Best trial: 52. Best value: 0.942171:  40%|████      | 60/150 [16:53<26:30, 17.68s/it]Best trial: 52. Best value: 0.942171:  40%|████      | 60/150 [17:04<26:30, 17.68s/it]Best trial: 52. Best value: 0.942171:  41%|████      | 61/150 [17:04<23:16, 15.69s/it]Best trial: 52. Best value: 0.942171:  41%|████      | 61/150 [17:17<23:16, 15.69s/it]Best trial: 52. Best value: 0.942171:  41%|████▏     | 62/150 [17:17<21:32, 14.69s/it]Best trial: 52. Best value: 0.942171:  41%|████▏     | 62/150 [17:30<21:32, 14.69s/it]Best trial: 52. Best value: 0.942171:  42%|████▏     | 63/150 [17:30<20:50, 14.38s/it]Best trial: 52. Best value: 0.942171:  42%|████▏     | 63/150 [17:43<20:50, 14.38s/it]Best trial: 52. Best value: 0.942171:  43%|████▎     | 64/150 [17:43<19:45, 13.78s/it]Best trial: 52. Best value: 0.942171:  43%|████▎     | 64/150 [18:01<19:45, 13.78s/it]Best trial: 52. Best value: 0.942171:  43%|████▎     | 65/150 [18:01<21:30, 15.19s/it]Best trial: 52. Best value: 0.942171:  43%|████▎     | 65/150 [18:24<21:30, 15.19s/it]Best trial: 52. Best value: 0.942171:  44%|████▍     | 66/150 [18:24<24:29, 17.50s/it]Best trial: 52. Best value: 0.942171:  44%|████▍     | 66/150 [18:38<24:29, 17.50s/it]Best trial: 52. Best value: 0.942171:  45%|████▍     | 67/150 [18:38<22:44, 16.45s/it]Best trial: 52. Best value: 0.942171:  45%|████▍     | 67/150 [18:55<22:44, 16.45s/it]Best trial: 52. Best value: 0.942171:  45%|████▌     | 68/150 [18:55<22:35, 16.53s/it]Best trial: 52. Best value: 0.942171:  45%|████▌     | 68/150 [19:06<22:35, 16.53s/it]Best trial: 52. Best value: 0.942171:  46%|████▌     | 69/150 [19:06<20:16, 15.02s/it]Best trial: 52. Best value: 0.942171:  46%|████▌     | 69/150 [19:29<20:16, 15.02s/it]Best trial: 52. Best value: 0.942171:  47%|████▋     | 70/150 [19:29<23:09, 17.37s/it]Best trial: 52. Best value: 0.942171:  47%|████▋     | 70/150 [19:46<23:09, 17.37s/it]Best trial: 52. Best value: 0.942171:  47%|████▋     | 71/150 [19:46<22:38, 17.19s/it]Best trial: 52. Best value: 0.942171:  47%|████▋     | 71/150 [19:59<22:38, 17.19s/it]Best trial: 52. Best value: 0.942171:  48%|████▊     | 72/150 [19:59<20:54, 16.09s/it]Best trial: 52. Best value: 0.942171:  48%|████▊     | 72/150 [20:12<20:54, 16.09s/it]Best trial: 52. Best value: 0.942171:  49%|████▊     | 73/150 [20:12<19:23, 15.11s/it]Best trial: 52. Best value: 0.942171:  49%|████▊     | 73/150 [20:28<19:23, 15.11s/it]Best trial: 52. Best value: 0.942171:  49%|████▉     | 74/150 [20:28<19:22, 15.29s/it]Best trial: 52. Best value: 0.942171:  49%|████▉     | 74/150 [20:42<19:22, 15.29s/it]Best trial: 52. Best value: 0.942171:  50%|█████     | 75/150 [20:42<18:43, 14.99s/it]Best trial: 52. Best value: 0.942171:  50%|█████     | 75/150 [20:58<18:43, 14.99s/it]Best trial: 52. Best value: 0.942171:  51%|█████     | 76/150 [20:58<18:45, 15.20s/it]Best trial: 52. Best value: 0.942171:  51%|█████     | 76/150 [21:10<18:45, 15.20s/it]Best trial: 52. Best value: 0.942171:  51%|█████▏    | 77/150 [21:10<17:29, 14.37s/it]Best trial: 52. Best value: 0.942171:  51%|█████▏    | 77/150 [21:25<17:29, 14.37s/it]Best trial: 52. Best value: 0.942171:  52%|█████▏    | 78/150 [21:25<17:21, 14.47s/it]Best trial: 52. Best value: 0.942171:  52%|█████▏    | 78/150 [21:35<17:21, 14.47s/it]Best trial: 52. Best value: 0.942171:  53%|█████▎    | 79/150 [21:35<15:23, 13.01s/it]Best trial: 52. Best value: 0.942171:  53%|█████▎    | 79/150 [21:47<15:23, 13.01s/it]Best trial: 52. Best value: 0.942171:  53%|█████▎    | 80/150 [21:47<14:55, 12.79s/it]Best trial: 52. Best value: 0.942171:  53%|█████▎    | 80/150 [21:59<14:55, 12.79s/it]Best trial: 52. Best value: 0.942171:  54%|█████▍    | 81/150 [21:59<14:26, 12.55s/it]Best trial: 52. Best value: 0.942171:  54%|█████▍    | 81/150 [22:10<14:26, 12.55s/it]Best trial: 52. Best value: 0.942171:  55%|█████▍    | 82/150 [22:10<13:36, 12.01s/it]Best trial: 52. Best value: 0.942171:  55%|█████▍    | 82/150 [22:21<13:36, 12.01s/it]Best trial: 52. Best value: 0.942171:  55%|█████▌    | 83/150 [22:21<13:04, 11.71s/it]Best trial: 52. Best value: 0.942171:  55%|█████▌    | 83/150 [22:32<13:04, 11.71s/it]Best trial: 52. Best value: 0.942171:  56%|█████▌    | 84/150 [22:32<12:43, 11.57s/it]Best trial: 52. Best value: 0.942171:  56%|█████▌    | 84/150 [22:42<12:43, 11.57s/it]Best trial: 52. Best value: 0.942171:  57%|█████▋    | 85/150 [22:42<12:11, 11.26s/it]Best trial: 52. Best value: 0.942171:  57%|█████▋    | 85/150 [22:54<12:11, 11.26s/it]Best trial: 52. Best value: 0.942171:  57%|█████▋    | 86/150 [22:54<11:59, 11.24s/it]Best trial: 52. Best value: 0.942171:  57%|█████▋    | 86/150 [23:07<11:59, 11.24s/it]Best trial: 52. Best value: 0.942171:  58%|█████▊    | 87/150 [23:07<12:36, 12.01s/it]Best trial: 52. Best value: 0.942171:  58%|█████▊    | 87/150 [23:18<12:36, 12.01s/it]Best trial: 52. Best value: 0.942171:  59%|█████▊    | 88/150 [23:18<11:53, 11.50s/it]Best trial: 52. Best value: 0.942171:  59%|█████▊    | 88/150 [23:30<11:53, 11.50s/it]Best trial: 52. Best value: 0.942171:  59%|█████▉    | 89/150 [23:30<11:51, 11.67s/it]Best trial: 52. Best value: 0.942171:  59%|█████▉    | 89/150 [23:40<11:51, 11.67s/it]Best trial: 52. Best value: 0.942171:  60%|██████    | 90/150 [23:40<11:16, 11.27s/it]Best trial: 52. Best value: 0.942171:  60%|██████    | 90/150 [23:51<11:16, 11.27s/it]Best trial: 52. Best value: 0.942171:  61%|██████    | 91/150 [23:51<11:03, 11.25s/it]Best trial: 52. Best value: 0.942171:  61%|██████    | 91/150 [24:03<11:03, 11.25s/it]Best trial: 52. Best value: 0.942171:  61%|██████▏   | 92/150 [24:03<10:55, 11.29s/it]Best trial: 52. Best value: 0.942171:  61%|██████▏   | 92/150 [24:26<10:55, 11.29s/it]Best trial: 52. Best value: 0.942171:  62%|██████▏   | 93/150 [24:26<14:03, 14.80s/it]Best trial: 52. Best value: 0.942171:  62%|██████▏   | 93/150 [24:37<14:03, 14.80s/it]Best trial: 52. Best value: 0.942171:  63%|██████▎   | 94/150 [24:37<12:51, 13.78s/it]Best trial: 52. Best value: 0.942171:  63%|██████▎   | 94/150 [24:48<12:51, 13.78s/it]Best trial: 52. Best value: 0.942171:  63%|██████▎   | 95/150 [24:48<11:47, 12.87s/it]Best trial: 95. Best value: 0.942887:  63%|██████▎   | 95/150 [24:58<11:47, 12.87s/it]Best trial: 95. Best value: 0.942887:  64%|██████▍   | 96/150 [24:58<10:54, 12.12s/it]Best trial: 95. Best value: 0.942887:  64%|██████▍   | 96/150 [25:09<10:54, 12.12s/it]Best trial: 95. Best value: 0.942887:  65%|██████▍   | 97/150 [25:09<10:19, 11.70s/it]Best trial: 95. Best value: 0.942887:  65%|██████▍   | 97/150 [25:20<10:19, 11.70s/it]Best trial: 95. Best value: 0.942887:  65%|██████▌   | 98/150 [25:20<09:59, 11.53s/it]Best trial: 95. Best value: 0.942887:  65%|██████▌   | 98/150 [25:31<09:59, 11.53s/it]Best trial: 95. Best value: 0.942887:  66%|██████▌   | 99/150 [25:31<09:43, 11.43s/it]Best trial: 95. Best value: 0.942887:  66%|██████▌   | 99/150 [25:44<09:43, 11.43s/it]Best trial: 95. Best value: 0.942887:  67%|██████▋   | 100/150 [25:44<09:46, 11.73s/it]Best trial: 95. Best value: 0.942887:  67%|██████▋   | 100/150 [25:53<09:46, 11.73s/it]Best trial: 95. Best value: 0.942887:  67%|██████▋   | 101/150 [25:53<08:59, 11.01s/it]Best trial: 95. Best value: 0.942887:  67%|██████▋   | 101/150 [26:10<08:59, 11.01s/it]Best trial: 95. Best value: 0.942887:  68%|██████▊   | 102/150 [26:10<10:07, 12.66s/it]Best trial: 95. Best value: 0.942887:  68%|██████▊   | 102/150 [26:21<10:07, 12.66s/it]Best trial: 95. Best value: 0.942887:  69%|██████▊   | 103/150 [26:21<09:43, 12.41s/it]Best trial: 95. Best value: 0.942887:  69%|██████▊   | 103/150 [26:35<09:43, 12.41s/it]Best trial: 95. Best value: 0.942887:  69%|██████▉   | 104/150 [26:35<09:46, 12.75s/it]Best trial: 95. Best value: 0.942887:  69%|██████▉   | 104/150 [26:49<09:46, 12.75s/it]Best trial: 95. Best value: 0.942887:  70%|███████   | 105/150 [26:49<09:50, 13.13s/it]Best trial: 95. Best value: 0.942887:  70%|███████   | 105/150 [27:02<09:50, 13.13s/it]Best trial: 95. Best value: 0.942887:  71%|███████   | 106/150 [27:02<09:32, 13.02s/it]Best trial: 95. Best value: 0.942887:  71%|███████   | 106/150 [27:14<09:32, 13.02s/it]Best trial: 95. Best value: 0.942887:  71%|███████▏  | 107/150 [27:14<09:04, 12.66s/it]Best trial: 95. Best value: 0.942887:  71%|███████▏  | 107/150 [27:28<09:04, 12.66s/it]Best trial: 95. Best value: 0.942887:  72%|███████▏  | 108/150 [27:28<09:18, 13.29s/it]Best trial: 95. Best value: 0.942887:  72%|███████▏  | 108/150 [27:40<09:18, 13.29s/it]Best trial: 95. Best value: 0.942887:  73%|███████▎  | 109/150 [27:40<08:43, 12.77s/it]Best trial: 95. Best value: 0.942887:  73%|███████▎  | 109/150 [27:56<08:43, 12.77s/it]Best trial: 95. Best value: 0.942887:  73%|███████▎  | 110/150 [27:56<09:06, 13.67s/it]Best trial: 95. Best value: 0.942887:  73%|███████▎  | 110/150 [28:07<09:06, 13.67s/it]Best trial: 95. Best value: 0.942887:  74%|███████▍  | 111/150 [28:07<08:24, 12.93s/it]Best trial: 95. Best value: 0.942887:  74%|███████▍  | 111/150 [28:18<08:24, 12.93s/it]Best trial: 95. Best value: 0.942887:  75%|███████▍  | 112/150 [28:18<07:47, 12.31s/it]Best trial: 95. Best value: 0.942887:  75%|███████▍  | 112/150 [28:29<07:47, 12.31s/it]Best trial: 95. Best value: 0.942887:  75%|███████▌  | 113/150 [28:29<07:22, 11.95s/it]Best trial: 95. Best value: 0.942887:  75%|███████▌  | 113/150 [28:39<07:22, 11.95s/it]Best trial: 95. Best value: 0.942887:  76%|███████▌  | 114/150 [28:39<06:55, 11.55s/it]Best trial: 95. Best value: 0.942887:  76%|███████▌  | 114/150 [28:51<06:55, 11.55s/it]Best trial: 95. Best value: 0.942887:  77%|███████▋  | 115/150 [28:51<06:39, 11.42s/it]Best trial: 95. Best value: 0.942887:  77%|███████▋  | 115/150 [29:04<06:39, 11.42s/it]Best trial: 95. Best value: 0.942887:  77%|███████▋  | 116/150 [29:04<06:44, 11.90s/it]Best trial: 95. Best value: 0.942887:  77%|███████▋  | 116/150 [29:15<06:44, 11.90s/it]Best trial: 95. Best value: 0.942887:  78%|███████▊  | 117/150 [29:15<06:28, 11.78s/it]Best trial: 95. Best value: 0.942887:  78%|███████▊  | 117/150 [29:32<06:28, 11.78s/it]Best trial: 95. Best value: 0.942887:  79%|███████▊  | 118/150 [29:32<07:02, 13.20s/it]Best trial: 95. Best value: 0.942887:  79%|███████▊  | 118/150 [29:44<07:02, 13.20s/it]Best trial: 95. Best value: 0.942887:  79%|███████▉  | 119/150 [29:44<06:41, 12.95s/it]Best trial: 95. Best value: 0.942887:  79%|███████▉  | 119/150 [30:06<06:41, 12.95s/it]Best trial: 95. Best value: 0.942887:  80%|████████  | 120/150 [30:06<07:49, 15.64s/it]Best trial: 95. Best value: 0.942887:  80%|████████  | 120/150 [30:16<07:49, 15.64s/it]Best trial: 95. Best value: 0.942887:  81%|████████  | 121/150 [30:16<06:41, 13.85s/it]Best trial: 95. Best value: 0.942887:  81%|████████  | 121/150 [30:26<06:41, 13.85s/it]Best trial: 95. Best value: 0.942887:  81%|████████▏ | 122/150 [30:26<06:03, 12.98s/it]Best trial: 95. Best value: 0.942887:  81%|████████▏ | 122/150 [30:37<06:03, 12.98s/it]Best trial: 95. Best value: 0.942887:  82%|████████▏ | 123/150 [30:37<05:33, 12.37s/it]Best trial: 95. Best value: 0.942887:  82%|████████▏ | 123/150 [30:49<05:33, 12.37s/it]Best trial: 95. Best value: 0.942887:  83%|████████▎ | 124/150 [30:49<05:14, 12.10s/it]Best trial: 95. Best value: 0.942887:  83%|████████▎ | 124/150 [30:59<05:14, 12.10s/it]Best trial: 95. Best value: 0.942887:  83%|████████▎ | 125/150 [30:59<04:47, 11.52s/it]Best trial: 95. Best value: 0.942887:  83%|████████▎ | 125/150 [31:12<04:47, 11.52s/it]Best trial: 95. Best value: 0.942887:  84%|████████▍ | 126/150 [31:12<04:44, 11.84s/it]Best trial: 95. Best value: 0.942887:  84%|████████▍ | 126/150 [31:23<04:44, 11.84s/it]Best trial: 95. Best value: 0.942887:  85%|████████▍ | 127/150 [31:23<04:26, 11.58s/it]Best trial: 95. Best value: 0.942887:  85%|████████▍ | 127/150 [31:35<04:26, 11.58s/it]Best trial: 95. Best value: 0.942887:  85%|████████▌ | 128/150 [31:35<04:21, 11.88s/it]Best trial: 95. Best value: 0.942887:  85%|████████▌ | 128/150 [32:00<04:21, 11.88s/it]Best trial: 95. Best value: 0.942887:  86%|████████▌ | 129/150 [32:00<05:31, 15.77s/it]Best trial: 95. Best value: 0.942887:  86%|████████▌ | 129/150 [32:12<05:31, 15.77s/it]Best trial: 95. Best value: 0.942887:  87%|████████▋ | 130/150 [32:12<04:52, 14.64s/it]Best trial: 95. Best value: 0.942887:  87%|████████▋ | 130/150 [32:27<04:52, 14.64s/it]Best trial: 95. Best value: 0.942887:  87%|████████▋ | 131/150 [32:27<04:39, 14.73s/it]Best trial: 95. Best value: 0.942887:  87%|████████▋ | 131/150 [32:40<04:39, 14.73s/it]Best trial: 95. Best value: 0.942887:  88%|████████▊ | 132/150 [32:40<04:15, 14.19s/it]Best trial: 95. Best value: 0.942887:  88%|████████▊ | 132/150 [32:52<04:15, 14.19s/it]Best trial: 95. Best value: 0.942887:  89%|████████▊ | 133/150 [32:52<03:52, 13.70s/it]Best trial: 95. Best value: 0.942887:  89%|████████▊ | 133/150 [33:03<03:52, 13.70s/it]Best trial: 95. Best value: 0.942887:  89%|████████▉ | 134/150 [33:03<03:24, 12.81s/it]Best trial: 95. Best value: 0.942887:  89%|████████▉ | 134/150 [33:13<03:24, 12.81s/it]Best trial: 95. Best value: 0.942887:  90%|█████████ | 135/150 [33:13<02:57, 11.82s/it]Best trial: 95. Best value: 0.942887:  90%|█████████ | 135/150 [33:24<02:57, 11.82s/it]Best trial: 95. Best value: 0.942887:  91%|█████████ | 136/150 [33:24<02:42, 11.61s/it]Best trial: 95. Best value: 0.942887:  91%|█████████ | 136/150 [33:36<02:42, 11.61s/it]Best trial: 95. Best value: 0.942887:  91%|█████████▏| 137/150 [33:36<02:31, 11.69s/it]Best trial: 95. Best value: 0.942887:  91%|█████████▏| 137/150 [33:49<02:31, 11.69s/it]Best trial: 95. Best value: 0.942887:  92%|█████████▏| 138/150 [33:49<02:27, 12.28s/it]Best trial: 95. Best value: 0.942887:  92%|█████████▏| 138/150 [34:02<02:27, 12.28s/it]Best trial: 95. Best value: 0.942887:  93%|█████████▎| 139/150 [34:02<02:14, 12.27s/it]Best trial: 95. Best value: 0.942887:  93%|█████████▎| 139/150 [34:12<02:14, 12.27s/it]Best trial: 95. Best value: 0.942887:  93%|█████████▎| 140/150 [34:12<01:57, 11.73s/it]Best trial: 95. Best value: 0.942887:  93%|█████████▎| 140/150 [34:29<01:57, 11.73s/it]Best trial: 95. Best value: 0.942887:  94%|█████████▍| 141/150 [34:29<01:58, 13.20s/it]Best trial: 95. Best value: 0.942887:  94%|█████████▍| 141/150 [34:40<01:58, 13.20s/it]Best trial: 95. Best value: 0.942887:  95%|█████████▍| 142/150 [34:40<01:39, 12.49s/it]Best trial: 142. Best value: 0.945188:  95%|█████████▍| 142/150 [34:51<01:39, 12.49s/it]Best trial: 142. Best value: 0.945188:  95%|█████████▌| 143/150 [34:51<01:25, 12.24s/it]Best trial: 142. Best value: 0.945188:  95%|█████████▌| 143/150 [35:03<01:25, 12.24s/it]Best trial: 142. Best value: 0.945188:  96%|█████████▌| 144/150 [35:03<01:12, 12.07s/it]Best trial: 142. Best value: 0.945188:  96%|█████████▌| 144/150 [35:14<01:12, 12.07s/it]Best trial: 142. Best value: 0.945188:  97%|█████████▋| 145/150 [35:14<00:58, 11.72s/it]Best trial: 142. Best value: 0.945188:  97%|█████████▋| 145/150 [35:24<00:58, 11.72s/it]Best trial: 142. Best value: 0.945188:  97%|█████████▋| 146/150 [35:24<00:45, 11.35s/it]Best trial: 142. Best value: 0.945188:  97%|█████████▋| 146/150 [35:35<00:45, 11.35s/it]Best trial: 142. Best value: 0.945188:  98%|█████████▊| 147/150 [35:35<00:33, 11.11s/it]Best trial: 142. Best value: 0.945188:  98%|█████████▊| 147/150 [35:46<00:33, 11.11s/it]Best trial: 142. Best value: 0.945188:  99%|█████████▊| 148/150 [35:46<00:22, 11.27s/it]Best trial: 142. Best value: 0.945188:  99%|█████████▊| 148/150 [35:59<00:22, 11.27s/it]Best trial: 142. Best value: 0.945188:  99%|█████████▉| 149/150 [35:59<00:11, 11.58s/it]Best trial: 142. Best value: 0.945188:  99%|█████████▉| 149/150 [36:09<00:11, 11.58s/it]Best trial: 142. Best value: 0.945188: 100%|██████████| 150/150 [36:09<00:00, 11.27s/it]Best trial: 142. Best value: 0.945188: 100%|██████████| 150/150 [36:09<00:00, 14.47s/it]
14:46:07 [INFO] models.training.ordinal_trainer: Best params: {'bootstrap_type': 'Bernoulli', 'grow_policy': 'Depthwise', 'depth': 4, 'iterations': 126, 'learning_rate': 0.049333872606457954, 'border_count': 32, 'l2_leaf_reg': 6.003699588625946, 'min_data_in_leaf': 38, 'random_strength': 1.7292040244724012, 'colsample_bylevel': 0.3804452887057506, 'subsample': 0.7751724032014604}
14:46:07 [INFO] models.training.ordinal_trainer: Best AUC: 0.9452
14:46:08 [INFO] models.training.ordinal_trainer:   Threshold -11: trained (pos_rate=91.1%)
14:46:10 [INFO] models.training.ordinal_trainer:   Threshold -10: trained (pos_rate=89.5%)
14:46:11 [INFO] models.training.ordinal_trainer:   Threshold -9: trained (pos_rate=87.6%)
14:46:13 [INFO] models.training.ordinal_trainer:   Threshold -8: trained (pos_rate=85.8%)
14:46:15 [INFO] models.training.ordinal_trainer:   Threshold -7: trained (pos_rate=83.5%)
14:46:16 [INFO] models.training.ordinal_trainer:   Threshold -6: trained (pos_rate=81.1%)
14:46:18 [INFO] models.training.ordinal_trainer:   Threshold -5: trained (pos_rate=78.8%)
14:46:20 [INFO] models.training.ordinal_trainer:   Threshold -4: trained (pos_rate=76.9%)
14:46:22 [INFO] models.training.ordinal_trainer:   Threshold -3: trained (pos_rate=71.6%)
14:46:24 [INFO] models.training.ordinal_trainer:   Threshold -2: trained (pos_rate=68.0%)
14:46:26 [INFO] models.training.ordinal_trainer:   Threshold -1: trained (pos_rate=63.0%)
14:46:28 [INFO] models.training.ordinal_trainer:   Threshold +0: trained (pos_rate=57.1%)
14:46:30 [INFO] models.training.ordinal_trainer:   Threshold +1: trained (pos_rate=41.2%)
14:46:32 [INFO] models.training.ordinal_trainer:   Threshold +2: trained (pos_rate=34.8%)
14:46:34 [INFO] models.training.ordinal_trainer:   Threshold +3: trained (pos_rate=29.0%)
14:46:36 [INFO] models.training.ordinal_trainer:   Threshold +4: trained (pos_rate=25.2%)
14:46:39 [INFO] models.training.ordinal_trainer:   Threshold +5: trained (pos_rate=20.6%)
14:46:41 [INFO] models.training.ordinal_trainer:   Threshold +6: trained (pos_rate=18.2%)
14:46:43 [INFO] models.training.ordinal_trainer:   Threshold +7: trained (pos_rate=15.1%)
14:46:46 [INFO] models.training.ordinal_trainer:   Threshold +8: trained (pos_rate=13.1%)
14:46:48 [INFO] models.training.ordinal_trainer:   Threshold +9: trained (pos_rate=10.7%)
14:46:51 [INFO] models.training.ordinal_trainer:   Threshold +10: trained (pos_rate=9.2%)
14:46:52 [INFO] models.training.ordinal_trainer:   Threshold +11: trained (pos_rate=7.2%)
14:46:54 [INFO] models.training.ordinal_trainer:   Threshold +12: trained (pos_rate=6.1%)
14:46:54 [INFO] models.training.ordinal_trainer: Ordinal training complete: 24 classifiers
14:46:56 [INFO] models.training.ordinal_trainer: Saved ordinal model to models/saved/chicago/ordinal_catboost_optuna.pkl
14:46:56 [INFO] __main__: 
Saved model to models/saved/chicago/ordinal_catboost_optuna.pkl
14:46:56 [INFO] __main__: Saved best params to models/saved/chicago/best_params.json
14:46:56 [INFO] __main__: Saved final metrics to models/saved/chicago/final_metrics_chicago.json

============================================================
EVALUATION
============================================================

Test Set Metrics:
----------------------------------------
  delta_accuracy: 0.2610
  delta_mae: 2.0163
  off_by_1_rate: 0.2747
  off_by_2plus_rate: 0.4644
  within_1_rate: 0.5356
  within_2_rate: 0.7015

============================================================
FEATURE IMPORTANCE
============================================================

Top 30 Features:
                           feature  importance
0                 obs_fcst_max_gap   15.480460
1                   fcst_obs_ratio    9.963965
2                 remaining_upside    4.528527
3            gap_x_hours_remaining    4.214909
4         fcst_remaining_potential    4.133409
5          temp_zscore_vs_forecast    4.085652
6             log_abs_obs_fcst_gap    3.845724
7          confidence_weighted_gap    3.706346
8             obs_fcst_gap_squared    2.634525
9                 delta_vcmax_lag1    2.582295
10           fcst_multi_t1_t2_diff    2.387005
11            fcst_peak_hour_float    2.092044
12      minutes_since_max_observed    2.054103
13           fcst_prev_hour_of_max    1.755957
14                         doy_sin    1.345910
15                  err_mean_sofar    1.320373
16         hours_since_market_open    1.052495
17               num_samples_sofar    0.992640
18      expected_delta_uncertainty    0.985964
19  log_expected_delta_uncertainty    0.979136
20          log_minutes_since_open    0.963509
21              log_hours_to_close    0.953076
22                 above_fcst_flag    0.844351
23                        week_sin    0.823847
24                   settle_f_lag2    0.811259
25               err_max_pos_sofar    0.738723
26                fcst_drift_std_f    0.709125
27                 fcst_prev_std_f    0.656203
28           max_afternoon_f_sofar    0.632542
29    fcst_humidity_afternoon_mean    0.598352

----------------------------------------
Station-city feature importance:
                         feature  importance
54    station_city_max_gap_sofar    0.317635
63   station_city_gap_x_fcst_gap    0.269624
125         station_city_gap_std    0.042323
131  station_city_mean_gap_sofar    0.033727
149       station_city_gap_trend    0.011639
177        station_city_temp_gap    0.000802
  station_city_max_gap_sofar: rank 55/201
  station_city_gap_x_fcst_gap: rank 64/201
  station_city_gap_std: rank 126/201
  station_city_mean_gap_sofar: rank 132/201
  station_city_gap_trend: rank 150/201
  station_city_temp_gap: rank 178/201

----------------------------------------
Multi-horizon feature importance:
                  feature  importance
10  fcst_multi_t1_t2_diff    2.387005
35         fcst_multi_std    0.476869
36      fcst_multi_median    0.470488
41       fcst_multi_range    0.390510
49        fcst_multi_mean    0.339285
52         fcst_multi_ema    0.318780
55   fcst_multi_range_pct    0.316762
66          fcst_multi_cv    0.258654
71       fcst_multi_drift    0.237652
  fcst_multi_t1_t2_diff: rank 11/201
  fcst_multi_std: rank 36/201
  fcst_multi_median: rank 37/201
  fcst_multi_range: rank 42/201
  fcst_multi_mean: rank 50/201
  fcst_multi_ema: rank 53/201
  fcst_multi_range_pct: rank 56/201
  fcst_multi_cv: rank 67/201
  fcst_multi_drift: rank 72/201

============================================================
SUMMARY
============================================================
City: chicago
Model: models/saved/chicago/ordinal_catboost_optuna.pkl
Params: models/saved/chicago/best_params.json
Metrics: models/saved/chicago/final_metrics_chicago.json
Training samples: 389,784
Test samples: 97,128
Optuna trials: 150
Best params: {'bootstrap_type': 'Bernoulli', 'grow_policy': 'Depthwise', 'depth': 4, 'iterations': 126, 'learning_rate': 0.049333872606457954, 'border_count': 32, 'l2_leaf_reg': 6.003699588625946, 'min_data_in_leaf': 38, 'random_strength': 1.7292040244724012, 'colsample_bylevel': 0.3804452887057506, 'subsample': 0.7751724032014604}

Key Metrics:
  Accuracy: 26.1%
  MAE: 2.02
  Within 1: 53.6%
  Within 2: 70.1%

============================================================
DONE
============================================================
