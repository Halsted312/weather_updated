nohup: ignoring input
14:07:19 [INFO] __main__: ============================================================
14:07:19 [INFO] __main__: AUSTIN Optuna Training (150 trials)
14:07:19 [INFO] __main__: ============================================================
14:07:19 [INFO] src.db.connection: Database engine created: localhost:5434/kalshi_weather
14:07:19 [INFO] __main__: Available data: 2023-01-01 to 2025-11-27
14:07:19 [INFO] __main__: Total days: 1062
14:07:19 [INFO] __main__: Training: 2023-01-01 to 2025-04-28 (850 days)
14:07:19 [INFO] __main__: Testing:  2025-04-29 to 2025-11-27 (212 days)
14:07:19 [INFO] __main__: Loading cached datasets...
14:07:20 [INFO] __main__: Loaded train: 129,928 rows, test: 32,376 rows
14:07:20 [INFO] __main__: 
Training samples: 129,928
14:07:20 [INFO] __main__: Training days: 855
14:07:20 [INFO] __main__: Test samples: 32,376
14:07:20 [INFO] __main__: Test days: 213
14:07:20 [INFO] __main__: 
Station-city features: ['station_city_temp_gap', 'station_city_max_gap_sofar', 'station_city_mean_gap_sofar', 'station_city_gap_std', 'station_city_gap_trend']
14:07:20 [INFO] __main__:   station_city_temp_gap: 129,896/129,928 non-null (100.0%)
14:07:20 [INFO] __main__:   station_city_max_gap_sofar: 129,896/129,928 non-null (100.0%)
14:07:20 [INFO] __main__:   station_city_mean_gap_sofar: 129,896/129,928 non-null (100.0%)
14:07:20 [INFO] __main__:   station_city_gap_std: 129,896/129,928 non-null (100.0%)
14:07:20 [INFO] __main__:   station_city_gap_trend: 129,894/129,928 non-null (100.0%)
14:07:20 [INFO] __main__: 
Multi-horizon features: ['fcst_multi_mean', 'fcst_multi_median', 'fcst_multi_ema', 'fcst_multi_std', 'fcst_multi_range', 'fcst_multi_t1_t2_diff', 'fcst_multi_drift']
14:07:20 [INFO] __main__:   fcst_multi_mean: 129,928/129,928 non-null (100.0%)
14:07:20 [INFO] __main__:   fcst_multi_median: 129,928/129,928 non-null (100.0%)
14:07:20 [INFO] __main__:   fcst_multi_ema: 129,928/129,928 non-null (100.0%)
14:07:20 [INFO] __main__:   fcst_multi_std: 129,928/129,928 non-null (100.0%)
14:07:20 [INFO] __main__:   fcst_multi_range: 129,928/129,928 non-null (100.0%)
14:07:20 [INFO] __main__:   fcst_multi_t1_t2_diff: 129,928/129,928 non-null (100.0%)
14:07:20 [INFO] __main__:   fcst_multi_drift: 129,928/129,928 non-null (100.0%)
14:07:22 [INFO] models.training.ordinal_trainer: Training ordinal model (catboost) on 129928 samples
14:07:22 [INFO] models.training.ordinal_trainer: City delta range: [-10, 10]
14:07:22 [INFO] models.training.ordinal_trainer: Training 20 threshold classifiers: [-9, -8, -7, -6, -5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
14:07:22 [INFO] models.training.ordinal_trainer: Starting Optuna tuning with 150 trials

============================================================
OPTUNA TRAINING (150 trials)
============================================================
  0%|          | 0/150 [00:00<?, ?it/s]Best trial: 0. Best value: 0.897531:   0%|          | 0/150 [00:06<?, ?it/s]Best trial: 0. Best value: 0.897531:   1%|          | 1/150 [00:06<15:32,  6.26s/it]Best trial: 0. Best value: 0.897531:   1%|          | 1/150 [00:10<15:32,  6.26s/it]Best trial: 0. Best value: 0.897531:   1%|▏         | 2/150 [00:10<12:03,  4.89s/it]Best trial: 0. Best value: 0.897531:   1%|▏         | 2/150 [00:15<12:03,  4.89s/it]Best trial: 0. Best value: 0.897531:   2%|▏         | 3/150 [00:15<12:26,  5.08s/it]Best trial: 0. Best value: 0.897531:   2%|▏         | 3/150 [00:19<12:26,  5.08s/it]Best trial: 0. Best value: 0.897531:   3%|▎         | 4/150 [00:19<10:58,  4.51s/it]Best trial: 0. Best value: 0.897531:   3%|▎         | 4/150 [00:22<10:58,  4.51s/it]Best trial: 0. Best value: 0.897531:   3%|▎         | 5/150 [00:22<10:20,  4.28s/it]Best trial: 5. Best value: 0.901216:   3%|▎         | 5/150 [00:28<10:20,  4.28s/it]Best trial: 5. Best value: 0.901216:   4%|▍         | 6/150 [00:28<11:19,  4.72s/it]Best trial: 5. Best value: 0.901216:   4%|▍         | 6/150 [00:31<11:19,  4.72s/it]Best trial: 5. Best value: 0.901216:   5%|▍         | 7/150 [00:31<10:05,  4.24s/it]Best trial: 5. Best value: 0.901216:   5%|▍         | 7/150 [00:35<10:05,  4.24s/it]Best trial: 5. Best value: 0.901216:   5%|▌         | 8/150 [00:35<09:52,  4.17s/it]Best trial: 5. Best value: 0.901216:   5%|▌         | 8/150 [00:39<09:52,  4.17s/it]Best trial: 5. Best value: 0.901216:   6%|▌         | 9/150 [00:39<09:11,  3.91s/it]Best trial: 5. Best value: 0.901216:   6%|▌         | 9/150 [00:44<09:11,  3.91s/it]Best trial: 5. Best value: 0.901216:   7%|▋         | 10/150 [00:44<10:17,  4.41s/it]Best trial: 5. Best value: 0.901216:   7%|▋         | 10/150 [00:48<10:17,  4.41s/it]Best trial: 5. Best value: 0.901216:   7%|▋         | 11/150 [00:48<09:57,  4.30s/it]Best trial: 11. Best value: 0.904549:   7%|▋         | 11/150 [00:54<09:57,  4.30s/it]Best trial: 11. Best value: 0.904549:   8%|▊         | 12/150 [00:54<10:59,  4.78s/it]Best trial: 11. Best value: 0.904549:   8%|▊         | 12/150 [00:59<10:59,  4.78s/it]Best trial: 11. Best value: 0.904549:   9%|▊         | 13/150 [00:59<10:58,  4.81s/it]Best trial: 11. Best value: 0.904549:   9%|▊         | 13/150 [01:02<10:58,  4.81s/it]Best trial: 11. Best value: 0.904549:   9%|▉         | 14/150 [01:02<09:53,  4.36s/it]Best trial: 11. Best value: 0.904549:   9%|▉         | 14/150 [01:08<09:53,  4.36s/it]Best trial: 11. Best value: 0.904549:  10%|█         | 15/150 [01:08<10:34,  4.70s/it]Best trial: 11. Best value: 0.904549:  10%|█         | 15/150 [01:12<10:34,  4.70s/it]Best trial: 11. Best value: 0.904549:  11%|█         | 16/150 [01:12<10:03,  4.50s/it]Best trial: 11. Best value: 0.904549:  11%|█         | 16/150 [01:18<10:03,  4.50s/it]Best trial: 11. Best value: 0.904549:  11%|█▏        | 17/150 [01:18<11:07,  5.02s/it]Best trial: 11. Best value: 0.904549:  11%|█▏        | 17/150 [01:23<11:07,  5.02s/it]Best trial: 11. Best value: 0.904549:  12%|█▏        | 18/150 [01:23<11:10,  5.08s/it]Best trial: 11. Best value: 0.904549:  12%|█▏        | 18/150 [01:27<11:10,  5.08s/it]Best trial: 11. Best value: 0.904549:  13%|█▎        | 19/150 [01:27<10:14,  4.69s/it]Best trial: 11. Best value: 0.904549:  13%|█▎        | 19/150 [01:33<10:14,  4.69s/it]Best trial: 11. Best value: 0.904549:  13%|█▎        | 20/150 [01:33<11:14,  5.19s/it]Best trial: 11. Best value: 0.904549:  13%|█▎        | 20/150 [01:37<11:14,  5.19s/it]Best trial: 11. Best value: 0.904549:  14%|█▍        | 21/150 [01:37<10:21,  4.82s/it]Best trial: 11. Best value: 0.904549:  14%|█▍        | 21/150 [01:41<10:21,  4.82s/it]Best trial: 11. Best value: 0.904549:  15%|█▍        | 22/150 [01:41<09:38,  4.52s/it]Best trial: 11. Best value: 0.904549:  15%|█▍        | 22/150 [01:45<09:38,  4.52s/it]Best trial: 11. Best value: 0.904549:  15%|█▌        | 23/150 [01:45<09:15,  4.37s/it]Best trial: 11. Best value: 0.904549:  15%|█▌        | 23/150 [01:49<09:15,  4.37s/it]Best trial: 11. Best value: 0.904549:  16%|█▌        | 24/150 [01:49<08:30,  4.05s/it]Best trial: 11. Best value: 0.904549:  16%|█▌        | 24/150 [01:53<08:30,  4.05s/it]Best trial: 11. Best value: 0.904549:  17%|█▋        | 25/150 [01:53<08:29,  4.08s/it]Best trial: 11. Best value: 0.904549:  17%|█▋        | 25/150 [01:59<08:29,  4.08s/it]Best trial: 11. Best value: 0.904549:  17%|█▋        | 26/150 [01:59<09:51,  4.77s/it]Best trial: 11. Best value: 0.904549:  17%|█▋        | 26/150 [02:04<09:51,  4.77s/it]Best trial: 11. Best value: 0.904549:  18%|█▊        | 27/150 [02:04<09:39,  4.71s/it]Best trial: 11. Best value: 0.904549:  18%|█▊        | 27/150 [02:09<09:39,  4.71s/it]Best trial: 11. Best value: 0.904549:  19%|█▊        | 28/150 [02:09<09:45,  4.80s/it]Best trial: 11. Best value: 0.904549:  19%|█▊        | 28/150 [02:12<09:45,  4.80s/it]Best trial: 11. Best value: 0.904549:  19%|█▉        | 29/150 [02:12<08:39,  4.30s/it]Best trial: 11. Best value: 0.904549:  19%|█▉        | 29/150 [02:18<08:39,  4.30s/it]Best trial: 11. Best value: 0.904549:  20%|██        | 30/150 [02:18<09:38,  4.82s/it]Best trial: 11. Best value: 0.904549:  20%|██        | 30/150 [02:24<09:38,  4.82s/it]Best trial: 11. Best value: 0.904549:  21%|██        | 31/150 [02:24<10:07,  5.10s/it]Best trial: 31. Best value: 0.906501:  21%|██        | 31/150 [02:27<10:07,  5.10s/it]Best trial: 31. Best value: 0.906501:  21%|██▏       | 32/150 [02:27<09:19,  4.74s/it]Best trial: 31. Best value: 0.906501:  21%|██▏       | 32/150 [02:31<09:19,  4.74s/it]Best trial: 31. Best value: 0.906501:  22%|██▏       | 33/150 [02:31<08:29,  4.36s/it]Best trial: 31. Best value: 0.906501:  22%|██▏       | 33/150 [02:34<08:29,  4.36s/it]Best trial: 31. Best value: 0.906501:  23%|██▎       | 34/150 [02:34<07:43,  4.00s/it]Best trial: 31. Best value: 0.906501:  23%|██▎       | 34/150 [02:38<07:43,  4.00s/it]Best trial: 31. Best value: 0.906501:  23%|██▎       | 35/150 [02:38<07:29,  3.91s/it]Best trial: 31. Best value: 0.906501:  23%|██▎       | 35/150 [02:44<07:29,  3.91s/it]Best trial: 31. Best value: 0.906501:  24%|██▍       | 36/150 [02:44<08:30,  4.48s/it]Best trial: 31. Best value: 0.906501:  24%|██▍       | 36/150 [02:50<08:30,  4.48s/it]Best trial: 31. Best value: 0.906501:  25%|██▍       | 37/150 [02:50<09:23,  4.99s/it]Best trial: 31. Best value: 0.906501:  25%|██▍       | 37/150 [02:53<09:23,  4.99s/it]Best trial: 31. Best value: 0.906501:  25%|██▌       | 38/150 [02:53<08:31,  4.56s/it]Best trial: 31. Best value: 0.906501:  25%|██▌       | 38/150 [02:57<08:31,  4.56s/it]Best trial: 31. Best value: 0.906501:  26%|██▌       | 39/150 [02:57<08:10,  4.42s/it]Best trial: 31. Best value: 0.906501:  26%|██▌       | 39/150 [03:02<08:10,  4.42s/it]Best trial: 31. Best value: 0.906501:  27%|██▋       | 40/150 [03:02<07:59,  4.36s/it]Best trial: 31. Best value: 0.906501:  27%|██▋       | 40/150 [03:06<07:59,  4.36s/it]Best trial: 31. Best value: 0.906501:  27%|██▋       | 41/150 [03:06<07:47,  4.29s/it]Best trial: 31. Best value: 0.906501:  27%|██▋       | 41/150 [03:11<07:47,  4.29s/it]Best trial: 31. Best value: 0.906501:  28%|██▊       | 42/150 [03:11<08:00,  4.45s/it]Best trial: 31. Best value: 0.906501:  28%|██▊       | 42/150 [03:17<08:00,  4.45s/it]Best trial: 31. Best value: 0.906501:  29%|██▊       | 43/150 [03:17<08:56,  5.01s/it]Best trial: 31. Best value: 0.906501:  29%|██▊       | 43/150 [03:20<08:56,  5.01s/it]Best trial: 31. Best value: 0.906501:  29%|██▉       | 44/150 [03:20<08:04,  4.57s/it]Best trial: 31. Best value: 0.906501:  29%|██▉       | 44/150 [03:24<08:04,  4.57s/it]Best trial: 31. Best value: 0.906501:  30%|███       | 45/150 [03:24<07:35,  4.34s/it]Best trial: 31. Best value: 0.906501:  30%|███       | 45/150 [03:28<07:35,  4.34s/it]Best trial: 31. Best value: 0.906501:  31%|███       | 46/150 [03:28<07:15,  4.19s/it]Best trial: 31. Best value: 0.906501:  31%|███       | 46/150 [03:33<07:15,  4.19s/it]Best trial: 31. Best value: 0.906501:  31%|███▏      | 47/150 [03:33<07:38,  4.45s/it]Best trial: 31. Best value: 0.906501:  31%|███▏      | 47/150 [03:37<07:38,  4.45s/it]Best trial: 31. Best value: 0.906501:  32%|███▏      | 48/150 [03:37<07:07,  4.19s/it]Best trial: 31. Best value: 0.906501:  32%|███▏      | 48/150 [03:41<07:07,  4.19s/it]Best trial: 31. Best value: 0.906501:  33%|███▎      | 49/150 [03:41<07:19,  4.36s/it]Best trial: 31. Best value: 0.906501:  33%|███▎      | 49/150 [03:46<07:19,  4.36s/it]Best trial: 31. Best value: 0.906501:  33%|███▎      | 50/150 [03:46<07:34,  4.55s/it]Best trial: 31. Best value: 0.906501:  33%|███▎      | 50/150 [03:50<07:34,  4.55s/it]Best trial: 31. Best value: 0.906501:  34%|███▍      | 51/150 [03:50<07:01,  4.26s/it]Best trial: 31. Best value: 0.906501:  34%|███▍      | 51/150 [03:54<07:01,  4.26s/it]Best trial: 31. Best value: 0.906501:  35%|███▍      | 52/150 [03:54<06:53,  4.22s/it]Best trial: 31. Best value: 0.906501:  35%|███▍      | 52/150 [03:58<06:53,  4.22s/it]Best trial: 31. Best value: 0.906501:  35%|███▌      | 53/150 [03:58<06:46,  4.19s/it]Best trial: 31. Best value: 0.906501:  35%|███▌      | 53/150 [04:02<06:46,  4.19s/it]Best trial: 31. Best value: 0.906501:  36%|███▌      | 54/150 [04:02<06:41,  4.19s/it]Best trial: 31. Best value: 0.906501:  36%|███▌      | 54/150 [04:08<06:41,  4.19s/it]Best trial: 31. Best value: 0.906501:  37%|███▋      | 55/150 [04:08<07:04,  4.47s/it]Best trial: 31. Best value: 0.906501:  37%|███▋      | 55/150 [04:13<07:04,  4.47s/it]Best trial: 31. Best value: 0.906501:  37%|███▋      | 56/150 [04:13<07:38,  4.88s/it]Best trial: 31. Best value: 0.906501:  37%|███▋      | 56/150 [04:20<07:38,  4.88s/it]Best trial: 31. Best value: 0.906501:  38%|███▊      | 57/150 [04:20<08:06,  5.24s/it]Best trial: 31. Best value: 0.906501:  38%|███▊      | 57/150 [04:26<08:06,  5.24s/it]Best trial: 31. Best value: 0.906501:  39%|███▊      | 58/150 [04:26<08:33,  5.58s/it]Best trial: 31. Best value: 0.906501:  39%|███▊      | 58/150 [04:30<08:33,  5.58s/it]Best trial: 31. Best value: 0.906501:  39%|███▉      | 59/150 [04:30<07:44,  5.11s/it]Best trial: 31. Best value: 0.906501:  39%|███▉      | 59/150 [04:36<07:44,  5.11s/it]Best trial: 31. Best value: 0.906501:  40%|████      | 60/150 [04:36<07:53,  5.26s/it]Best trial: 31. Best value: 0.906501:  40%|████      | 60/150 [04:40<07:53,  5.26s/it]Best trial: 31. Best value: 0.906501:  41%|████      | 61/150 [04:40<07:31,  5.08s/it]Best trial: 31. Best value: 0.906501:  41%|████      | 61/150 [04:44<07:31,  5.08s/it]Best trial: 31. Best value: 0.906501:  41%|████▏     | 62/150 [04:44<06:58,  4.76s/it]Best trial: 31. Best value: 0.906501:  41%|████▏     | 62/150 [04:51<06:58,  4.76s/it]Best trial: 31. Best value: 0.906501:  42%|████▏     | 63/150 [04:51<07:41,  5.30s/it]Best trial: 31. Best value: 0.906501:  42%|████▏     | 63/150 [04:56<07:41,  5.30s/it]Best trial: 31. Best value: 0.906501:  43%|████▎     | 64/150 [04:56<07:27,  5.20s/it]Best trial: 31. Best value: 0.906501:  43%|████▎     | 64/150 [05:00<07:27,  5.20s/it]Best trial: 31. Best value: 0.906501:  43%|████▎     | 65/150 [05:00<06:59,  4.93s/it]Best trial: 31. Best value: 0.906501:  43%|████▎     | 65/150 [05:04<06:59,  4.93s/it]Best trial: 31. Best value: 0.906501:  44%|████▍     | 66/150 [05:04<06:31,  4.65s/it]Best trial: 31. Best value: 0.906501:  44%|████▍     | 66/150 [05:10<06:31,  4.65s/it]Best trial: 31. Best value: 0.906501:  45%|████▍     | 67/150 [05:10<06:54,  5.00s/it]Best trial: 31. Best value: 0.906501:  45%|████▍     | 67/150 [05:14<06:54,  5.00s/it]Best trial: 31. Best value: 0.906501:  45%|████▌     | 68/150 [05:14<06:29,  4.75s/it]Best trial: 31. Best value: 0.906501:  45%|████▌     | 68/150 [05:20<06:29,  4.75s/it]Best trial: 31. Best value: 0.906501:  46%|████▌     | 69/150 [05:20<06:46,  5.02s/it]Best trial: 31. Best value: 0.906501:  46%|████▌     | 69/150 [05:25<06:46,  5.02s/it]Best trial: 31. Best value: 0.906501:  47%|████▋     | 70/150 [05:25<06:53,  5.17s/it]Best trial: 31. Best value: 0.906501:  47%|████▋     | 70/150 [05:29<06:53,  5.17s/it]Best trial: 31. Best value: 0.906501:  47%|████▋     | 71/150 [05:29<06:19,  4.80s/it]Best trial: 31. Best value: 0.906501:  47%|████▋     | 71/150 [05:34<06:19,  4.80s/it]Best trial: 31. Best value: 0.906501:  48%|████▊     | 72/150 [05:34<06:14,  4.80s/it]Best trial: 31. Best value: 0.906501:  48%|████▊     | 72/150 [05:40<06:14,  4.80s/it]Best trial: 31. Best value: 0.906501:  49%|████▊     | 73/150 [05:40<06:42,  5.23s/it]Best trial: 31. Best value: 0.906501:  49%|████▊     | 73/150 [05:44<06:42,  5.23s/it]Best trial: 31. Best value: 0.906501:  49%|████▉     | 74/150 [05:44<05:56,  4.69s/it]Best trial: 31. Best value: 0.906501:  49%|████▉     | 74/150 [05:49<05:56,  4.69s/it]Best trial: 31. Best value: 0.906501:  50%|█████     | 75/150 [05:49<06:06,  4.89s/it]Best trial: 31. Best value: 0.906501:  50%|█████     | 75/150 [05:54<06:06,  4.89s/it]Best trial: 31. Best value: 0.906501:  51%|█████     | 76/150 [05:54<06:09,  4.99s/it]Best trial: 31. Best value: 0.906501:  51%|█████     | 76/150 [05:59<06:09,  4.99s/it]Best trial: 31. Best value: 0.906501:  51%|█████▏    | 77/150 [05:59<06:03,  4.97s/it]Best trial: 31. Best value: 0.906501:  51%|█████▏    | 77/150 [06:04<06:03,  4.97s/it]Best trial: 31. Best value: 0.906501:  52%|█████▏    | 78/150 [06:04<06:03,  5.05s/it]Best trial: 31. Best value: 0.906501:  52%|█████▏    | 78/150 [06:09<06:03,  5.05s/it]Best trial: 31. Best value: 0.906501:  53%|█████▎    | 79/150 [06:09<06:01,  5.09s/it]Best trial: 31. Best value: 0.906501:  53%|█████▎    | 79/150 [06:15<06:01,  5.09s/it]Best trial: 31. Best value: 0.906501:  53%|█████▎    | 80/150 [06:15<05:58,  5.13s/it]Best trial: 31. Best value: 0.906501:  53%|█████▎    | 80/150 [06:19<05:58,  5.13s/it]Best trial: 31. Best value: 0.906501:  54%|█████▍    | 81/150 [06:19<05:44,  4.99s/it]Best trial: 31. Best value: 0.906501:  54%|█████▍    | 81/150 [06:24<05:44,  4.99s/it]Best trial: 31. Best value: 0.906501:  55%|█████▍    | 82/150 [06:24<05:34,  4.91s/it]Best trial: 31. Best value: 0.906501:  55%|█████▍    | 82/150 [06:28<05:34,  4.91s/it]Best trial: 31. Best value: 0.906501:  55%|█████▌    | 83/150 [06:28<05:07,  4.58s/it]Best trial: 31. Best value: 0.906501:  55%|█████▌    | 83/150 [06:33<05:07,  4.58s/it]Best trial: 31. Best value: 0.906501:  56%|█████▌    | 84/150 [06:33<05:11,  4.72s/it]Best trial: 31. Best value: 0.906501:  56%|█████▌    | 84/150 [06:37<05:11,  4.72s/it]Best trial: 31. Best value: 0.906501:  57%|█████▋    | 85/150 [06:37<04:48,  4.43s/it]Best trial: 31. Best value: 0.906501:  57%|█████▋    | 85/150 [06:40<04:48,  4.43s/it]Best trial: 31. Best value: 0.906501:  57%|█████▋    | 86/150 [06:40<04:29,  4.22s/it]Best trial: 31. Best value: 0.906501:  57%|█████▋    | 86/150 [06:45<04:29,  4.22s/it]Best trial: 31. Best value: 0.906501:  58%|█████▊    | 87/150 [06:45<04:23,  4.18s/it]Best trial: 31. Best value: 0.906501:  58%|█████▊    | 87/150 [06:51<04:23,  4.18s/it]Best trial: 31. Best value: 0.906501:  59%|█████▊    | 88/150 [06:51<05:02,  4.88s/it]Best trial: 31. Best value: 0.906501:  59%|█████▊    | 88/150 [06:55<05:02,  4.88s/it]Best trial: 31. Best value: 0.906501:  59%|█████▉    | 89/150 [06:55<04:37,  4.55s/it]Best trial: 31. Best value: 0.906501:  59%|█████▉    | 89/150 [06:59<04:37,  4.55s/it]Best trial: 31. Best value: 0.906501:  60%|██████    | 90/150 [06:59<04:21,  4.36s/it]Best trial: 31. Best value: 0.906501:  60%|██████    | 90/150 [07:04<04:21,  4.36s/it]Best trial: 31. Best value: 0.906501:  61%|██████    | 91/150 [07:04<04:37,  4.70s/it]Best trial: 31. Best value: 0.906501:  61%|██████    | 91/150 [07:10<04:37,  4.70s/it]Best trial: 31. Best value: 0.906501:  61%|██████▏   | 92/150 [07:10<04:43,  4.88s/it]Best trial: 31. Best value: 0.906501:  61%|██████▏   | 92/150 [07:14<04:43,  4.88s/it]Best trial: 31. Best value: 0.906501:  62%|██████▏   | 93/150 [07:14<04:25,  4.65s/it]Best trial: 31. Best value: 0.906501:  62%|██████▏   | 93/150 [07:19<04:25,  4.65s/it]Best trial: 31. Best value: 0.906501:  63%|██████▎   | 94/150 [07:19<04:35,  4.92s/it]Best trial: 31. Best value: 0.906501:  63%|██████▎   | 94/150 [07:24<04:35,  4.92s/it]Best trial: 31. Best value: 0.906501:  63%|██████▎   | 95/150 [07:24<04:21,  4.76s/it]Best trial: 31. Best value: 0.906501:  63%|██████▎   | 95/150 [07:28<04:21,  4.76s/it]Best trial: 31. Best value: 0.906501:  64%|██████▍   | 96/150 [07:28<04:06,  4.56s/it]Best trial: 31. Best value: 0.906501:  64%|██████▍   | 96/150 [07:32<04:06,  4.56s/it]Best trial: 31. Best value: 0.906501:  65%|██████▍   | 97/150 [07:32<04:03,  4.59s/it]Best trial: 31. Best value: 0.906501:  65%|██████▍   | 97/150 [07:37<04:03,  4.59s/it]Best trial: 31. Best value: 0.906501:  65%|██████▌   | 98/150 [07:37<04:02,  4.66s/it]Best trial: 31. Best value: 0.906501:  65%|██████▌   | 98/150 [07:42<04:02,  4.66s/it]Best trial: 31. Best value: 0.906501:  66%|██████▌   | 99/150 [07:42<03:54,  4.59s/it]Best trial: 31. Best value: 0.906501:  66%|██████▌   | 99/150 [07:47<03:54,  4.59s/it]Best trial: 31. Best value: 0.906501:  67%|██████▋   | 100/150 [07:47<03:57,  4.76s/it]Best trial: 31. Best value: 0.906501:  67%|██████▋   | 100/150 [07:51<03:57,  4.76s/it]Best trial: 31. Best value: 0.906501:  67%|██████▋   | 101/150 [07:51<03:44,  4.59s/it]Best trial: 31. Best value: 0.906501:  67%|██████▋   | 101/150 [07:56<03:44,  4.59s/it]Best trial: 31. Best value: 0.906501:  68%|██████▊   | 102/150 [07:56<03:53,  4.86s/it]Best trial: 31. Best value: 0.906501:  68%|██████▊   | 102/150 [08:02<03:53,  4.86s/it]Best trial: 31. Best value: 0.906501:  69%|██████▊   | 103/150 [08:02<03:51,  4.93s/it]Best trial: 31. Best value: 0.906501:  69%|██████▊   | 103/150 [08:07<03:51,  4.93s/it]Best trial: 31. Best value: 0.906501:  69%|██████▉   | 104/150 [08:07<03:52,  5.05s/it]Best trial: 31. Best value: 0.906501:  69%|██████▉   | 104/150 [08:11<03:52,  5.05s/it]Best trial: 31. Best value: 0.906501:  70%|███████   | 105/150 [08:11<03:37,  4.83s/it]Best trial: 31. Best value: 0.906501:  70%|███████   | 105/150 [08:15<03:37,  4.83s/it]Best trial: 31. Best value: 0.906501:  71%|███████   | 106/150 [08:15<03:25,  4.68s/it]Best trial: 31. Best value: 0.906501:  71%|███████   | 106/150 [08:20<03:25,  4.68s/it]Best trial: 31. Best value: 0.906501:  71%|███████▏  | 107/150 [08:20<03:25,  4.77s/it]Best trial: 31. Best value: 0.906501:  71%|███████▏  | 107/150 [08:24<03:25,  4.77s/it]Best trial: 31. Best value: 0.906501:  72%|███████▏  | 108/150 [08:24<03:05,  4.42s/it]Best trial: 31. Best value: 0.906501:  72%|███████▏  | 108/150 [08:28<03:05,  4.42s/it]Best trial: 31. Best value: 0.906501:  73%|███████▎  | 109/150 [08:28<02:52,  4.20s/it]Best trial: 31. Best value: 0.906501:  73%|███████▎  | 109/150 [08:32<02:52,  4.20s/it]Best trial: 31. Best value: 0.906501:  73%|███████▎  | 110/150 [08:32<02:49,  4.24s/it]Best trial: 31. Best value: 0.906501:  73%|███████▎  | 110/150 [08:36<02:49,  4.24s/it]Best trial: 31. Best value: 0.906501:  74%|███████▍  | 111/150 [08:36<02:41,  4.15s/it]Best trial: 31. Best value: 0.906501:  74%|███████▍  | 111/150 [08:39<02:41,  4.15s/it]Best trial: 31. Best value: 0.906501:  75%|███████▍  | 112/150 [08:39<02:28,  3.91s/it]Best trial: 31. Best value: 0.906501:  75%|███████▍  | 112/150 [08:44<02:28,  3.91s/it]Best trial: 31. Best value: 0.906501:  75%|███████▌  | 113/150 [08:44<02:33,  4.16s/it]Best trial: 31. Best value: 0.906501:  75%|███████▌  | 113/150 [08:48<02:33,  4.16s/it]Best trial: 31. Best value: 0.906501:  76%|███████▌  | 114/150 [08:48<02:23,  4.00s/it]Best trial: 31. Best value: 0.906501:  76%|███████▌  | 114/150 [08:53<02:23,  4.00s/it]Best trial: 31. Best value: 0.906501:  77%|███████▋  | 115/150 [08:53<02:29,  4.26s/it]Best trial: 31. Best value: 0.906501:  77%|███████▋  | 115/150 [08:57<02:29,  4.26s/it]Best trial: 31. Best value: 0.906501:  77%|███████▋  | 116/150 [08:57<02:25,  4.29s/it]Best trial: 31. Best value: 0.906501:  77%|███████▋  | 116/150 [09:01<02:25,  4.29s/it]Best trial: 31. Best value: 0.906501:  78%|███████▊  | 117/150 [09:01<02:20,  4.26s/it]Best trial: 31. Best value: 0.906501:  78%|███████▊  | 117/150 [09:04<02:20,  4.26s/it]Best trial: 31. Best value: 0.906501:  79%|███████▊  | 118/150 [09:04<02:07,  3.97s/it]Best trial: 31. Best value: 0.906501:  79%|███████▊  | 118/150 [09:08<02:07,  3.97s/it]Best trial: 31. Best value: 0.906501:  79%|███████▉  | 119/150 [09:08<02:02,  3.97s/it]Best trial: 31. Best value: 0.906501:  79%|███████▉  | 119/150 [09:12<02:02,  3.97s/it]Best trial: 31. Best value: 0.906501:  80%|████████  | 120/150 [09:12<01:54,  3.83s/it]Best trial: 31. Best value: 0.906501:  80%|████████  | 120/150 [09:15<01:54,  3.83s/it]Best trial: 31. Best value: 0.906501:  81%|████████  | 121/150 [09:15<01:47,  3.70s/it]Best trial: 31. Best value: 0.906501:  81%|████████  | 121/150 [09:19<01:47,  3.70s/it]Best trial: 31. Best value: 0.906501:  81%|████████▏ | 122/150 [09:19<01:41,  3.61s/it]Best trial: 31. Best value: 0.906501:  81%|████████▏ | 122/150 [09:23<01:41,  3.61s/it]Best trial: 31. Best value: 0.906501:  82%|████████▏ | 123/150 [09:23<01:43,  3.84s/it]Best trial: 31. Best value: 0.906501:  82%|████████▏ | 123/150 [09:27<01:43,  3.84s/it]Best trial: 31. Best value: 0.906501:  83%|████████▎ | 124/150 [09:27<01:39,  3.85s/it]Best trial: 31. Best value: 0.906501:  83%|████████▎ | 124/150 [09:31<01:39,  3.85s/it]Best trial: 31. Best value: 0.906501:  83%|████████▎ | 125/150 [09:31<01:35,  3.81s/it]Best trial: 31. Best value: 0.906501:  83%|████████▎ | 125/150 [09:35<01:35,  3.81s/it]Best trial: 31. Best value: 0.906501:  84%|████████▍ | 126/150 [09:35<01:32,  3.84s/it]Best trial: 31. Best value: 0.906501:  84%|████████▍ | 126/150 [09:39<01:32,  3.84s/it]Best trial: 31. Best value: 0.906501:  85%|████████▍ | 127/150 [09:39<01:31,  3.99s/it]Best trial: 31. Best value: 0.906501:  85%|████████▍ | 127/150 [09:44<01:31,  3.99s/it]Best trial: 31. Best value: 0.906501:  85%|████████▌ | 128/150 [09:44<01:32,  4.19s/it]Best trial: 31. Best value: 0.906501:  85%|████████▌ | 128/150 [09:47<01:32,  4.19s/it]Best trial: 31. Best value: 0.906501:  86%|████████▌ | 129/150 [09:47<01:25,  4.06s/it]Best trial: 31. Best value: 0.906501:  86%|████████▌ | 129/150 [09:51<01:25,  4.06s/it]Best trial: 31. Best value: 0.906501:  87%|████████▋ | 130/150 [09:51<01:18,  3.92s/it]Best trial: 31. Best value: 0.906501:  87%|████████▋ | 130/150 [09:55<01:18,  3.92s/it]Best trial: 31. Best value: 0.906501:  87%|████████▋ | 131/150 [09:55<01:13,  3.88s/it]Best trial: 31. Best value: 0.906501:  87%|████████▋ | 131/150 [09:58<01:13,  3.88s/it]Best trial: 31. Best value: 0.906501:  88%|████████▊ | 132/150 [09:58<01:08,  3.83s/it]Best trial: 31. Best value: 0.906501:  88%|████████▊ | 132/150 [10:02<01:08,  3.83s/it]Best trial: 31. Best value: 0.906501:  89%|████████▊ | 133/150 [10:02<01:03,  3.74s/it]Best trial: 31. Best value: 0.906501:  89%|████████▊ | 133/150 [10:06<01:03,  3.74s/it]Best trial: 31. Best value: 0.906501:  89%|████████▉ | 134/150 [10:06<00:59,  3.73s/it]Best trial: 31. Best value: 0.906501:  89%|████████▉ | 134/150 [10:09<00:59,  3.73s/it]Best trial: 31. Best value: 0.906501:  90%|█████████ | 135/150 [10:09<00:53,  3.55s/it]Best trial: 31. Best value: 0.906501:  90%|█████████ | 135/150 [10:12<00:53,  3.55s/it]Best trial: 31. Best value: 0.906501:  91%|█████████ | 136/150 [10:12<00:49,  3.52s/it]Best trial: 31. Best value: 0.906501:  91%|█████████ | 136/150 [10:16<00:49,  3.52s/it]Best trial: 31. Best value: 0.906501:  91%|█████████▏| 137/150 [10:16<00:45,  3.53s/it]Best trial: 31. Best value: 0.906501:  91%|█████████▏| 137/150 [10:20<00:45,  3.53s/it]Best trial: 31. Best value: 0.906501:  92%|█████████▏| 138/150 [10:20<00:44,  3.67s/it]Best trial: 31. Best value: 0.906501:  92%|█████████▏| 138/150 [10:23<00:44,  3.67s/it]Best trial: 31. Best value: 0.906501:  93%|█████████▎| 139/150 [10:23<00:39,  3.55s/it]Best trial: 31. Best value: 0.906501:  93%|█████████▎| 139/150 [10:26<00:39,  3.55s/it]Best trial: 31. Best value: 0.906501:  93%|█████████▎| 140/150 [10:26<00:34,  3.45s/it]Best trial: 31. Best value: 0.906501:  93%|█████████▎| 140/150 [10:30<00:34,  3.45s/it]Best trial: 31. Best value: 0.906501:  94%|█████████▍| 141/150 [10:30<00:30,  3.39s/it]Best trial: 31. Best value: 0.906501:  94%|█████████▍| 141/150 [10:33<00:30,  3.39s/it]Best trial: 31. Best value: 0.906501:  95%|█████████▍| 142/150 [10:33<00:26,  3.34s/it]Best trial: 31. Best value: 0.906501:  95%|█████████▍| 142/150 [10:37<00:26,  3.34s/it]Best trial: 31. Best value: 0.906501:  95%|█████████▌| 143/150 [10:37<00:25,  3.57s/it]Best trial: 31. Best value: 0.906501:  95%|█████████▌| 143/150 [10:41<00:25,  3.57s/it]Best trial: 31. Best value: 0.906501:  96%|█████████▌| 144/150 [10:41<00:21,  3.64s/it]Best trial: 31. Best value: 0.906501:  96%|█████████▌| 144/150 [10:45<00:21,  3.64s/it]Best trial: 31. Best value: 0.906501:  97%|█████████▋| 145/150 [10:45<00:18,  3.75s/it]Best trial: 31. Best value: 0.906501:  97%|█████████▋| 145/150 [10:48<00:18,  3.75s/it]Best trial: 31. Best value: 0.906501:  97%|█████████▋| 146/150 [10:48<00:14,  3.73s/it]Best trial: 31. Best value: 0.906501:  97%|█████████▋| 146/150 [10:52<00:14,  3.73s/it]Best trial: 31. Best value: 0.906501:  98%|█████████▊| 147/150 [10:52<00:11,  3.69s/it]Best trial: 31. Best value: 0.906501:  98%|█████████▊| 147/150 [10:56<00:11,  3.69s/it]Best trial: 31. Best value: 0.906501:  99%|█████████▊| 148/150 [10:56<00:07,  3.66s/it]Best trial: 31. Best value: 0.906501:  99%|█████████▊| 148/150 [10:59<00:07,  3.66s/it]Best trial: 31. Best value: 0.906501:  99%|█████████▉| 149/150 [10:59<00:03,  3.57s/it]Best trial: 31. Best value: 0.906501:  99%|█████████▉| 149/150 [11:02<00:03,  3.57s/it]Best trial: 31. Best value: 0.906501: 100%|██████████| 150/150 [11:02<00:00,  3.51s/it]Best trial: 31. Best value: 0.906501: 100%|██████████| 150/150 [11:02<00:00,  4.42s/it]
14:18:25 [INFO] models.training.ordinal_trainer: Best params: {'bootstrap_type': 'Bernoulli', 'depth': 4, 'iterations': 343, 'learning_rate': 0.14237398618592004, 'border_count': 40, 'l2_leaf_reg': 1.910221327235891, 'min_data_in_leaf': 26, 'random_strength': 0.7797945982443865, 'colsample_bylevel': 0.6728156033735899, 'subsample': 0.6198949993373627}
14:18:25 [INFO] models.training.ordinal_trainer: Best AUC: 0.9065
14:18:25 [WARNING] models.training.ordinal_trainer: Threshold -9: extreme imbalance (pos_rate=1.0000), using constant predictor
14:18:25 [WARNING] models.training.ordinal_trainer: Threshold -8: extreme imbalance (pos_rate=1.0000), using constant predictor
14:18:25 [WARNING] models.training.ordinal_trainer: Threshold -7: extreme imbalance (pos_rate=1.0000), using constant predictor
14:18:25 [WARNING] models.training.ordinal_trainer: Threshold -6: extreme imbalance (pos_rate=1.0000), using constant predictor
14:18:25 [WARNING] models.training.ordinal_trainer: Threshold -5: extreme imbalance (pos_rate=1.0000), using constant predictor
14:18:25 [WARNING] models.training.ordinal_trainer: Threshold -4: extreme imbalance (pos_rate=1.0000), using constant predictor
14:18:25 [WARNING] models.training.ordinal_trainer: Threshold -3: extreme imbalance (pos_rate=1.0000), using constant predictor
14:18:25 [WARNING] models.training.ordinal_trainer: Threshold -2: extreme imbalance (pos_rate=1.0000), using constant predictor
14:18:25 [INFO] models.training.ordinal_trainer:   Threshold -1: trained (pos_rate=71.0%)
14:18:26 [INFO] models.training.ordinal_trainer:   Threshold +0: trained (pos_rate=65.1%)
14:18:26 [INFO] models.training.ordinal_trainer:   Threshold +1: trained (pos_rate=46.6%)
14:18:27 [INFO] models.training.ordinal_trainer:   Threshold +2: trained (pos_rate=38.3%)
14:18:27 [INFO] models.training.ordinal_trainer:   Threshold +3: trained (pos_rate=30.4%)
14:18:28 [INFO] models.training.ordinal_trainer:   Threshold +4: trained (pos_rate=25.6%)
14:18:28 [INFO] models.training.ordinal_trainer:   Threshold +5: trained (pos_rate=20.0%)
14:18:29 [INFO] models.training.ordinal_trainer:   Threshold +6: trained (pos_rate=17.1%)
14:18:29 [INFO] models.training.ordinal_trainer:   Threshold +7: trained (pos_rate=13.9%)
14:18:30 [INFO] models.training.ordinal_trainer:   Threshold +8: trained (pos_rate=11.9%)
14:18:30 [INFO] models.training.ordinal_trainer:   Threshold +9: trained (pos_rate=9.4%)
14:18:30 [INFO] models.training.ordinal_trainer:   Threshold +10: trained (pos_rate=8.1%)
14:18:30 [INFO] models.training.ordinal_trainer: Ordinal training complete: 20 classifiers
14:18:31 [INFO] models.training.ordinal_trainer: Saved ordinal model to models/saved/austin/ordinal_catboost_optuna.pkl
14:18:31 [INFO] __main__: 
Saved model to models/saved/austin/ordinal_catboost_optuna.pkl
14:18:31 [INFO] __main__: Saved best params to models/saved/austin/best_params.json
14:18:31 [INFO] __main__: Saved final metrics to models/saved/austin/final_metrics_austin.json

============================================================
EVALUATION
============================================================

Test Set Metrics:
----------------------------------------
  delta_accuracy: 0.2300
  delta_mae: 2.5368
  off_by_1_rate: 0.2481
  off_by_2plus_rate: 0.5218
  within_1_rate: 0.4782
  within_2_rate: 0.6825

============================================================
FEATURE IMPORTANCE
============================================================
Traceback (most recent call last):
  File "/mnt/slow_weather_updated/scripts/train_city_ordinal_optuna.py", line 436, in <module>
    sys.exit(main())
             ^^^^^^
  File "/mnt/slow_weather_updated/scripts/train_city_ordinal_optuna.py", line 384, in main
    fi = trainer.get_feature_importance()
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/slow_weather_updated/models/training/ordinal_trainer.py", line 542, in get_feature_importance
    imp = clf.get_feature_importance()
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'dict' object has no attribute 'get_feature_importance'
