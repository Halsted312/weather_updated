nohup: ignoring input
13:57:23 [INFO] __main__: ============================================================
13:57:23 [INFO] __main__: AUSTIN Optuna Training (100 trials)
13:57:23 [INFO] __main__: ============================================================
13:57:23 [INFO] src.db.connection: Database engine created: localhost:5434/kalshi_weather
13:57:23 [INFO] __main__: Available data: 2023-01-01 to 2025-11-27
13:57:23 [INFO] __main__: Total days: 1062
13:57:23 [INFO] __main__: Training: 2023-01-01 to 2025-04-28 (850 days)
13:57:23 [INFO] __main__: Testing:  2025-04-29 to 2025-11-27 (212 days)
13:57:23 [INFO] __main__: Loading cached datasets...
13:57:24 [INFO] __main__: Loaded train: 129,928 rows, test: 32,376 rows
13:57:24 [INFO] __main__: 
Training samples: 129,928
13:57:24 [INFO] __main__: Training days: 855
13:57:24 [INFO] __main__: Test samples: 32,376
13:57:24 [INFO] __main__: Test days: 213
13:57:24 [INFO] __main__: 
Station-city features: ['station_city_temp_gap', 'station_city_max_gap_sofar', 'station_city_mean_gap_sofar', 'station_city_gap_std', 'station_city_gap_trend']
13:57:24 [INFO] __main__:   station_city_temp_gap: 129,896/129,928 non-null (100.0%)
13:57:24 [INFO] __main__:   station_city_max_gap_sofar: 129,896/129,928 non-null (100.0%)
13:57:24 [INFO] __main__:   station_city_mean_gap_sofar: 129,896/129,928 non-null (100.0%)
13:57:24 [INFO] __main__:   station_city_gap_std: 129,896/129,928 non-null (100.0%)
13:57:24 [INFO] __main__:   station_city_gap_trend: 129,894/129,928 non-null (100.0%)
13:57:24 [INFO] __main__: 
Multi-horizon features: ['fcst_multi_mean', 'fcst_multi_median', 'fcst_multi_ema', 'fcst_multi_std', 'fcst_multi_range', 'fcst_multi_t1_t2_diff', 'fcst_multi_drift']
13:57:24 [INFO] __main__:   fcst_multi_mean: 129,928/129,928 non-null (100.0%)
13:57:24 [INFO] __main__:   fcst_multi_median: 129,928/129,928 non-null (100.0%)
13:57:24 [INFO] __main__:   fcst_multi_ema: 129,928/129,928 non-null (100.0%)
13:57:24 [INFO] __main__:   fcst_multi_std: 129,928/129,928 non-null (100.0%)
13:57:24 [INFO] __main__:   fcst_multi_range: 129,928/129,928 non-null (100.0%)
13:57:24 [INFO] __main__:   fcst_multi_t1_t2_diff: 129,928/129,928 non-null (100.0%)
13:57:24 [INFO] __main__:   fcst_multi_drift: 129,928/129,928 non-null (100.0%)
13:57:26 [INFO] models.training.ordinal_trainer: Training ordinal model (catboost) on 129928 samples
13:57:26 [INFO] models.training.ordinal_trainer: City delta range: [-2, 10]
13:57:26 [INFO] models.training.ordinal_trainer: Training 12 threshold classifiers: [-1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
13:57:26 [INFO] models.training.ordinal_trainer: Starting Optuna tuning with 100 trials

============================================================
OPTUNA TRAINING (100 trials)
============================================================
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.901953:   0%|          | 0/100 [00:03<?, ?it/s]Best trial: 0. Best value: 0.901953:   1%|          | 1/100 [00:03<05:18,  3.22s/it]Best trial: 0. Best value: 0.901953:   1%|          | 1/100 [00:07<05:18,  3.22s/it]Best trial: 0. Best value: 0.901953:   2%|▏         | 2/100 [00:07<06:12,  3.80s/it]Best trial: 0. Best value: 0.901953:   2%|▏         | 2/100 [00:10<06:12,  3.80s/it]Best trial: 0. Best value: 0.901953:   3%|▎         | 3/100 [00:10<05:52,  3.64s/it]Best trial: 0. Best value: 0.901953:   3%|▎         | 3/100 [00:14<05:52,  3.64s/it]Best trial: 0. Best value: 0.901953:   4%|▍         | 4/100 [00:14<05:30,  3.44s/it]Best trial: 0. Best value: 0.901953:   4%|▍         | 4/100 [00:17<05:30,  3.44s/it]Best trial: 0. Best value: 0.901953:   5%|▌         | 5/100 [00:17<05:20,  3.38s/it]Best trial: 0. Best value: 0.901953:   5%|▌         | 5/100 [00:20<05:20,  3.38s/it]Best trial: 0. Best value: 0.901953:   6%|▌         | 6/100 [00:20<05:06,  3.26s/it]Best trial: 0. Best value: 0.901953:   6%|▌         | 6/100 [00:23<05:06,  3.26s/it]Best trial: 0. Best value: 0.901953:   7%|▋         | 7/100 [00:23<04:55,  3.18s/it]Best trial: 0. Best value: 0.901953:   7%|▋         | 7/100 [00:26<04:55,  3.18s/it]Best trial: 0. Best value: 0.901953:   8%|▊         | 8/100 [00:26<04:48,  3.14s/it]Best trial: 0. Best value: 0.901953:   8%|▊         | 8/100 [00:29<04:48,  3.14s/it]Best trial: 0. Best value: 0.901953:   9%|▉         | 9/100 [00:29<04:52,  3.21s/it]Best trial: 9. Best value: 0.902464:   9%|▉         | 9/100 [00:33<04:52,  3.21s/it]Best trial: 9. Best value: 0.902464:  10%|█         | 10/100 [00:33<04:51,  3.23s/it]Best trial: 9. Best value: 0.902464:  10%|█         | 10/100 [00:36<04:51,  3.23s/it]Best trial: 9. Best value: 0.902464:  11%|█         | 11/100 [00:36<04:41,  3.16s/it]Best trial: 9. Best value: 0.902464:  11%|█         | 11/100 [00:39<04:41,  3.16s/it]Best trial: 9. Best value: 0.902464:  12%|█▏        | 12/100 [00:39<04:34,  3.11s/it]Best trial: 9. Best value: 0.902464:  12%|█▏        | 12/100 [00:43<04:34,  3.11s/it]Best trial: 9. Best value: 0.902464:  13%|█▎        | 13/100 [00:43<04:59,  3.44s/it]Best trial: 9. Best value: 0.902464:  13%|█▎        | 13/100 [00:46<04:59,  3.44s/it]Best trial: 9. Best value: 0.902464:  14%|█▍        | 14/100 [00:46<04:54,  3.42s/it]Best trial: 9. Best value: 0.902464:  14%|█▍        | 14/100 [00:50<04:54,  3.42s/it]Best trial: 9. Best value: 0.902464:  15%|█▌        | 15/100 [00:50<05:10,  3.66s/it]Best trial: 9. Best value: 0.902464:  15%|█▌        | 15/100 [00:55<05:10,  3.66s/it]Best trial: 9. Best value: 0.902464:  16%|█▌        | 16/100 [00:55<05:23,  3.86s/it]Best trial: 9. Best value: 0.902464:  16%|█▌        | 16/100 [00:58<05:23,  3.86s/it]Best trial: 9. Best value: 0.902464:  17%|█▋        | 17/100 [00:58<05:03,  3.66s/it]Best trial: 9. Best value: 0.902464:  17%|█▋        | 17/100 [01:01<05:03,  3.66s/it]Best trial: 9. Best value: 0.902464:  18%|█▊        | 18/100 [01:01<04:53,  3.57s/it]Best trial: 18. Best value: 0.903416:  18%|█▊        | 18/100 [01:04<04:53,  3.57s/it]Best trial: 18. Best value: 0.903416:  19%|█▉        | 19/100 [01:04<04:35,  3.40s/it]Best trial: 18. Best value: 0.903416:  19%|█▉        | 19/100 [01:07<04:35,  3.40s/it]Best trial: 18. Best value: 0.903416:  20%|██        | 20/100 [01:07<04:19,  3.25s/it]Best trial: 18. Best value: 0.903416:  20%|██        | 20/100 [01:10<04:19,  3.25s/it]Best trial: 18. Best value: 0.903416:  21%|██        | 21/100 [01:10<04:10,  3.18s/it]Best trial: 18. Best value: 0.903416:  21%|██        | 21/100 [01:14<04:10,  3.18s/it]Best trial: 18. Best value: 0.903416:  22%|██▏       | 22/100 [01:14<04:20,  3.34s/it]Best trial: 18. Best value: 0.903416:  22%|██▏       | 22/100 [01:17<04:20,  3.34s/it]Best trial: 18. Best value: 0.903416:  23%|██▎       | 23/100 [01:17<04:14,  3.30s/it]Best trial: 18. Best value: 0.903416:  23%|██▎       | 23/100 [01:20<04:14,  3.30s/it]Best trial: 18. Best value: 0.903416:  24%|██▍       | 24/100 [01:20<04:03,  3.21s/it]Best trial: 18. Best value: 0.903416:  24%|██▍       | 24/100 [01:23<04:03,  3.21s/it]Best trial: 18. Best value: 0.903416:  25%|██▌       | 25/100 [01:23<03:56,  3.15s/it]Best trial: 18. Best value: 0.903416:  25%|██▌       | 25/100 [01:27<03:56,  3.15s/it]Best trial: 18. Best value: 0.903416:  26%|██▌       | 26/100 [01:27<04:15,  3.45s/it]Best trial: 18. Best value: 0.903416:  26%|██▌       | 26/100 [01:30<04:15,  3.45s/it]Best trial: 18. Best value: 0.903416:  27%|██▋       | 27/100 [01:30<04:01,  3.31s/it]Best trial: 18. Best value: 0.903416:  27%|██▋       | 27/100 [01:33<04:01,  3.31s/it]Best trial: 18. Best value: 0.903416:  28%|██▊       | 28/100 [01:33<03:44,  3.12s/it]Best trial: 18. Best value: 0.903416:  28%|██▊       | 28/100 [01:36<03:44,  3.12s/it]Best trial: 18. Best value: 0.903416:  29%|██▉       | 29/100 [01:36<03:49,  3.23s/it]Best trial: 18. Best value: 0.903416:  29%|██▉       | 29/100 [01:41<03:49,  3.23s/it]Best trial: 18. Best value: 0.903416:  30%|███       | 30/100 [01:41<04:17,  3.68s/it]Best trial: 18. Best value: 0.903416:  30%|███       | 30/100 [01:45<04:17,  3.68s/it]Best trial: 18. Best value: 0.903416:  31%|███       | 31/100 [01:45<04:25,  3.84s/it]Best trial: 18. Best value: 0.903416:  31%|███       | 31/100 [01:49<04:25,  3.84s/it]Best trial: 18. Best value: 0.903416:  32%|███▏      | 32/100 [01:49<04:17,  3.78s/it]Best trial: 18. Best value: 0.903416:  32%|███▏      | 32/100 [01:53<04:17,  3.78s/it]Best trial: 18. Best value: 0.903416:  33%|███▎      | 33/100 [01:53<04:20,  3.88s/it]Best trial: 18. Best value: 0.903416:  33%|███▎      | 33/100 [01:56<04:20,  3.88s/it]Best trial: 18. Best value: 0.903416:  34%|███▍      | 34/100 [01:56<04:04,  3.71s/it]Best trial: 18. Best value: 0.903416:  34%|███▍      | 34/100 [02:00<04:04,  3.71s/it]Best trial: 18. Best value: 0.903416:  35%|███▌      | 35/100 [02:00<03:51,  3.55s/it]Best trial: 18. Best value: 0.903416:  35%|███▌      | 35/100 [02:03<03:51,  3.55s/it]Best trial: 18. Best value: 0.903416:  36%|███▌      | 36/100 [02:03<03:51,  3.62s/it]Best trial: 18. Best value: 0.903416:  36%|███▌      | 36/100 [02:06<03:51,  3.62s/it]Best trial: 18. Best value: 0.903416:  37%|███▋      | 37/100 [02:06<03:39,  3.48s/it]Best trial: 18. Best value: 0.903416:  37%|███▋      | 37/100 [02:11<03:39,  3.48s/it]Best trial: 18. Best value: 0.903416:  38%|███▊      | 38/100 [02:11<03:52,  3.75s/it]Best trial: 18. Best value: 0.903416:  38%|███▊      | 38/100 [02:14<03:52,  3.75s/it]Best trial: 18. Best value: 0.903416:  39%|███▉      | 39/100 [02:14<03:35,  3.54s/it]Best trial: 18. Best value: 0.903416:  39%|███▉      | 39/100 [02:17<03:35,  3.54s/it]Best trial: 18. Best value: 0.903416:  40%|████      | 40/100 [02:17<03:22,  3.38s/it]Best trial: 18. Best value: 0.903416:  40%|████      | 40/100 [02:21<03:22,  3.38s/it]Best trial: 18. Best value: 0.903416:  41%|████      | 41/100 [02:21<03:27,  3.51s/it]Best trial: 18. Best value: 0.903416:  41%|████      | 41/100 [02:24<03:27,  3.51s/it]Best trial: 18. Best value: 0.903416:  42%|████▏     | 42/100 [02:24<03:13,  3.34s/it]Best trial: 18. Best value: 0.903416:  42%|████▏     | 42/100 [02:27<03:13,  3.34s/it]Best trial: 18. Best value: 0.903416:  43%|████▎     | 43/100 [02:27<03:11,  3.35s/it]Best trial: 18. Best value: 0.903416:  43%|████▎     | 43/100 [02:30<03:11,  3.35s/it]Best trial: 18. Best value: 0.903416:  44%|████▍     | 44/100 [02:30<02:58,  3.18s/it]Best trial: 18. Best value: 0.903416:  44%|████▍     | 44/100 [02:33<02:58,  3.18s/it]Best trial: 18. Best value: 0.903416:  45%|████▌     | 45/100 [02:33<02:49,  3.09s/it]Best trial: 18. Best value: 0.903416:  45%|████▌     | 45/100 [02:36<02:49,  3.09s/it]Best trial: 18. Best value: 0.903416:  46%|████▌     | 46/100 [02:36<02:45,  3.07s/it]Best trial: 18. Best value: 0.903416:  46%|████▌     | 46/100 [02:39<02:45,  3.07s/it]Best trial: 18. Best value: 0.903416:  47%|████▋     | 47/100 [02:39<02:48,  3.17s/it]Best trial: 18. Best value: 0.903416:  47%|████▋     | 47/100 [02:42<02:48,  3.17s/it]Best trial: 18. Best value: 0.903416:  48%|████▊     | 48/100 [02:42<02:37,  3.03s/it]Best trial: 18. Best value: 0.903416:  48%|████▊     | 48/100 [02:45<02:37,  3.03s/it]Best trial: 18. Best value: 0.903416:  49%|████▉     | 49/100 [02:45<02:38,  3.11s/it]Best trial: 18. Best value: 0.903416:  49%|████▉     | 49/100 [02:49<02:38,  3.11s/it]Best trial: 18. Best value: 0.903416:  50%|█████     | 50/100 [02:49<02:40,  3.21s/it]Best trial: 18. Best value: 0.903416:  50%|█████     | 50/100 [02:51<02:40,  3.21s/it]Best trial: 18. Best value: 0.903416:  51%|█████     | 51/100 [02:51<02:33,  3.12s/it]Best trial: 18. Best value: 0.903416:  51%|█████     | 51/100 [02:55<02:33,  3.12s/it]Best trial: 18. Best value: 0.903416:  52%|█████▏    | 52/100 [02:55<02:39,  3.32s/it]Best trial: 18. Best value: 0.903416:  52%|█████▏    | 52/100 [02:59<02:39,  3.32s/it]Best trial: 18. Best value: 0.903416:  53%|█████▎    | 53/100 [02:59<02:36,  3.32s/it]Best trial: 18. Best value: 0.903416:  53%|█████▎    | 53/100 [03:01<02:36,  3.32s/it]Best trial: 18. Best value: 0.903416:  54%|█████▍    | 54/100 [03:01<02:25,  3.15s/it]Best trial: 18. Best value: 0.903416:  54%|█████▍    | 54/100 [03:05<02:25,  3.15s/it]Best trial: 18. Best value: 0.903416:  55%|█████▌    | 55/100 [03:05<02:21,  3.15s/it]Best trial: 18. Best value: 0.903416:  55%|█████▌    | 55/100 [03:08<02:21,  3.15s/it]Best trial: 18. Best value: 0.903416:  56%|█████▌    | 56/100 [03:08<02:21,  3.21s/it]Best trial: 18. Best value: 0.903416:  56%|█████▌    | 56/100 [03:11<02:21,  3.21s/it]Best trial: 18. Best value: 0.903416:  57%|█████▋    | 57/100 [03:11<02:17,  3.21s/it]Best trial: 18. Best value: 0.903416:  57%|█████▋    | 57/100 [03:15<02:17,  3.21s/it]Best trial: 18. Best value: 0.903416:  58%|█████▊    | 58/100 [03:15<02:19,  3.31s/it]Best trial: 18. Best value: 0.903416:  58%|█████▊    | 58/100 [03:18<02:19,  3.31s/it]Best trial: 18. Best value: 0.903416:  59%|█████▉    | 59/100 [03:18<02:11,  3.21s/it]Best trial: 18. Best value: 0.903416:  59%|█████▉    | 59/100 [03:21<02:11,  3.21s/it]Best trial: 18. Best value: 0.903416:  60%|██████    | 60/100 [03:21<02:13,  3.33s/it]Best trial: 18. Best value: 0.903416:  60%|██████    | 60/100 [03:24<02:13,  3.33s/it]Best trial: 18. Best value: 0.903416:  61%|██████    | 61/100 [03:24<02:02,  3.13s/it]Best trial: 18. Best value: 0.903416:  61%|██████    | 61/100 [03:27<02:02,  3.13s/it]Best trial: 18. Best value: 0.903416:  62%|██████▏   | 62/100 [03:27<01:57,  3.10s/it]Best trial: 62. Best value: 0.904998:  62%|██████▏   | 62/100 [03:30<01:57,  3.10s/it]Best trial: 62. Best value: 0.904998:  63%|██████▎   | 63/100 [03:30<01:56,  3.15s/it]Best trial: 62. Best value: 0.904998:  63%|██████▎   | 63/100 [03:34<01:56,  3.15s/it]Best trial: 62. Best value: 0.904998:  64%|██████▍   | 64/100 [03:34<01:56,  3.22s/it]Best trial: 62. Best value: 0.904998:  64%|██████▍   | 64/100 [03:37<01:56,  3.22s/it]Best trial: 62. Best value: 0.904998:  65%|██████▌   | 65/100 [03:37<01:56,  3.32s/it]Best trial: 62. Best value: 0.904998:  65%|██████▌   | 65/100 [03:40<01:56,  3.32s/it]Best trial: 62. Best value: 0.904998:  66%|██████▌   | 66/100 [03:40<01:48,  3.20s/it]Best trial: 62. Best value: 0.904998:  66%|██████▌   | 66/100 [03:43<01:48,  3.20s/it]Best trial: 62. Best value: 0.904998:  67%|██████▋   | 67/100 [03:43<01:43,  3.12s/it]Best trial: 62. Best value: 0.904998:  67%|██████▋   | 67/100 [03:46<01:43,  3.12s/it]Best trial: 62. Best value: 0.904998:  68%|██████▊   | 68/100 [03:46<01:40,  3.14s/it]Best trial: 62. Best value: 0.904998:  68%|██████▊   | 68/100 [03:50<01:40,  3.14s/it]Best trial: 62. Best value: 0.904998:  69%|██████▉   | 69/100 [03:50<01:42,  3.30s/it]Best trial: 62. Best value: 0.904998:  69%|██████▉   | 69/100 [03:54<01:42,  3.30s/it]Best trial: 62. Best value: 0.904998:  70%|███████   | 70/100 [03:54<01:45,  3.51s/it]Best trial: 62. Best value: 0.904998:  70%|███████   | 70/100 [03:58<01:45,  3.51s/it]Best trial: 62. Best value: 0.904998:  71%|███████   | 71/100 [03:58<01:44,  3.60s/it]Best trial: 62. Best value: 0.904998:  71%|███████   | 71/100 [04:01<01:44,  3.60s/it]Best trial: 62. Best value: 0.904998:  72%|███████▏  | 72/100 [04:01<01:40,  3.60s/it]Best trial: 62. Best value: 0.904998:  72%|███████▏  | 72/100 [04:04<01:40,  3.60s/it]Best trial: 62. Best value: 0.904998:  73%|███████▎  | 73/100 [04:04<01:32,  3.43s/it]Best trial: 62. Best value: 0.904998:  73%|███████▎  | 73/100 [04:07<01:32,  3.43s/it]Best trial: 62. Best value: 0.904998:  74%|███████▍  | 74/100 [04:07<01:27,  3.35s/it]Best trial: 62. Best value: 0.904998:  74%|███████▍  | 74/100 [04:12<01:27,  3.35s/it]Best trial: 62. Best value: 0.904998:  75%|███████▌  | 75/100 [04:12<01:32,  3.70s/it]Best trial: 62. Best value: 0.904998:  75%|███████▌  | 75/100 [04:16<01:32,  3.70s/it]Best trial: 62. Best value: 0.904998:  76%|███████▌  | 76/100 [04:16<01:28,  3.68s/it]Best trial: 62. Best value: 0.904998:  76%|███████▌  | 76/100 [04:19<01:28,  3.68s/it]Best trial: 62. Best value: 0.904998:  77%|███████▋  | 77/100 [04:19<01:21,  3.54s/it]Best trial: 62. Best value: 0.904998:  77%|███████▋  | 77/100 [04:22<01:21,  3.54s/it]Best trial: 62. Best value: 0.904998:  78%|███████▊  | 78/100 [04:22<01:16,  3.48s/it]Best trial: 62. Best value: 0.904998:  78%|███████▊  | 78/100 [04:26<01:16,  3.48s/it]Best trial: 62. Best value: 0.904998:  79%|███████▉  | 79/100 [04:26<01:13,  3.50s/it]Best trial: 62. Best value: 0.904998:  79%|███████▉  | 79/100 [04:29<01:13,  3.50s/it]Best trial: 62. Best value: 0.904998:  80%|████████  | 80/100 [04:29<01:11,  3.56s/it]Best trial: 62. Best value: 0.904998:  80%|████████  | 80/100 [04:34<01:11,  3.56s/it]Best trial: 62. Best value: 0.904998:  81%|████████  | 81/100 [04:34<01:11,  3.75s/it]Best trial: 81. Best value: 0.909024:  81%|████████  | 81/100 [04:37<01:11,  3.75s/it]Best trial: 81. Best value: 0.909024:  82%|████████▏ | 82/100 [04:37<01:05,  3.62s/it]Best trial: 81. Best value: 0.909024:  82%|████████▏ | 82/100 [04:40<01:05,  3.62s/it]Best trial: 81. Best value: 0.909024:  83%|████████▎ | 83/100 [04:40<01:00,  3.54s/it]Best trial: 81. Best value: 0.909024:  83%|████████▎ | 83/100 [04:44<01:00,  3.54s/it]Best trial: 81. Best value: 0.909024:  84%|████████▍ | 84/100 [04:44<00:57,  3.61s/it]Best trial: 81. Best value: 0.909024:  84%|████████▍ | 84/100 [04:47<00:57,  3.61s/it]Best trial: 81. Best value: 0.909024:  85%|████████▌ | 85/100 [04:47<00:53,  3.56s/it]Best trial: 81. Best value: 0.909024:  85%|████████▌ | 85/100 [04:52<00:53,  3.56s/it]Best trial: 81. Best value: 0.909024:  86%|████████▌ | 86/100 [04:52<00:52,  3.78s/it]Best trial: 81. Best value: 0.909024:  86%|████████▌ | 86/100 [04:55<00:52,  3.78s/it]Best trial: 81. Best value: 0.909024:  87%|████████▋ | 87/100 [04:55<00:48,  3.75s/it]Best trial: 81. Best value: 0.909024:  87%|████████▋ | 87/100 [04:59<00:48,  3.75s/it]Best trial: 81. Best value: 0.909024:  88%|████████▊ | 88/100 [04:59<00:43,  3.64s/it]Best trial: 81. Best value: 0.909024:  88%|████████▊ | 88/100 [05:02<00:43,  3.64s/it]Best trial: 81. Best value: 0.909024:  89%|████████▉ | 89/100 [05:02<00:39,  3.61s/it]Best trial: 81. Best value: 0.909024:  89%|████████▉ | 89/100 [05:06<00:39,  3.61s/it]Best trial: 81. Best value: 0.909024:  90%|█████████ | 90/100 [05:06<00:35,  3.55s/it]Best trial: 81. Best value: 0.909024:  90%|█████████ | 90/100 [05:10<00:35,  3.55s/it]Best trial: 81. Best value: 0.909024:  91%|█████████ | 91/100 [05:10<00:32,  3.64s/it]Best trial: 81. Best value: 0.909024:  91%|█████████ | 91/100 [05:13<00:32,  3.64s/it]Best trial: 81. Best value: 0.909024:  92%|█████████▏| 92/100 [05:13<00:28,  3.54s/it]Best trial: 81. Best value: 0.909024:  92%|█████████▏| 92/100 [05:16<00:28,  3.54s/it]Best trial: 81. Best value: 0.909024:  93%|█████████▎| 93/100 [05:16<00:24,  3.49s/it]Best trial: 81. Best value: 0.909024:  93%|█████████▎| 93/100 [05:20<00:24,  3.49s/it]Best trial: 81. Best value: 0.909024:  94%|█████████▍| 94/100 [05:20<00:20,  3.49s/it]Best trial: 81. Best value: 0.909024:  94%|█████████▍| 94/100 [05:24<00:20,  3.49s/it]Best trial: 81. Best value: 0.909024:  95%|█████████▌| 95/100 [05:24<00:19,  3.83s/it]Best trial: 81. Best value: 0.909024:  95%|█████████▌| 95/100 [05:28<00:19,  3.83s/it]Best trial: 81. Best value: 0.909024:  96%|█████████▌| 96/100 [05:28<00:14,  3.70s/it]Best trial: 81. Best value: 0.909024:  96%|█████████▌| 96/100 [05:31<00:14,  3.70s/it]Best trial: 81. Best value: 0.909024:  97%|█████████▋| 97/100 [05:31<00:10,  3.63s/it]Best trial: 81. Best value: 0.909024:  97%|█████████▋| 97/100 [05:35<00:10,  3.63s/it]Best trial: 81. Best value: 0.909024:  98%|█████████▊| 98/100 [05:35<00:07,  3.52s/it]Best trial: 81. Best value: 0.909024:  98%|█████████▊| 98/100 [05:38<00:07,  3.52s/it]Best trial: 81. Best value: 0.909024:  99%|█████████▉| 99/100 [05:38<00:03,  3.43s/it]Best trial: 81. Best value: 0.909024:  99%|█████████▉| 99/100 [05:41<00:03,  3.43s/it]Best trial: 81. Best value: 0.909024: 100%|██████████| 100/100 [05:41<00:00,  3.39s/it]Best trial: 81. Best value: 0.909024: 100%|██████████| 100/100 [05:41<00:00,  3.42s/it]
14:03:08 [INFO] models.training.ordinal_trainer: Best params: {'bootstrap_type': 'Bayesian', 'depth': 7, 'iterations': 161, 'learning_rate': 0.0291088905479761, 'border_count': 37, 'l2_leaf_reg': 1.3954684220475388, 'min_data_in_leaf': 27, 'random_strength': 1.8620941552860228, 'colsample_bylevel': 0.5761136184422604, 'bagging_temperature': 0.8006771907166031}
14:03:08 [INFO] models.training.ordinal_trainer: Best AUC: 0.9090
14:03:09 [INFO] models.training.ordinal_trainer:   Threshold -1: trained (pos_rate=71.0%)
14:03:10 [INFO] models.training.ordinal_trainer:   Threshold +0: trained (pos_rate=65.1%)
14:03:11 [INFO] models.training.ordinal_trainer:   Threshold +1: trained (pos_rate=46.6%)
14:03:12 [INFO] models.training.ordinal_trainer:   Threshold +2: trained (pos_rate=38.3%)
14:03:13 [INFO] models.training.ordinal_trainer:   Threshold +3: trained (pos_rate=30.4%)
14:03:14 [INFO] models.training.ordinal_trainer:   Threshold +4: trained (pos_rate=25.6%)
14:03:15 [INFO] models.training.ordinal_trainer:   Threshold +5: trained (pos_rate=20.0%)
14:03:16 [INFO] models.training.ordinal_trainer:   Threshold +6: trained (pos_rate=17.1%)
14:03:17 [INFO] models.training.ordinal_trainer:   Threshold +7: trained (pos_rate=13.9%)
14:03:18 [INFO] models.training.ordinal_trainer:   Threshold +8: trained (pos_rate=11.9%)
14:03:18 [INFO] models.training.ordinal_trainer:   Threshold +9: trained (pos_rate=9.4%)
14:03:19 [INFO] models.training.ordinal_trainer:   Threshold +10: trained (pos_rate=8.1%)
14:03:19 [INFO] models.training.ordinal_trainer: Ordinal training complete: 12 classifiers
14:03:19 [INFO] models.training.ordinal_trainer: Saved ordinal model to models/saved/austin/ordinal_catboost_optuna.pkl
14:03:19 [INFO] __main__: 
Saved model to models/saved/austin/ordinal_catboost_optuna.pkl
14:03:19 [INFO] __main__: Saved best params to models/saved/austin/best_params.json
14:03:19 [INFO] __main__: Saved final metrics to models/saved/austin/final_metrics_austin.json

============================================================
EVALUATION
============================================================

Test Set Metrics:
----------------------------------------
  delta_accuracy: 0.2171
  delta_mae: 2.8026
  off_by_1_rate: 0.2529
  off_by_2plus_rate: 0.5300
  within_1_rate: 0.4700
  within_2_rate: 0.6433

============================================================
FEATURE IMPORTANCE
============================================================

Top 30 Features:
                         feature  importance
0               obs_fcst_max_gap   17.849919
1              num_samples_sofar    8.004058
2                above_fcst_flag    7.779546
3           fcst_peak_hour_float    4.873369
4           fcst_cloudcover_mean    2.950308
5          fcst_prev_hour_of_max    2.718471
6               delta_vcmax_lag1    2.674606
7                 vc_q75_f_sofar    2.597203
8              err_max_pos_sofar    2.242317
9            pred_ceil_max_sofar    2.208012
10                vc_max_f_sofar    2.032812
11                        t_base    1.780704
12           fcst_cloudcover_max    1.714388
13                      week_sin    1.538304
14                         month    1.467501
15          hours_until_fcst_max    1.421504
16            fcst_humidity_mean    1.350860
17           fcst_dewpoint_range    1.226611
18      fcst_peak_band_width_min    1.224772
19           fcst_cloudcover_min    1.190347
20       fcst_drift_mean_delta_f    1.188850
21    fcst_humidity_morning_mean    1.136635
22                err_mean_sofar    1.017488
23         fcst_cloudcover_range    0.965006
24                 settle_f_lag7    0.948740
25                       doy_cos    0.932793
26  fcst_humidity_afternoon_mean    0.905260
27              fcst_drift_std_f    0.847752
28                 vc_max_f_lag7    0.846300
29           fcst_humidity_range    0.845026

============================================================
SUMMARY
============================================================
City: austin
Model: models/saved/austin/ordinal_catboost_optuna.pkl
Params: models/saved/austin/best_params.json
Metrics: models/saved/austin/final_metrics_austin.json
Training samples: 129,928
Test samples: 32,376
Optuna trials: 100
Best params: {'bootstrap_type': 'Bayesian', 'depth': 7, 'iterations': 161, 'learning_rate': 0.0291088905479761, 'border_count': 37, 'l2_leaf_reg': 1.3954684220475388, 'min_data_in_leaf': 27, 'random_strength': 1.8620941552860228, 'colsample_bylevel': 0.5761136184422604, 'bagging_temperature': 0.8006771907166031}

Key Metrics:
  Accuracy: 21.7%
  MAE: 2.80
  Within 1: 47.0%
  Within 2: 64.3%

============================================================
DONE
============================================================
