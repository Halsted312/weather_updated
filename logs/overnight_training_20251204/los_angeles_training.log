02:10:32 [INFO] __main__: ============================================================
02:10:32 [INFO] __main__: LOS_ANGELES Optuna Training (200 trials)
02:10:32 [INFO] __main__: Optimization objective: within2
02:10:32 [INFO] __main__: ============================================================
02:10:32 [INFO] __main__: Loading from training cache: data/training_cache/los_angeles/full.parquet
02:10:32 [INFO] __main__: Loaded 486,936 rows, 237 columns
02:10:32 [INFO] __main__: Data range after filtering: 2023-01-01 to 2025-12-03
02:10:33 [INFO] __main__: Total days: 1068
02:10:33 [INFO] __main__: Training: 2023-01-01 to 2025-05-04 (855 days)
02:10:33 [INFO] __main__: Testing:  2025-05-05 to 2025-12-03 (213 days)
02:10:33 [INFO] __main__: 
Training samples: 389,808
02:10:33 [INFO] __main__: Training days: 855
02:10:33 [INFO] __main__: Test samples: 97,128
02:10:33 [INFO] __main__: Test days: 213
02:10:33 [INFO] __main__: 
Station-city features: ['station_city_temp_gap', 'station_city_max_gap_sofar', 'station_city_mean_gap_sofar', 'station_city_gap_std', 'station_city_gap_trend', 'station_city_gap_x_fcst_gap']
02:10:33 [INFO] __main__:   station_city_temp_gap: 389,736/389,808 non-null (100.0%)
02:10:33 [INFO] __main__:   station_city_max_gap_sofar: 389,736/389,808 non-null (100.0%)
02:10:33 [INFO] __main__:   station_city_mean_gap_sofar: 389,736/389,808 non-null (100.0%)
02:10:33 [INFO] __main__:   station_city_gap_std: 389,736/389,808 non-null (100.0%)
02:10:33 [INFO] __main__:   station_city_gap_trend: 389,730/389,808 non-null (100.0%)
02:10:33 [INFO] __main__:   station_city_gap_x_fcst_gap: 389,736/389,808 non-null (100.0%)
02:10:33 [INFO] __main__: 
Multi-horizon features: ['fcst_multi_mean', 'fcst_multi_median', 'fcst_multi_ema', 'fcst_multi_std', 'fcst_multi_range', 'fcst_multi_t1_t2_diff', 'fcst_multi_drift', 'fcst_multi_cv', 'fcst_multi_range_pct']
02:10:33 [INFO] __main__:   fcst_multi_mean: 389,808/389,808 non-null (100.0%)
02:10:33 [INFO] __main__:   fcst_multi_median: 389,808/389,808 non-null (100.0%)
02:10:33 [INFO] __main__:   fcst_multi_ema: 389,808/389,808 non-null (100.0%)
02:10:33 [INFO] __main__:   fcst_multi_std: 389,808/389,808 non-null (100.0%)
02:10:33 [INFO] __main__:   fcst_multi_range: 389,808/389,808 non-null (100.0%)
02:10:33 [INFO] __main__:   fcst_multi_t1_t2_diff: 389,808/389,808 non-null (100.0%)
02:10:33 [INFO] __main__:   fcst_multi_drift: 389,808/389,808 non-null (100.0%)
02:10:33 [INFO] __main__:   fcst_multi_cv: 389,808/389,808 non-null (100.0%)
02:10:33 [INFO] __main__:   fcst_multi_range_pct: 389,808/389,808 non-null (100.0%)
02:10:34 [INFO] models.training.ordinal_trainer: Training ordinal model (catboost) on 389808 samples
02:10:35 [INFO] models.training.ordinal_trainer: City delta range: [-12, 12]
02:10:35 [INFO] models.training.ordinal_trainer: Training 24 threshold classifiers: [-11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12]
02:10:35 [INFO] models.training.ordinal_trainer: Starting Optuna tuning with 200 trials (objective=within2)

============================================================
OPTUNA TRAINING (200 trials, objective=within2)
============================================================
  0%|          | 0/200 [00:00<?, ?it/s]Best trial: 0. Best value: 0.629934:   0%|          | 0/200 [00:19<?, ?it/s]Best trial: 0. Best value: 0.629934:   0%|          | 1/200 [00:19<1:03:10, 19.05s/it]Best trial: 0. Best value: 0.629934:   0%|          | 1/200 [00:54<1:03:10, 19.05s/it]Best trial: 0. Best value: 0.629934:   1%|          | 2/200 [00:54<1:33:44, 28.41s/it]Best trial: 0. Best value: 0.629934:   1%|          | 2/200 [01:14<1:33:44, 28.41s/it]Best trial: 0. Best value: 0.629934:   2%|▏         | 3/200 [01:14<1:21:14, 24.74s/it]Best trial: 3. Best value: 0.645237:   2%|▏         | 3/200 [01:40<1:21:14, 24.74s/it]Best trial: 3. Best value: 0.645237:   2%|▏         | 4/200 [01:40<1:22:09, 25.15s/it]Best trial: 3. Best value: 0.645237:   2%|▏         | 4/200 [02:06<1:22:09, 25.15s/it]Best trial: 3. Best value: 0.645237:   2%|▎         | 5/200 [02:06<1:23:38, 25.74s/it]Best trial: 3. Best value: 0.645237:   2%|▎         | 5/200 [02:32<1:23:38, 25.74s/it]Best trial: 3. Best value: 0.645237:   3%|▎         | 6/200 [02:32<1:23:23, 25.79s/it]Best trial: 3. Best value: 0.645237:   3%|▎         | 6/200 [02:51<1:23:23, 25.79s/it]Best trial: 3. Best value: 0.645237:   4%|▎         | 7/200 [02:51<1:15:27, 23.46s/it]Best trial: 3. Best value: 0.645237:   4%|▎         | 7/200 [03:20<1:15:27, 23.46s/it]Best trial: 3. Best value: 0.645237:   4%|▍         | 8/200 [03:20<1:21:02, 25.33s/it]Best trial: 3. Best value: 0.645237:   4%|▍         | 8/200 [03:59<1:21:02, 25.33s/it]Best trial: 3. Best value: 0.645237:   4%|▍         | 9/200 [03:59<1:33:34, 29.39s/it]Best trial: 3. Best value: 0.645237:   4%|▍         | 9/200 [04:19<1:33:34, 29.39s/it]Best trial: 3. Best value: 0.645237:   5%|▌         | 10/200 [04:19<1:24:32, 26.70s/it]Best trial: 10. Best value: 0.649568:   5%|▌         | 10/200 [04:41<1:24:32, 26.70s/it]Best trial: 10. Best value: 0.649568:   6%|▌         | 11/200 [04:41<1:18:49, 25.02s/it]Best trial: 10. Best value: 0.649568:   6%|▌         | 11/200 [05:08<1:18:49, 25.02s/it]Best trial: 10. Best value: 0.649568:   6%|▌         | 12/200 [05:08<1:20:21, 25.65s/it]Best trial: 10. Best value: 0.649568:   6%|▌         | 12/200 [05:28<1:20:21, 25.65s/it]Best trial: 10. Best value: 0.649568:   6%|▋         | 13/200 [05:28<1:14:56, 24.05s/it]Best trial: 10. Best value: 0.649568:   6%|▋         | 13/200 [05:47<1:14:56, 24.05s/it]Best trial: 10. Best value: 0.649568:   7%|▋         | 14/200 [05:47<1:10:12, 22.65s/it]Best trial: 10. Best value: 0.649568:   7%|▋         | 14/200 [06:05<1:10:12, 22.65s/it]Best trial: 10. Best value: 0.649568:   8%|▊         | 15/200 [06:05<1:05:32, 21.26s/it]Best trial: 15. Best value: 0.654465:   8%|▊         | 15/200 [06:26<1:05:32, 21.26s/it]Best trial: 15. Best value: 0.654465:   8%|▊         | 16/200 [06:26<1:04:07, 20.91s/it]Best trial: 15. Best value: 0.654465:   8%|▊         | 16/200 [06:46<1:04:07, 20.91s/it]Best trial: 15. Best value: 0.654465:   8%|▊         | 17/200 [06:46<1:03:23, 20.79s/it]Best trial: 15. Best value: 0.654465:   8%|▊         | 17/200 [07:03<1:03:23, 20.79s/it]Best trial: 15. Best value: 0.654465:   9%|▉         | 18/200 [07:03<59:27, 19.60s/it]  Best trial: 15. Best value: 0.654465:   9%|▉         | 18/200 [07:19<59:27, 19.60s/it]Best trial: 15. Best value: 0.654465:  10%|▉         | 19/200 [07:19<55:55, 18.54s/it]Best trial: 15. Best value: 0.654465:  10%|▉         | 19/200 [08:14<55:55, 18.54s/it]Best trial: 15. Best value: 0.654465:  10%|█         | 20/200 [08:14<1:28:07, 29.38s/it]Best trial: 15. Best value: 0.654465:  10%|█         | 20/200 [08:29<1:28:07, 29.38s/it]Best trial: 15. Best value: 0.654465:  10%|█         | 21/200 [08:29<1:15:22, 25.27s/it]Best trial: 15. Best value: 0.654465:  10%|█         | 21/200 [08:44<1:15:22, 25.27s/it]Best trial: 15. Best value: 0.654465:  11%|█         | 22/200 [08:44<1:06:01, 22.25s/it]Best trial: 15. Best value: 0.654465:  11%|█         | 22/200 [09:00<1:06:01, 22.25s/it]Best trial: 15. Best value: 0.654465:  12%|█▏        | 23/200 [09:00<59:30, 20.17s/it]  Best trial: 23. Best value: 0.669579:  12%|█▏        | 23/200 [09:15<59:30, 20.17s/it]Best trial: 23. Best value: 0.669579:  12%|█▏        | 24/200 [09:15<55:09, 18.80s/it]Best trial: 24. Best value: 0.669816:  12%|█▏        | 24/200 [09:33<55:09, 18.80s/it]Best trial: 24. Best value: 0.669816:  12%|█▎        | 25/200 [09:33<53:49, 18.46s/it]Best trial: 24. Best value: 0.669816:  12%|█▎        | 25/200 [09:53<53:49, 18.46s/it]Best trial: 24. Best value: 0.669816:  13%|█▎        | 26/200 [09:53<54:44, 18.87s/it]Best trial: 24. Best value: 0.669816:  13%|█▎        | 26/200 [10:11<54:44, 18.87s/it]Best trial: 24. Best value: 0.669816:  14%|█▎        | 27/200 [10:11<53:56, 18.71s/it]Best trial: 24. Best value: 0.669816:  14%|█▎        | 27/200 [10:26<53:56, 18.71s/it]Best trial: 24. Best value: 0.669816:  14%|█▍        | 28/200 [10:26<49:49, 17.38s/it]Best trial: 24. Best value: 0.669816:  14%|█▍        | 28/200 [10:45<49:49, 17.38s/it]Best trial: 24. Best value: 0.669816:  14%|█▍        | 29/200 [10:45<50:57, 17.88s/it]Best trial: 24. Best value: 0.669816:  14%|█▍        | 29/200 [11:02<50:57, 17.88s/it]Best trial: 24. Best value: 0.669816:  15%|█▌        | 30/200 [11:02<49:56, 17.62s/it]Best trial: 24. Best value: 0.669816:  15%|█▌        | 30/200 [11:21<49:56, 17.62s/it]Best trial: 24. Best value: 0.669816:  16%|█▌        | 31/200 [11:21<51:03, 18.13s/it]Best trial: 24. Best value: 0.669816:  16%|█▌        | 31/200 [11:37<51:03, 18.13s/it]Best trial: 24. Best value: 0.669816:  16%|█▌        | 32/200 [11:37<48:54, 17.47s/it]Best trial: 24. Best value: 0.669816:  16%|█▌        | 32/200 [11:54<48:54, 17.47s/it]Best trial: 24. Best value: 0.669816:  16%|█▋        | 33/200 [11:54<48:32, 17.44s/it]Best trial: 24. Best value: 0.669816:  16%|█▋        | 33/200 [12:10<48:32, 17.44s/it]Best trial: 24. Best value: 0.669816:  17%|█▋        | 34/200 [12:10<47:12, 17.06s/it]Best trial: 24. Best value: 0.669816:  17%|█▋        | 34/200 [12:35<47:12, 17.06s/it]Best trial: 24. Best value: 0.669816:  18%|█▊        | 35/200 [12:35<53:10, 19.33s/it]Best trial: 24. Best value: 0.669816:  18%|█▊        | 35/200 [12:57<53:10, 19.33s/it]Best trial: 24. Best value: 0.669816:  18%|█▊        | 36/200 [12:57<55:19, 20.24s/it]Best trial: 24. Best value: 0.669816:  18%|█▊        | 36/200 [13:30<55:19, 20.24s/it]Best trial: 24. Best value: 0.669816:  18%|█▊        | 37/200 [13:30<1:05:19, 24.04s/it]Best trial: 24. Best value: 0.669816:  18%|█▊        | 37/200 [13:57<1:05:19, 24.04s/it]Best trial: 24. Best value: 0.669816:  19%|█▉        | 38/200 [13:57<1:06:43, 24.72s/it]Best trial: 24. Best value: 0.669816:  19%|█▉        | 38/200 [14:11<1:06:43, 24.72s/it]Best trial: 24. Best value: 0.669816:  20%|█▉        | 39/200 [14:11<57:52, 21.57s/it]  Best trial: 24. Best value: 0.669816:  20%|█▉        | 39/200 [14:38<57:52, 21.57s/it]Best trial: 24. Best value: 0.669816:  20%|██        | 40/200 [14:38<1:02:13, 23.33s/it]Best trial: 24. Best value: 0.669816:  20%|██        | 40/200 [15:12<1:02:13, 23.33s/it]Best trial: 24. Best value: 0.669816:  20%|██        | 41/200 [15:12<1:10:07, 26.46s/it]Best trial: 24. Best value: 0.669816:  20%|██        | 41/200 [15:30<1:10:07, 26.46s/it]Best trial: 24. Best value: 0.669816:  21%|██        | 42/200 [15:30<1:03:17, 24.03s/it]Best trial: 24. Best value: 0.669816:  21%|██        | 42/200 [15:47<1:03:17, 24.03s/it]Best trial: 24. Best value: 0.669816:  22%|██▏       | 43/200 [15:47<57:21, 21.92s/it]  Best trial: 24. Best value: 0.669816:  22%|██▏       | 43/200 [16:05<57:21, 21.92s/it]Best trial: 24. Best value: 0.669816:  22%|██▏       | 44/200 [16:05<53:34, 20.61s/it]Best trial: 24. Best value: 0.669816:  22%|██▏       | 44/200 [16:37<53:34, 20.61s/it]Best trial: 24. Best value: 0.669816:  22%|██▎       | 45/200 [16:37<1:02:29, 24.19s/it]Best trial: 24. Best value: 0.669816:  22%|██▎       | 45/200 [16:53<1:02:29, 24.19s/it]Best trial: 24. Best value: 0.669816:  23%|██▎       | 46/200 [16:53<55:05, 21.46s/it]  Best trial: 24. Best value: 0.669816:  23%|██▎       | 46/200 [17:08<55:05, 21.46s/it]Best trial: 24. Best value: 0.669816:  24%|██▎       | 47/200 [17:08<49:51, 19.56s/it]Best trial: 24. Best value: 0.669816:  24%|██▎       | 47/200 [17:28<49:51, 19.56s/it]Best trial: 24. Best value: 0.669816:  24%|██▍       | 48/200 [17:28<50:06, 19.78s/it]Best trial: 24. Best value: 0.669816:  24%|██▍       | 48/200 [17:48<50:06, 19.78s/it]Best trial: 24. Best value: 0.669816:  24%|██▍       | 49/200 [17:48<50:01, 19.88s/it]Best trial: 24. Best value: 0.669816:  24%|██▍       | 49/200 [18:03<50:01, 19.88s/it]Best trial: 24. Best value: 0.669816:  25%|██▌       | 50/200 [18:03<45:50, 18.34s/it]Best trial: 24. Best value: 0.669816:  25%|██▌       | 50/200 [18:23<45:50, 18.34s/it]Best trial: 24. Best value: 0.669816:  26%|██▌       | 51/200 [18:23<46:51, 18.87s/it]Best trial: 24. Best value: 0.669816:  26%|██▌       | 51/200 [18:40<46:51, 18.87s/it]Best trial: 24. Best value: 0.669816:  26%|██▌       | 52/200 [18:40<45:07, 18.30s/it]Best trial: 24. Best value: 0.669816:  26%|██▌       | 52/200 [18:56<45:07, 18.30s/it]Best trial: 24. Best value: 0.669816:  26%|██▋       | 53/200 [18:56<43:19, 17.69s/it]Best trial: 24. Best value: 0.669816:  26%|██▋       | 53/200 [19:13<43:19, 17.69s/it]Best trial: 24. Best value: 0.669816:  27%|██▋       | 54/200 [19:13<42:04, 17.29s/it]Best trial: 24. Best value: 0.669816:  27%|██▋       | 54/200 [19:30<42:04, 17.29s/it]Best trial: 24. Best value: 0.669816:  28%|██▊       | 55/200 [19:30<42:15, 17.48s/it]Best trial: 24. Best value: 0.669816:  28%|██▊       | 55/200 [19:49<42:15, 17.48s/it]Best trial: 24. Best value: 0.669816:  28%|██▊       | 56/200 [19:49<42:42, 17.80s/it]Best trial: 24. Best value: 0.669816:  28%|██▊       | 56/200 [20:39<42:42, 17.80s/it]Best trial: 24. Best value: 0.669816:  28%|██▊       | 57/200 [20:39<1:05:11, 27.36s/it]Best trial: 24. Best value: 0.669816:  28%|██▊       | 57/200 [21:02<1:05:11, 27.36s/it]Best trial: 24. Best value: 0.669816:  29%|██▉       | 58/200 [21:02<1:01:49, 26.13s/it]Best trial: 24. Best value: 0.669816:  29%|██▉       | 58/200 [21:17<1:01:49, 26.13s/it]Best trial: 24. Best value: 0.669816:  30%|██▉       | 59/200 [21:17<53:37, 22.82s/it]  Best trial: 24. Best value: 0.669816:  30%|██▉       | 59/200 [21:32<53:37, 22.82s/it]Best trial: 24. Best value: 0.669816:  30%|███       | 60/200 [21:32<48:02, 20.59s/it]Best trial: 24. Best value: 0.669816:  30%|███       | 60/200 [21:49<48:02, 20.59s/it]Best trial: 24. Best value: 0.669816:  30%|███       | 61/200 [21:49<44:53, 19.38s/it]Best trial: 24. Best value: 0.669816:  30%|███       | 61/200 [22:04<44:53, 19.38s/it]Best trial: 24. Best value: 0.669816:  31%|███       | 62/200 [22:04<41:53, 18.21s/it]Best trial: 24. Best value: 0.669816:  31%|███       | 62/200 [22:22<41:53, 18.21s/it]Best trial: 24. Best value: 0.669816:  32%|███▏      | 63/200 [22:22<41:14, 18.07s/it]Best trial: 63. Best value: 0.674974:  32%|███▏      | 63/200 [22:41<41:14, 18.07s/it]Best trial: 63. Best value: 0.674974:  32%|███▏      | 64/200 [22:41<41:30, 18.31s/it]Best trial: 63. Best value: 0.674974:  32%|███▏      | 64/200 [22:56<41:30, 18.31s/it]Best trial: 63. Best value: 0.674974:  32%|███▎      | 65/200 [22:56<39:14, 17.44s/it]Best trial: 63. Best value: 0.674974:  32%|███▎      | 65/200 [23:10<39:14, 17.44s/it]Best trial: 63. Best value: 0.674974:  33%|███▎      | 66/200 [23:10<36:35, 16.38s/it]Best trial: 63. Best value: 0.674974:  33%|███▎      | 66/200 [23:30<36:35, 16.38s/it]Best trial: 63. Best value: 0.674974:  34%|███▎      | 67/200 [23:30<38:28, 17.36s/it]Best trial: 63. Best value: 0.674974:  34%|███▎      | 67/200 [23:51<38:28, 17.36s/it]Best trial: 63. Best value: 0.674974:  34%|███▍      | 68/200 [23:51<40:47, 18.55s/it]Best trial: 63. Best value: 0.674974:  34%|███▍      | 68/200 [24:07<40:47, 18.55s/it]Best trial: 63. Best value: 0.674974:  34%|███▍      | 69/200 [24:07<38:26, 17.61s/it]Best trial: 63. Best value: 0.674974:  34%|███▍      | 69/200 [24:38<38:26, 17.61s/it]Best trial: 63. Best value: 0.674974:  35%|███▌      | 70/200 [24:38<47:15, 21.81s/it]Best trial: 63. Best value: 0.674974:  35%|███▌      | 70/200 [24:55<47:15, 21.81s/it]Best trial: 63. Best value: 0.674974:  36%|███▌      | 71/200 [24:55<43:30, 20.24s/it]Best trial: 63. Best value: 0.674974:  36%|███▌      | 71/200 [25:11<43:30, 20.24s/it]Best trial: 63. Best value: 0.674974:  36%|███▌      | 72/200 [25:11<40:39, 19.06s/it]Best trial: 63. Best value: 0.674974:  36%|███▌      | 72/200 [25:27<40:39, 19.06s/it]Best trial: 63. Best value: 0.674974:  36%|███▋      | 73/200 [25:27<38:13, 18.06s/it]Best trial: 63. Best value: 0.674974:  36%|███▋      | 73/200 [25:42<38:13, 18.06s/it]Best trial: 63. Best value: 0.674974:  37%|███▋      | 74/200 [25:42<35:50, 17.06s/it]Best trial: 63. Best value: 0.674974:  37%|███▋      | 74/200 [26:00<35:50, 17.06s/it]Best trial: 63. Best value: 0.674974:  38%|███▊      | 75/200 [26:00<36:36, 17.58s/it]Best trial: 63. Best value: 0.674974:  38%|███▊      | 75/200 [26:17<36:36, 17.58s/it]Best trial: 63. Best value: 0.674974:  38%|███▊      | 76/200 [26:17<35:36, 17.23s/it]Best trial: 63. Best value: 0.674974:  38%|███▊      | 76/200 [26:34<35:36, 17.23s/it]Best trial: 63. Best value: 0.674974:  38%|███▊      | 77/200 [26:34<35:13, 17.18s/it]Best trial: 63. Best value: 0.674974:  38%|███▊      | 77/200 [26:50<35:13, 17.18s/it]Best trial: 63. Best value: 0.674974:  39%|███▉      | 78/200 [26:50<34:11, 16.82s/it]Best trial: 63. Best value: 0.674974:  39%|███▉      | 78/200 [27:07<34:11, 16.82s/it]Best trial: 63. Best value: 0.674974:  40%|███▉      | 79/200 [27:07<34:00, 16.87s/it]Best trial: 63. Best value: 0.674974:  40%|███▉      | 79/200 [27:24<34:00, 16.87s/it]Best trial: 63. Best value: 0.674974:  40%|████      | 80/200 [27:24<33:59, 17.00s/it]Best trial: 63. Best value: 0.674974:  40%|████      | 80/200 [27:42<33:59, 17.00s/it]Best trial: 63. Best value: 0.674974:  40%|████      | 81/200 [27:42<33:59, 17.14s/it]Best trial: 63. Best value: 0.674974:  40%|████      | 81/200 [27:57<33:59, 17.14s/it]Best trial: 63. Best value: 0.674974:  41%|████      | 82/200 [27:57<32:34, 16.56s/it]Best trial: 63. Best value: 0.674974:  41%|████      | 82/200 [28:16<32:34, 16.56s/it]Best trial: 63. Best value: 0.674974:  42%|████▏     | 83/200 [28:16<33:48, 17.34s/it]Best trial: 63. Best value: 0.674974:  42%|████▏     | 83/200 [28:41<33:48, 17.34s/it]Best trial: 63. Best value: 0.674974:  42%|████▏     | 84/200 [28:41<38:09, 19.73s/it]Best trial: 63. Best value: 0.674974:  42%|████▏     | 84/200 [28:57<38:09, 19.73s/it]Best trial: 63. Best value: 0.674974:  42%|████▎     | 85/200 [28:57<35:31, 18.54s/it]Best trial: 63. Best value: 0.674974:  42%|████▎     | 85/200 [29:14<35:31, 18.54s/it]Best trial: 63. Best value: 0.674974:  43%|████▎     | 86/200 [29:14<34:14, 18.02s/it]Best trial: 63. Best value: 0.674974:  43%|████▎     | 86/200 [29:33<34:14, 18.02s/it]Best trial: 63. Best value: 0.674974:  44%|████▎     | 87/200 [29:33<34:27, 18.30s/it]Best trial: 63. Best value: 0.674974:  44%|████▎     | 87/200 [29:50<34:27, 18.30s/it]Best trial: 63. Best value: 0.674974:  44%|████▍     | 88/200 [29:50<33:36, 18.00s/it]Best trial: 63. Best value: 0.674974:  44%|████▍     | 88/200 [30:13<33:36, 18.00s/it]Best trial: 63. Best value: 0.674974:  44%|████▍     | 89/200 [30:13<35:45, 19.33s/it]Best trial: 63. Best value: 0.674974:  44%|████▍     | 89/200 [30:29<35:45, 19.33s/it]Best trial: 63. Best value: 0.674974:  45%|████▌     | 90/200 [30:29<33:59, 18.54s/it]Best trial: 63. Best value: 0.674974:  45%|████▌     | 90/200 [30:47<33:59, 18.54s/it]Best trial: 63. Best value: 0.674974:  46%|████▌     | 91/200 [30:47<33:26, 18.40s/it]Best trial: 63. Best value: 0.674974:  46%|████▌     | 91/200 [31:06<33:26, 18.40s/it]Best trial: 63. Best value: 0.674974:  46%|████▌     | 92/200 [31:06<33:03, 18.36s/it]Best trial: 63. Best value: 0.674974:  46%|████▌     | 92/200 [31:22<33:03, 18.36s/it]Best trial: 63. Best value: 0.674974:  46%|████▋     | 93/200 [31:22<31:50, 17.86s/it]Best trial: 63. Best value: 0.674974:  46%|████▋     | 93/200 [31:37<31:50, 17.86s/it]Best trial: 63. Best value: 0.674974:  47%|████▋     | 94/200 [31:37<29:58, 16.97s/it]Best trial: 63. Best value: 0.674974:  47%|████▋     | 94/200 [31:55<29:58, 16.97s/it]Best trial: 63. Best value: 0.674974:  48%|████▊     | 95/200 [31:55<30:10, 17.25s/it]Best trial: 63. Best value: 0.674974:  48%|████▊     | 95/200 [32:13<30:10, 17.25s/it]Best trial: 63. Best value: 0.674974:  48%|████▊     | 96/200 [32:13<29:58, 17.30s/it]Best trial: 63. Best value: 0.674974:  48%|████▊     | 96/200 [32:29<29:58, 17.30s/it]Best trial: 63. Best value: 0.674974:  48%|████▊     | 97/200 [32:29<29:21, 17.10s/it]Best trial: 63. Best value: 0.674974:  48%|████▊     | 97/200 [32:47<29:21, 17.10s/it]Best trial: 63. Best value: 0.674974:  49%|████▉     | 98/200 [32:47<29:27, 17.33s/it]Best trial: 63. Best value: 0.674974:  49%|████▉     | 98/200 [33:04<29:27, 17.33s/it]Best trial: 63. Best value: 0.674974:  50%|████▉     | 99/200 [33:04<28:56, 17.19s/it]Best trial: 63. Best value: 0.674974:  50%|████▉     | 99/200 [33:20<28:56, 17.19s/it]Best trial: 63. Best value: 0.674974:  50%|█████     | 100/200 [33:20<27:51, 16.72s/it]Best trial: 63. Best value: 0.674974:  50%|█████     | 100/200 [33:46<27:51, 16.72s/it]Best trial: 63. Best value: 0.674974:  50%|█████     | 101/200 [33:46<32:22, 19.62s/it]Best trial: 63. Best value: 0.674974:  50%|█████     | 101/200 [34:02<32:22, 19.62s/it]Best trial: 63. Best value: 0.674974:  51%|█████     | 102/200 [34:02<30:11, 18.48s/it]Best trial: 63. Best value: 0.674974:  51%|█████     | 102/200 [34:19<30:11, 18.48s/it]Best trial: 63. Best value: 0.674974:  52%|█████▏    | 103/200 [34:19<29:05, 18.00s/it]Best trial: 63. Best value: 0.674974:  52%|█████▏    | 103/200 [34:35<29:05, 18.00s/it]Best trial: 63. Best value: 0.674974:  52%|█████▏    | 104/200 [34:35<27:59, 17.49s/it]Best trial: 63. Best value: 0.674974:  52%|█████▏    | 104/200 [34:52<27:59, 17.49s/it]Best trial: 63. Best value: 0.674974:  52%|█████▎    | 105/200 [34:52<27:37, 17.45s/it]Best trial: 63. Best value: 0.674974:  52%|█████▎    | 105/200 [35:23<27:37, 17.45s/it]Best trial: 63. Best value: 0.674974:  53%|█████▎    | 106/200 [35:23<33:32, 21.41s/it]Best trial: 63. Best value: 0.674974:  53%|█████▎    | 106/200 [35:41<33:32, 21.41s/it]Best trial: 63. Best value: 0.674974:  54%|█████▎    | 107/200 [35:41<31:50, 20.55s/it]Best trial: 63. Best value: 0.674974:  54%|█████▎    | 107/200 [35:59<31:50, 20.55s/it]Best trial: 63. Best value: 0.674974:  54%|█████▍    | 108/200 [35:59<30:11, 19.69s/it]Best trial: 63. Best value: 0.674974:  54%|█████▍    | 108/200 [36:20<30:11, 19.69s/it]Best trial: 63. Best value: 0.674974:  55%|█████▍    | 109/200 [36:20<30:25, 20.06s/it]Best trial: 63. Best value: 0.674974:  55%|█████▍    | 109/200 [36:35<30:25, 20.06s/it]Best trial: 63. Best value: 0.674974:  55%|█████▌    | 110/200 [36:35<27:44, 18.50s/it]Best trial: 63. Best value: 0.674974:  55%|█████▌    | 110/200 [36:49<27:44, 18.50s/it]Best trial: 63. Best value: 0.674974:  56%|█████▌    | 111/200 [36:49<25:29, 17.18s/it]Best trial: 63. Best value: 0.674974:  56%|█████▌    | 111/200 [37:07<25:29, 17.18s/it]Best trial: 63. Best value: 0.674974:  56%|█████▌    | 112/200 [37:07<25:19, 17.26s/it]Best trial: 63. Best value: 0.674974:  56%|█████▌    | 112/200 [37:24<25:19, 17.26s/it]Best trial: 63. Best value: 0.674974:  56%|█████▋    | 113/200 [37:24<25:00, 17.25s/it]Best trial: 63. Best value: 0.674974:  56%|█████▋    | 113/200 [37:44<25:00, 17.25s/it]Best trial: 63. Best value: 0.674974:  57%|█████▋    | 114/200 [37:44<25:50, 18.02s/it]Best trial: 63. Best value: 0.674974:  57%|█████▋    | 114/200 [38:37<25:50, 18.02s/it]Best trial: 63. Best value: 0.674974:  57%|█████▊    | 115/200 [38:37<40:34, 28.64s/it]Best trial: 63. Best value: 0.674974:  57%|█████▊    | 115/200 [38:53<40:34, 28.64s/it]Best trial: 63. Best value: 0.674974:  58%|█████▊    | 116/200 [38:53<34:58, 24.98s/it]Best trial: 63. Best value: 0.674974:  58%|█████▊    | 116/200 [39:09<34:58, 24.98s/it]Best trial: 63. Best value: 0.674974:  58%|█████▊    | 117/200 [39:09<30:43, 22.21s/it]Best trial: 63. Best value: 0.674974:  58%|█████▊    | 117/200 [39:26<30:43, 22.21s/it]Best trial: 63. Best value: 0.674974:  59%|█████▉    | 118/200 [39:26<28:11, 20.63s/it]Best trial: 63. Best value: 0.674974:  59%|█████▉    | 118/200 [39:41<28:11, 20.63s/it]Best trial: 63. Best value: 0.674974:  60%|█████▉    | 119/200 [39:41<25:29, 18.89s/it]Best trial: 63. Best value: 0.674974:  60%|█████▉    | 119/200 [39:57<25:29, 18.89s/it]Best trial: 63. Best value: 0.674974:  60%|██████    | 120/200 [39:57<24:07, 18.09s/it]Best trial: 63. Best value: 0.674974:  60%|██████    | 120/200 [40:13<24:07, 18.09s/it]Best trial: 63. Best value: 0.674974:  60%|██████    | 121/200 [40:13<23:00, 17.47s/it]Best trial: 63. Best value: 0.674974:  60%|██████    | 121/200 [40:28<23:00, 17.47s/it]Best trial: 63. Best value: 0.674974:  61%|██████    | 122/200 [40:28<21:46, 16.75s/it]Best trial: 63. Best value: 0.674974:  61%|██████    | 122/200 [40:45<21:46, 16.75s/it]Best trial: 63. Best value: 0.674974:  62%|██████▏   | 123/200 [40:45<21:23, 16.67s/it]Best trial: 63. Best value: 0.674974:  62%|██████▏   | 123/200 [41:01<21:23, 16.67s/it]Best trial: 63. Best value: 0.674974:  62%|██████▏   | 124/200 [41:01<21:03, 16.63s/it]Best trial: 63. Best value: 0.674974:  62%|██████▏   | 124/200 [41:16<21:03, 16.63s/it]Best trial: 63. Best value: 0.674974:  62%|██████▎   | 125/200 [41:16<19:55, 15.94s/it]Best trial: 63. Best value: 0.674974:  62%|██████▎   | 125/200 [41:32<19:55, 15.94s/it]Best trial: 63. Best value: 0.674974:  63%|██████▎   | 126/200 [41:32<19:46, 16.03s/it]Best trial: 63. Best value: 0.674974:  63%|██████▎   | 126/200 [41:48<19:46, 16.03s/it]Best trial: 63. Best value: 0.674974:  64%|██████▎   | 127/200 [41:48<19:39, 16.16s/it]Best trial: 63. Best value: 0.674974:  64%|██████▎   | 127/200 [42:18<19:39, 16.16s/it]Best trial: 63. Best value: 0.674974:  64%|██████▍   | 128/200 [42:18<24:19, 20.27s/it]Best trial: 63. Best value: 0.674974:  64%|██████▍   | 128/200 [42:40<24:19, 20.27s/it]Best trial: 63. Best value: 0.674974:  64%|██████▍   | 129/200 [42:40<24:42, 20.88s/it]Best trial: 63. Best value: 0.674974:  64%|██████▍   | 129/200 [42:58<24:42, 20.88s/it]Best trial: 63. Best value: 0.674974:  65%|██████▌   | 130/200 [42:58<23:13, 19.91s/it]Best trial: 63. Best value: 0.674974:  65%|██████▌   | 130/200 [43:17<23:13, 19.91s/it]Best trial: 63. Best value: 0.674974:  66%|██████▌   | 131/200 [43:17<22:24, 19.48s/it]Best trial: 63. Best value: 0.674974:  66%|██████▌   | 131/200 [43:33<22:24, 19.48s/it]Best trial: 63. Best value: 0.674974:  66%|██████▌   | 132/200 [43:33<21:05, 18.61s/it]Best trial: 63. Best value: 0.674974:  66%|██████▌   | 132/200 [43:48<21:05, 18.61s/it]Best trial: 63. Best value: 0.674974:  66%|██████▋   | 133/200 [43:48<19:39, 17.60s/it]Best trial: 63. Best value: 0.674974:  66%|██████▋   | 133/200 [44:05<19:39, 17.60s/it]Best trial: 63. Best value: 0.674974:  67%|██████▋   | 134/200 [44:05<18:54, 17.19s/it]Best trial: 63. Best value: 0.674974:  67%|██████▋   | 134/200 [44:20<18:54, 17.19s/it]Best trial: 63. Best value: 0.674974:  68%|██████▊   | 135/200 [44:20<18:07, 16.73s/it]Best trial: 63. Best value: 0.674974:  68%|██████▊   | 135/200 [44:38<18:07, 16.73s/it]Best trial: 63. Best value: 0.674974:  68%|██████▊   | 136/200 [44:38<18:08, 17.01s/it]Best trial: 63. Best value: 0.674974:  68%|██████▊   | 136/200 [44:56<18:08, 17.01s/it]Best trial: 63. Best value: 0.674974:  68%|██████▊   | 137/200 [44:56<18:08, 17.28s/it]Best trial: 63. Best value: 0.674974:  68%|██████▊   | 137/200 [45:12<18:08, 17.28s/it]Best trial: 63. Best value: 0.674974:  69%|██████▉   | 138/200 [45:12<17:31, 16.96s/it]Best trial: 63. Best value: 0.674974:  69%|██████▉   | 138/200 [45:28<17:31, 16.96s/it]Best trial: 63. Best value: 0.674974:  70%|██████▉   | 139/200 [45:28<16:54, 16.63s/it]Best trial: 63. Best value: 0.674974:  70%|██████▉   | 139/200 [45:45<16:54, 16.63s/it]Best trial: 63. Best value: 0.674974:  70%|███████   | 140/200 [45:45<16:37, 16.62s/it]Best trial: 63. Best value: 0.674974:  70%|███████   | 140/200 [46:01<16:37, 16.62s/it]Best trial: 63. Best value: 0.674974:  70%|███████   | 141/200 [46:01<16:24, 16.68s/it]Best trial: 63. Best value: 0.674974:  70%|███████   | 141/200 [46:18<16:24, 16.68s/it]Best trial: 63. Best value: 0.674974:  71%|███████   | 142/200 [46:18<16:00, 16.57s/it]Best trial: 63. Best value: 0.674974:  71%|███████   | 142/200 [46:34<16:00, 16.57s/it]Best trial: 63. Best value: 0.674974:  72%|███████▏  | 143/200 [46:34<15:44, 16.57s/it]Best trial: 63. Best value: 0.674974:  72%|███████▏  | 143/200 [46:52<15:44, 16.57s/it]Best trial: 63. Best value: 0.674974:  72%|███████▏  | 144/200 [46:52<15:49, 16.96s/it]Best trial: 63. Best value: 0.674974:  72%|███████▏  | 144/200 [47:09<15:49, 16.96s/it]Best trial: 63. Best value: 0.674974:  72%|███████▎  | 145/200 [47:09<15:29, 16.90s/it]Best trial: 63. Best value: 0.674974:  72%|███████▎  | 145/200 [47:25<15:29, 16.90s/it]Best trial: 63. Best value: 0.674974:  73%|███████▎  | 146/200 [47:25<14:52, 16.52s/it]Best trial: 63. Best value: 0.674974:  73%|███████▎  | 146/200 [47:39<14:52, 16.52s/it]Best trial: 63. Best value: 0.674974:  74%|███████▎  | 147/200 [47:39<14:10, 16.05s/it]Best trial: 63. Best value: 0.674974:  74%|███████▎  | 147/200 [47:58<14:10, 16.05s/it]Best trial: 63. Best value: 0.674974:  74%|███████▍  | 148/200 [47:58<14:28, 16.71s/it]Best trial: 63. Best value: 0.674974:  74%|███████▍  | 148/200 [48:13<14:28, 16.71s/it]Best trial: 63. Best value: 0.674974:  74%|███████▍  | 149/200 [48:13<13:51, 16.31s/it]Best trial: 63. Best value: 0.674974:  74%|███████▍  | 149/200 [48:29<13:51, 16.31s/it]Best trial: 63. Best value: 0.674974:  75%|███████▌  | 150/200 [48:29<13:23, 16.06s/it]Best trial: 63. Best value: 0.674974:  75%|███████▌  | 150/200 [48:50<13:23, 16.06s/it]Best trial: 63. Best value: 0.674974:  76%|███████▌  | 151/200 [48:50<14:30, 17.77s/it]Best trial: 63. Best value: 0.674974:  76%|███████▌  | 151/200 [49:07<14:30, 17.77s/it]Best trial: 63. Best value: 0.674974:  76%|███████▌  | 152/200 [49:07<13:58, 17.47s/it]Best trial: 63. Best value: 0.674974:  76%|███████▌  | 152/200 [49:22<13:58, 17.47s/it]Best trial: 63. Best value: 0.674974:  76%|███████▋  | 153/200 [49:22<13:07, 16.75s/it]Best trial: 63. Best value: 0.674974:  76%|███████▋  | 153/200 [49:38<13:07, 16.75s/it]Best trial: 63. Best value: 0.674974:  77%|███████▋  | 154/200 [49:38<12:36, 16.45s/it]Best trial: 63. Best value: 0.674974:  77%|███████▋  | 154/200 [49:55<12:36, 16.45s/it]Best trial: 63. Best value: 0.674974:  78%|███████▊  | 155/200 [49:55<12:29, 16.65s/it]Best trial: 63. Best value: 0.674974:  78%|███████▊  | 155/200 [50:13<12:29, 16.65s/it]Best trial: 63. Best value: 0.674974:  78%|███████▊  | 156/200 [50:13<12:27, 16.98s/it]Best trial: 156. Best value: 0.67536:  78%|███████▊  | 156/200 [50:30<12:27, 16.98s/it]Best trial: 156. Best value: 0.67536:  78%|███████▊  | 157/200 [50:30<12:13, 17.07s/it]Best trial: 156. Best value: 0.67536:  78%|███████▊  | 157/200 [50:46<12:13, 17.07s/it]Best trial: 156. Best value: 0.67536:  79%|███████▉  | 158/200 [50:46<11:48, 16.88s/it]Best trial: 156. Best value: 0.67536:  79%|███████▉  | 158/200 [51:09<11:48, 16.88s/it]Best trial: 156. Best value: 0.67536:  80%|███████▉  | 159/200 [51:09<12:39, 18.52s/it]Best trial: 156. Best value: 0.67536:  80%|███████▉  | 159/200 [51:26<12:39, 18.52s/it]Best trial: 156. Best value: 0.67536:  80%|████████  | 160/200 [51:26<12:05, 18.13s/it]Best trial: 156. Best value: 0.67536:  80%|████████  | 160/200 [51:43<12:05, 18.13s/it]Best trial: 156. Best value: 0.67536:  80%|████████  | 161/200 [51:43<11:37, 17.89s/it]Best trial: 156. Best value: 0.67536:  80%|████████  | 161/200 [52:01<11:37, 17.89s/it]Best trial: 156. Best value: 0.67536:  81%|████████  | 162/200 [52:01<11:21, 17.93s/it]Best trial: 156. Best value: 0.67536:  81%|████████  | 162/200 [52:19<11:21, 17.93s/it]Best trial: 156. Best value: 0.67536:  82%|████████▏ | 163/200 [52:19<10:55, 17.73s/it]Best trial: 156. Best value: 0.67536:  82%|████████▏ | 163/200 [52:36<10:55, 17.73s/it]Best trial: 156. Best value: 0.67536:  82%|████████▏ | 164/200 [52:36<10:33, 17.59s/it]Best trial: 156. Best value: 0.67536:  82%|████████▏ | 164/200 [52:52<10:33, 17.59s/it]Best trial: 156. Best value: 0.67536:  82%|████████▎ | 165/200 [52:52<10:02, 17.22s/it]Best trial: 156. Best value: 0.67536:  82%|████████▎ | 165/200 [53:10<10:02, 17.22s/it]Best trial: 156. Best value: 0.67536:  83%|████████▎ | 166/200 [53:10<09:49, 17.34s/it]Best trial: 156. Best value: 0.67536:  83%|████████▎ | 166/200 [53:27<09:49, 17.34s/it]Best trial: 156. Best value: 0.67536:  84%|████████▎ | 167/200 [53:27<09:33, 17.37s/it]Best trial: 156. Best value: 0.67536:  84%|████████▎ | 167/200 [53:43<09:33, 17.37s/it]Best trial: 156. Best value: 0.67536:  84%|████████▍ | 168/200 [53:43<08:59, 16.85s/it]Best trial: 156. Best value: 0.67536:  84%|████████▍ | 168/200 [53:59<08:59, 16.85s/it]Best trial: 156. Best value: 0.67536:  84%|████████▍ | 169/200 [53:59<08:38, 16.72s/it]Best trial: 156. Best value: 0.67536:  84%|████████▍ | 169/200 [54:16<08:38, 16.72s/it]Best trial: 156. Best value: 0.67536:  85%|████████▌ | 170/200 [54:16<08:24, 16.81s/it]Best trial: 156. Best value: 0.67536:  85%|████████▌ | 170/200 [54:33<08:24, 16.81s/it]Best trial: 156. Best value: 0.67536:  86%|████████▌ | 171/200 [54:33<08:09, 16.88s/it]Best trial: 156. Best value: 0.67536:  86%|████████▌ | 171/200 [54:49<08:09, 16.88s/it]Best trial: 156. Best value: 0.67536:  86%|████████▌ | 172/200 [54:49<07:44, 16.57s/it]Best trial: 156. Best value: 0.67536:  86%|████████▌ | 172/200 [55:06<07:44, 16.57s/it]Best trial: 156. Best value: 0.67536:  86%|████████▋ | 173/200 [55:06<07:30, 16.68s/it]Best trial: 156. Best value: 0.67536:  86%|████████▋ | 173/200 [55:27<07:30, 16.68s/it]Best trial: 156. Best value: 0.67536:  87%|████████▋ | 174/200 [55:27<07:47, 17.97s/it]Best trial: 156. Best value: 0.67536:  87%|████████▋ | 174/200 [55:45<07:47, 17.97s/it]Best trial: 156. Best value: 0.67536:  88%|████████▊ | 175/200 [55:45<07:30, 18.01s/it]Best trial: 175. Best value: 0.676455:  88%|████████▊ | 175/200 [56:02<07:30, 18.01s/it]Best trial: 175. Best value: 0.676455:  88%|████████▊ | 176/200 [56:02<07:04, 17.70s/it]Best trial: 175. Best value: 0.676455:  88%|████████▊ | 176/200 [56:19<07:04, 17.70s/it]Best trial: 175. Best value: 0.676455:  88%|████████▊ | 177/200 [56:19<06:41, 17.47s/it]Best trial: 175. Best value: 0.676455:  88%|████████▊ | 177/200 [56:36<06:41, 17.47s/it]Best trial: 175. Best value: 0.676455:  89%|████████▉ | 178/200 [56:36<06:17, 17.17s/it]Best trial: 175. Best value: 0.676455:  89%|████████▉ | 178/200 [57:01<06:17, 17.17s/it]Best trial: 175. Best value: 0.676455:  90%|████████▉ | 179/200 [57:01<06:53, 19.69s/it]Best trial: 175. Best value: 0.676455:  90%|████████▉ | 179/200 [57:25<06:53, 19.69s/it]Best trial: 175. Best value: 0.676455:  90%|█████████ | 180/200 [57:25<06:55, 20.77s/it]Best trial: 175. Best value: 0.676455:  90%|█████████ | 180/200 [57:41<06:55, 20.77s/it]Best trial: 175. Best value: 0.676455:  90%|█████████ | 181/200 [57:41<06:12, 19.59s/it]Best trial: 175. Best value: 0.676455:  90%|█████████ | 181/200 [57:58<06:12, 19.59s/it]Best trial: 175. Best value: 0.676455:  91%|█████████ | 182/200 [57:58<05:34, 18.59s/it]Best trial: 175. Best value: 0.676455:  91%|█████████ | 182/200 [58:14<05:34, 18.59s/it]Best trial: 175. Best value: 0.676455:  92%|█████████▏| 183/200 [58:14<05:06, 18.03s/it]Best trial: 175. Best value: 0.676455:  92%|█████████▏| 183/200 [58:30<05:06, 18.03s/it]Best trial: 175. Best value: 0.676455:  92%|█████████▏| 184/200 [58:30<04:37, 17.35s/it]Best trial: 175. Best value: 0.676455:  92%|█████████▏| 184/200 [58:49<04:37, 17.35s/it]Best trial: 175. Best value: 0.676455:  92%|█████████▎| 185/200 [58:49<04:26, 17.78s/it]Best trial: 185. Best value: 0.67872:  92%|█████████▎| 185/200 [59:06<04:26, 17.78s/it] Best trial: 185. Best value: 0.67872:  93%|█████████▎| 186/200 [59:06<04:05, 17.52s/it]Best trial: 185. Best value: 0.67872:  93%|█████████▎| 186/200 [59:22<04:05, 17.52s/it]Best trial: 185. Best value: 0.67872:  94%|█████████▎| 187/200 [59:22<03:43, 17.20s/it]Best trial: 185. Best value: 0.67872:  94%|█████████▎| 187/200 [59:40<03:43, 17.20s/it]Best trial: 185. Best value: 0.67872:  94%|█████████▍| 188/200 [59:40<03:27, 17.29s/it]Best trial: 185. Best value: 0.67872:  94%|█████████▍| 188/200 [1:00:02<03:27, 17.29s/it]Best trial: 185. Best value: 0.67872:  94%|█████████▍| 189/200 [1:00:02<03:27, 18.84s/it]Best trial: 185. Best value: 0.67872:  94%|█████████▍| 189/200 [1:00:18<03:27, 18.84s/it]Best trial: 185. Best value: 0.67872:  95%|█████████▌| 190/200 [1:00:18<02:59, 17.99s/it]Best trial: 185. Best value: 0.67872:  95%|█████████▌| 190/200 [1:00:36<02:59, 17.99s/it]Best trial: 185. Best value: 0.67872:  96%|█████████▌| 191/200 [1:00:36<02:39, 17.76s/it]Best trial: 185. Best value: 0.67872:  96%|█████████▌| 191/200 [1:00:52<02:39, 17.76s/it]Best trial: 185. Best value: 0.67872:  96%|█████████▌| 192/200 [1:00:52<02:19, 17.49s/it]Best trial: 185. Best value: 0.67872:  96%|█████████▌| 192/200 [1:01:08<02:19, 17.49s/it]Best trial: 185. Best value: 0.67872:  96%|█████████▋| 193/200 [1:01:08<01:59, 17.03s/it]Best trial: 185. Best value: 0.67872:  96%|█████████▋| 193/200 [1:01:24<01:59, 17.03s/it]Best trial: 185. Best value: 0.67872:  97%|█████████▋| 194/200 [1:01:24<01:40, 16.76s/it]Best trial: 185. Best value: 0.67872:  97%|█████████▋| 194/200 [1:01:40<01:40, 16.76s/it]Best trial: 185. Best value: 0.67872:  98%|█████████▊| 195/200 [1:01:40<01:22, 16.48s/it]Best trial: 185. Best value: 0.67872:  98%|█████████▊| 195/200 [1:02:02<01:22, 16.48s/it]Best trial: 185. Best value: 0.67872:  98%|█████████▊| 196/200 [1:02:02<01:12, 18.11s/it]Best trial: 185. Best value: 0.67872:  98%|█████████▊| 196/200 [1:02:18<01:12, 18.11s/it]Best trial: 185. Best value: 0.67872:  98%|█████████▊| 197/200 [1:02:18<00:52, 17.40s/it]Best trial: 185. Best value: 0.67872:  98%|█████████▊| 197/200 [1:02:38<00:52, 17.40s/it]Best trial: 185. Best value: 0.67872:  99%|█████████▉| 198/200 [1:02:38<00:36, 18.07s/it]Best trial: 185. Best value: 0.67872:  99%|█████████▉| 198/200 [1:02:54<00:36, 18.07s/it]Best trial: 185. Best value: 0.67872: 100%|█████████▉| 199/200 [1:02:54<00:17, 17.51s/it]Best trial: 185. Best value: 0.67872: 100%|█████████▉| 199/200 [1:03:11<00:17, 17.51s/it]Best trial: 185. Best value: 0.67872: 100%|██████████| 200/200 [1:03:11<00:00, 17.32s/it]Best trial: 185. Best value: 0.67872: 100%|██████████| 200/200 [1:03:11<00:00, 18.96s/it]
03:13:46 [INFO] models.training.ordinal_trainer: Best params: {'bootstrap_type': 'Bayesian', 'grow_policy': 'SymmetricTree', 'depth': 4, 'iterations': 180, 'learning_rate': 0.02625630773422796, 'border_count': 248, 'l2_leaf_reg': 6.161848163912827, 'min_data_in_leaf': 29, 'random_strength': 0.8340506054518393, 'colsample_bylevel': 0.7248689036006347, 'bagging_temperature': 0.664876952171159}
03:13:46 [INFO] models.training.ordinal_trainer: Best Within-2 Rate: 0.6787
03:13:48 [INFO] models.training.ordinal_trainer:   Threshold -11: trained (pos_rate=98.7%)
03:13:50 [INFO] models.training.ordinal_trainer:   Threshold -10: trained (pos_rate=98.6%)
03:13:53 [INFO] models.training.ordinal_trainer:   Threshold -9: trained (pos_rate=98.2%)
03:13:54 [INFO] models.training.ordinal_trainer:   Threshold -8: trained (pos_rate=97.4%)
03:13:56 [INFO] models.training.ordinal_trainer:   Threshold -7: trained (pos_rate=96.4%)
03:13:58 [INFO] models.training.ordinal_trainer:   Threshold -6: trained (pos_rate=95.5%)
03:14:00 [INFO] models.training.ordinal_trainer:   Threshold -5: trained (pos_rate=93.7%)
03:14:04 [INFO] models.training.ordinal_trainer:   Threshold -4: trained (pos_rate=90.4%)
03:14:07 [INFO] models.training.ordinal_trainer:   Threshold -3: trained (pos_rate=86.0%)
03:14:10 [INFO] models.training.ordinal_trainer:   Threshold -2: trained (pos_rate=81.2%)
03:14:14 [INFO] models.training.ordinal_trainer:   Threshold -1: trained (pos_rate=71.1%)
03:14:17 [INFO] models.training.ordinal_trainer:   Threshold +0: trained (pos_rate=59.8%)
03:14:20 [INFO] models.training.ordinal_trainer:   Threshold +1: trained (pos_rate=37.1%)
03:14:23 [INFO] models.training.ordinal_trainer:   Threshold +2: trained (pos_rate=25.6%)
03:14:27 [INFO] models.training.ordinal_trainer:   Threshold +3: trained (pos_rate=17.7%)
03:14:29 [INFO] models.training.ordinal_trainer:   Threshold +4: trained (pos_rate=13.3%)
03:14:33 [INFO] models.training.ordinal_trainer:   Threshold +5: trained (pos_rate=9.0%)
03:14:36 [INFO] models.training.ordinal_trainer:   Threshold +6: trained (pos_rate=6.4%)
03:14:39 [INFO] models.training.ordinal_trainer:   Threshold +7: trained (pos_rate=4.3%)
03:14:42 [INFO] models.training.ordinal_trainer:   Threshold +8: trained (pos_rate=3.4%)
03:14:44 [INFO] models.training.ordinal_trainer:   Threshold +9: trained (pos_rate=2.4%)
03:14:47 [INFO] models.training.ordinal_trainer:   Threshold +10: trained (pos_rate=1.9%)
03:14:50 [INFO] models.training.ordinal_trainer:   Threshold +11: trained (pos_rate=1.4%)
03:14:53 [INFO] models.training.ordinal_trainer:   Threshold +12: trained (pos_rate=1.1%)
03:14:53 [INFO] models.training.ordinal_trainer: Ordinal training complete: 24 classifiers
03:14:56 [INFO] models.training.ordinal_trainer: Saved ordinal model to models/saved/los_angeles/ordinal_catboost_optuna.pkl
03:14:56 [INFO] __main__: 
Saved model to models/saved/los_angeles/ordinal_catboost_optuna.pkl
03:14:56 [INFO] __main__: Saved best params to models/saved/los_angeles/best_params.json
03:14:56 [INFO] __main__: Saved final metrics to models/saved/los_angeles/final_metrics_los_angeles.json

============================================================
EVALUATION
============================================================

Test Set Metrics:
----------------------------------------
  delta_accuracy: 0.1065
  delta_mae: 7.6814
  off_by_1_rate: 0.0537
  off_by_2plus_rate: 0.8398
  within_1_rate: 0.1602
  within_2_rate: 0.1784

============================================================
FEATURE IMPORTANCE
============================================================

Top 30 Features:
                        feature  importance
0           fcst_humidity_range    5.183126
1       temp_zscore_vs_forecast    3.707598
2              obs_fcst_max_gap    3.372054
3    minutes_since_max_observed    3.293677
4           fcst_dewpoint_range    3.090010
5         gap_x_hours_remaining    2.759562
6                fcst_obs_ratio    2.669692
7       fcst_drift_max_upside_f    2.613130
8            log_intraday_range    2.520252
9          fcst_peak_hour_float    2.486558
10            err_max_pos_sofar    2.249927
11         intraday_range_sofar    2.160936
12     fcst_peak_band_width_min    2.052315
13        fcst_prev_hour_of_max    1.894088
14                vc_max_f_lag1    1.820503
15          pred_ceil_max_sofar    1.783502
16      confidence_weighted_gap    1.716132
17                settle_f_lag1    1.684963
18           fcst_dewpoint_mean    1.683295
19            fcst_dewpoint_min    1.492184
20            fcst_humidity_min    1.441354
21             remaining_upside    1.393377
22                      doy_cos    1.378479
23  fcst_drift_slope_f_per_lead    1.354609
24             delta_vcmax_lag1    1.299923
25         obs_fcst_gap_squared    1.291052
26      hours_since_market_open    1.283799
27           log_hours_to_close    1.246068
28                      doy_sin    1.193055
29          max_morning_f_sofar    1.190618

----------------------------------------
Station-city feature importance:
                         feature  importance
73    station_city_max_gap_sofar    0.396105
74          station_city_gap_std    0.384869
89   station_city_mean_gap_sofar    0.177825
103       station_city_gap_trend    0.037805
125  station_city_gap_x_fcst_gap    0.002633
128        station_city_temp_gap    0.001530
  station_city_max_gap_sofar: rank 74/201
  station_city_gap_std: rank 75/201
  station_city_mean_gap_sofar: rank 90/201
  station_city_gap_trend: rank 104/201
  station_city_gap_x_fcst_gap: rank 126/201
  station_city_temp_gap: rank 129/201

----------------------------------------
Multi-horizon feature importance:
                  feature  importance
35      fcst_multi_median    1.031648
39       fcst_multi_drift    0.922096
45        fcst_multi_mean    0.758706
47         fcst_multi_ema    0.744113
48  fcst_multi_t1_t2_diff    0.741188
63          fcst_multi_cv    0.471193
69   fcst_multi_range_pct    0.439441
72         fcst_multi_std    0.416938
80       fcst_multi_range    0.281177
  fcst_multi_median: rank 36/201
  fcst_multi_drift: rank 40/201
  fcst_multi_mean: rank 46/201
  fcst_multi_ema: rank 48/201
  fcst_multi_t1_t2_diff: rank 49/201
  fcst_multi_cv: rank 64/201
  fcst_multi_range_pct: rank 70/201
  fcst_multi_std: rank 73/201
  fcst_multi_range: rank 81/201

============================================================
SUMMARY
============================================================
City: los_angeles
Model: models/saved/los_angeles/ordinal_catboost_optuna.pkl
Params: models/saved/los_angeles/best_params.json
Metrics: models/saved/los_angeles/final_metrics_los_angeles.json
Training samples: 389,808
Test samples: 97,128
Optuna trials: 200
Best params: {'bootstrap_type': 'Bayesian', 'grow_policy': 'SymmetricTree', 'depth': 4, 'iterations': 180, 'learning_rate': 0.02625630773422796, 'border_count': 248, 'l2_leaf_reg': 6.161848163912827, 'min_data_in_leaf': 29, 'random_strength': 0.8340506054518393, 'colsample_bylevel': 0.7248689036006347, 'bagging_temperature': 0.664876952171159}

Key Metrics:
  Accuracy: 10.7%
  MAE: 7.68
  Within 1: 16.0%
  Within 2: 17.8%

============================================================
DONE
============================================================
