04:47:08 [INFO] __main__: ============================================================
04:47:08 [INFO] __main__: PHILADELPHIA Optuna Training (200 trials)
04:47:08 [INFO] __main__: Optimization objective: within2
04:47:08 [INFO] __main__: ============================================================
04:47:08 [INFO] __main__: Loading from training cache: data/training_cache/philadelphia/full.parquet
04:47:08 [INFO] __main__: Loaded 486,900 rows, 237 columns
04:47:08 [INFO] __main__: Data range after filtering: 2023-01-01 to 2025-12-03
04:47:09 [INFO] __main__: Total days: 1068
04:47:09 [INFO] __main__: Training: 2023-01-01 to 2025-05-04 (855 days)
04:47:09 [INFO] __main__: Testing:  2025-05-05 to 2025-12-03 (213 days)
04:47:09 [INFO] __main__: 
Training samples: 389,772
04:47:09 [INFO] __main__: Training days: 855
04:47:09 [INFO] __main__: Test samples: 97,128
04:47:09 [INFO] __main__: Test days: 213
04:47:09 [INFO] __main__: 
Station-city features: ['station_city_temp_gap', 'station_city_max_gap_sofar', 'station_city_mean_gap_sofar', 'station_city_gap_std', 'station_city_gap_trend', 'station_city_gap_x_fcst_gap']
04:47:09 [INFO] __main__:   station_city_temp_gap: 389,664/389,772 non-null (100.0%)
04:47:09 [INFO] __main__:   station_city_max_gap_sofar: 389,664/389,772 non-null (100.0%)
04:47:09 [INFO] __main__:   station_city_mean_gap_sofar: 389,664/389,772 non-null (100.0%)
04:47:09 [INFO] __main__:   station_city_gap_std: 389,664/389,772 non-null (100.0%)
04:47:09 [INFO] __main__:   station_city_gap_trend: 389,658/389,772 non-null (100.0%)
04:47:09 [INFO] __main__:   station_city_gap_x_fcst_gap: 389,664/389,772 non-null (100.0%)
04:47:09 [INFO] __main__: 
Multi-horizon features: ['fcst_multi_mean', 'fcst_multi_median', 'fcst_multi_ema', 'fcst_multi_std', 'fcst_multi_range', 'fcst_multi_t1_t2_diff', 'fcst_multi_drift', 'fcst_multi_cv', 'fcst_multi_range_pct']
04:47:09 [INFO] __main__:   fcst_multi_mean: 389,772/389,772 non-null (100.0%)
04:47:09 [INFO] __main__:   fcst_multi_median: 389,772/389,772 non-null (100.0%)
04:47:09 [INFO] __main__:   fcst_multi_ema: 389,772/389,772 non-null (100.0%)
04:47:09 [INFO] __main__:   fcst_multi_std: 389,772/389,772 non-null (100.0%)
04:47:09 [INFO] __main__:   fcst_multi_range: 389,772/389,772 non-null (100.0%)
04:47:09 [INFO] __main__:   fcst_multi_t1_t2_diff: 389,772/389,772 non-null (100.0%)
04:47:09 [INFO] __main__:   fcst_multi_drift: 389,772/389,772 non-null (100.0%)
04:47:09 [INFO] __main__:   fcst_multi_cv: 389,772/389,772 non-null (100.0%)
04:47:09 [INFO] __main__:   fcst_multi_range_pct: 389,772/389,772 non-null (100.0%)
04:47:10 [INFO] models.training.ordinal_trainer: Training ordinal model (catboost) on 389772 samples
04:47:11 [INFO] models.training.ordinal_trainer: City delta range: [-12, 12]
04:47:11 [INFO] models.training.ordinal_trainer: Training 24 threshold classifiers: [-11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12]
04:47:11 [INFO] models.training.ordinal_trainer: Starting Optuna tuning with 200 trials (objective=within2)

============================================================
OPTUNA TRAINING (200 trials, objective=within2)
============================================================
  0%|          | 0/200 [00:00<?, ?it/s]Best trial: 0. Best value: 0.385779:   0%|          | 0/200 [00:20<?, ?it/s]Best trial: 0. Best value: 0.385779:   0%|          | 1/200 [00:20<1:09:32, 20.97s/it]Best trial: 1. Best value: 0.423009:   0%|          | 1/200 [00:43<1:09:32, 20.97s/it]Best trial: 1. Best value: 0.423009:   1%|          | 2/200 [00:43<1:11:56, 21.80s/it]Best trial: 2. Best value: 0.484171:   1%|          | 2/200 [01:27<1:11:56, 21.80s/it]Best trial: 2. Best value: 0.484171:   2%|▏         | 3/200 [01:27<1:44:27, 31.81s/it]Best trial: 2. Best value: 0.484171:   2%|▏         | 3/200 [01:49<1:44:27, 31.81s/it]Best trial: 2. Best value: 0.484171:   2%|▏         | 4/200 [01:49<1:32:26, 28.30s/it]Best trial: 2. Best value: 0.484171:   2%|▏         | 4/200 [02:14<1:32:26, 28.30s/it]Best trial: 2. Best value: 0.484171:   2%|▎         | 5/200 [02:14<1:27:44, 27.00s/it]Best trial: 2. Best value: 0.484171:   2%|▎         | 5/200 [02:43<1:27:44, 27.00s/it]Best trial: 2. Best value: 0.484171:   3%|▎         | 6/200 [02:43<1:29:02, 27.54s/it]Best trial: 6. Best value: 0.500611:   3%|▎         | 6/200 [03:07<1:29:02, 27.54s/it]Best trial: 6. Best value: 0.500611:   4%|▎         | 7/200 [03:07<1:24:36, 26.30s/it]Best trial: 6. Best value: 0.500611:   4%|▎         | 7/200 [03:21<1:24:36, 26.30s/it]Best trial: 6. Best value: 0.500611:   4%|▍         | 8/200 [03:21<1:12:08, 22.55s/it]Best trial: 6. Best value: 0.500611:   4%|▍         | 8/200 [04:26<1:12:08, 22.55s/it]Best trial: 6. Best value: 0.500611:   4%|▍         | 9/200 [04:26<1:53:55, 35.79s/it]Best trial: 6. Best value: 0.500611:   4%|▍         | 9/200 [04:47<1:53:55, 35.79s/it]Best trial: 6. Best value: 0.500611:   5%|▌         | 10/200 [04:47<1:39:06, 31.30s/it]Best trial: 6. Best value: 0.500611:   5%|▌         | 10/200 [05:09<1:39:06, 31.30s/it]Best trial: 6. Best value: 0.500611:   6%|▌         | 11/200 [05:09<1:29:46, 28.50s/it]Best trial: 6. Best value: 0.500611:   6%|▌         | 11/200 [05:33<1:29:46, 28.50s/it]Best trial: 6. Best value: 0.500611:   6%|▌         | 12/200 [05:33<1:24:35, 27.00s/it]Best trial: 6. Best value: 0.500611:   6%|▌         | 12/200 [05:55<1:24:35, 27.00s/it]Best trial: 6. Best value: 0.500611:   6%|▋         | 13/200 [05:55<1:19:54, 25.64s/it]Best trial: 6. Best value: 0.500611:   6%|▋         | 13/200 [06:29<1:19:54, 25.64s/it]Best trial: 6. Best value: 0.500611:   7%|▋         | 14/200 [06:29<1:27:14, 28.14s/it]Best trial: 6. Best value: 0.500611:   7%|▋         | 14/200 [06:53<1:27:14, 28.14s/it]Best trial: 6. Best value: 0.500611:   8%|▊         | 15/200 [06:53<1:22:50, 26.87s/it]Best trial: 6. Best value: 0.500611:   8%|▊         | 15/200 [07:20<1:22:50, 26.87s/it]Best trial: 6. Best value: 0.500611:   8%|▊         | 16/200 [07:20<1:22:09, 26.79s/it]Best trial: 16. Best value: 0.503213:   8%|▊         | 16/200 [07:39<1:22:09, 26.79s/it]Best trial: 16. Best value: 0.503213:   8%|▊         | 17/200 [07:39<1:15:00, 24.59s/it]Best trial: 16. Best value: 0.503213:   8%|▊         | 17/200 [08:11<1:15:00, 24.59s/it]Best trial: 16. Best value: 0.503213:   9%|▉         | 18/200 [08:11<1:20:44, 26.62s/it]Best trial: 16. Best value: 0.503213:   9%|▉         | 18/200 [08:29<1:20:44, 26.62s/it]Best trial: 16. Best value: 0.503213:  10%|▉         | 19/200 [08:29<1:12:39, 24.08s/it]Best trial: 16. Best value: 0.503213:  10%|▉         | 19/200 [09:01<1:12:39, 24.08s/it]Best trial: 16. Best value: 0.503213:  10%|█         | 20/200 [09:01<1:19:08, 26.38s/it]Best trial: 16. Best value: 0.503213:  10%|█         | 20/200 [09:22<1:19:08, 26.38s/it]Best trial: 16. Best value: 0.503213:  10%|█         | 21/200 [09:22<1:14:29, 24.97s/it]Best trial: 16. Best value: 0.503213:  10%|█         | 21/200 [09:46<1:14:29, 24.97s/it]Best trial: 16. Best value: 0.503213:  11%|█         | 22/200 [09:46<1:13:04, 24.63s/it]Best trial: 22. Best value: 0.513544:  11%|█         | 22/200 [10:09<1:13:04, 24.63s/it]Best trial: 22. Best value: 0.513544:  12%|█▏        | 23/200 [10:09<1:10:42, 23.97s/it]Best trial: 22. Best value: 0.513544:  12%|█▏        | 23/200 [10:26<1:10:42, 23.97s/it]Best trial: 22. Best value: 0.513544:  12%|█▏        | 24/200 [10:26<1:04:57, 22.14s/it]Best trial: 22. Best value: 0.513544:  12%|█▏        | 24/200 [10:46<1:04:57, 22.14s/it]Best trial: 22. Best value: 0.513544:  12%|█▎        | 25/200 [10:46<1:02:03, 21.28s/it]Best trial: 22. Best value: 0.513544:  12%|█▎        | 25/200 [11:14<1:02:03, 21.28s/it]Best trial: 22. Best value: 0.513544:  13%|█▎        | 26/200 [11:14<1:07:49, 23.39s/it]Best trial: 22. Best value: 0.513544:  13%|█▎        | 26/200 [11:35<1:07:49, 23.39s/it]Best trial: 22. Best value: 0.513544:  14%|█▎        | 27/200 [11:35<1:05:39, 22.77s/it]Best trial: 22. Best value: 0.513544:  14%|█▎        | 27/200 [11:54<1:05:39, 22.77s/it]Best trial: 22. Best value: 0.513544:  14%|█▍        | 28/200 [11:54<1:01:52, 21.58s/it]Best trial: 22. Best value: 0.513544:  14%|█▍        | 28/200 [12:27<1:01:52, 21.58s/it]Best trial: 22. Best value: 0.513544:  14%|█▍        | 29/200 [12:27<1:11:17, 25.02s/it]Best trial: 22. Best value: 0.513544:  14%|█▍        | 29/200 [12:48<1:11:17, 25.02s/it]Best trial: 22. Best value: 0.513544:  15%|█▌        | 30/200 [12:48<1:07:17, 23.75s/it]Best trial: 22. Best value: 0.513544:  15%|█▌        | 30/200 [13:11<1:07:17, 23.75s/it]Best trial: 22. Best value: 0.513544:  16%|█▌        | 31/200 [13:11<1:06:03, 23.45s/it]Best trial: 22. Best value: 0.513544:  16%|█▌        | 31/200 [13:34<1:06:03, 23.45s/it]Best trial: 22. Best value: 0.513544:  16%|█▌        | 32/200 [13:34<1:05:27, 23.38s/it]Best trial: 22. Best value: 0.513544:  16%|█▌        | 32/200 [13:54<1:05:27, 23.38s/it]Best trial: 22. Best value: 0.513544:  16%|█▋        | 33/200 [13:54<1:02:13, 22.36s/it]Best trial: 22. Best value: 0.513544:  16%|█▋        | 33/200 [14:15<1:02:13, 22.36s/it]Best trial: 22. Best value: 0.513544:  17%|█▋        | 34/200 [14:15<1:00:28, 21.86s/it]Best trial: 22. Best value: 0.513544:  17%|█▋        | 34/200 [14:34<1:00:28, 21.86s/it]Best trial: 22. Best value: 0.513544:  18%|█▊        | 35/200 [14:34<57:52, 21.05s/it]  Best trial: 22. Best value: 0.513544:  18%|█▊        | 35/200 [14:56<57:52, 21.05s/it]Best trial: 22. Best value: 0.513544:  18%|█▊        | 36/200 [14:56<58:52, 21.54s/it]Best trial: 22. Best value: 0.513544:  18%|█▊        | 36/200 [15:19<58:52, 21.54s/it]Best trial: 22. Best value: 0.513544:  18%|█▊        | 37/200 [15:19<59:13, 21.80s/it]Best trial: 22. Best value: 0.513544:  18%|█▊        | 37/200 [15:36<59:13, 21.80s/it]Best trial: 22. Best value: 0.513544:  19%|█▉        | 38/200 [15:36<54:54, 20.34s/it]Best trial: 22. Best value: 0.513544:  19%|█▉        | 38/200 [15:54<54:54, 20.34s/it]Best trial: 22. Best value: 0.513544:  20%|█▉        | 39/200 [15:54<52:33, 19.59s/it]Best trial: 22. Best value: 0.513544:  20%|█▉        | 39/200 [17:33<52:33, 19.59s/it]Best trial: 22. Best value: 0.513544:  20%|██        | 40/200 [17:33<1:55:44, 43.40s/it]Best trial: 22. Best value: 0.513544:  20%|██        | 40/200 [17:57<1:55:44, 43.40s/it]Best trial: 22. Best value: 0.513544:  20%|██        | 41/200 [17:57<1:39:53, 37.70s/it]Best trial: 22. Best value: 0.513544:  20%|██        | 41/200 [18:16<1:39:53, 37.70s/it]Best trial: 22. Best value: 0.513544:  21%|██        | 42/200 [18:16<1:24:14, 31.99s/it]Best trial: 22. Best value: 0.513544:  21%|██        | 42/200 [18:33<1:24:14, 31.99s/it]Best trial: 22. Best value: 0.513544:  22%|██▏       | 43/200 [18:33<1:12:00, 27.52s/it]Best trial: 22. Best value: 0.513544:  22%|██▏       | 43/200 [18:56<1:12:00, 27.52s/it]Best trial: 22. Best value: 0.513544:  22%|██▏       | 44/200 [18:56<1:08:13, 26.24s/it]Best trial: 44. Best value: 0.521173:  22%|██▏       | 44/200 [19:17<1:08:13, 26.24s/it]Best trial: 44. Best value: 0.521173:  22%|██▎       | 45/200 [19:17<1:04:06, 24.81s/it]Best trial: 44. Best value: 0.521173:  22%|██▎       | 45/200 [19:38<1:04:06, 24.81s/it]Best trial: 44. Best value: 0.521173:  23%|██▎       | 46/200 [19:38<1:00:27, 23.56s/it]Best trial: 44. Best value: 0.521173:  23%|██▎       | 46/200 [19:55<1:00:27, 23.56s/it]Best trial: 44. Best value: 0.521173:  24%|██▎       | 47/200 [19:55<55:21, 21.71s/it]  Best trial: 44. Best value: 0.521173:  24%|██▎       | 47/200 [20:20<55:21, 21.71s/it]Best trial: 44. Best value: 0.521173:  24%|██▍       | 48/200 [20:20<57:28, 22.69s/it]Best trial: 44. Best value: 0.521173:  24%|██▍       | 48/200 [20:43<57:28, 22.69s/it]Best trial: 44. Best value: 0.521173:  24%|██▍       | 49/200 [20:43<57:20, 22.79s/it]Best trial: 44. Best value: 0.521173:  24%|██▍       | 49/200 [21:10<57:20, 22.79s/it]Best trial: 44. Best value: 0.521173:  25%|██▌       | 50/200 [21:10<59:44, 23.89s/it]Best trial: 44. Best value: 0.521173:  25%|██▌       | 50/200 [21:28<59:44, 23.89s/it]Best trial: 44. Best value: 0.521173:  26%|██▌       | 51/200 [21:28<55:00, 22.15s/it]Best trial: 44. Best value: 0.521173:  26%|██▌       | 51/200 [21:48<55:00, 22.15s/it]Best trial: 44. Best value: 0.521173:  26%|██▌       | 52/200 [21:48<53:23, 21.64s/it]Best trial: 44. Best value: 0.521173:  26%|██▌       | 52/200 [22:09<53:23, 21.64s/it]Best trial: 44. Best value: 0.521173:  26%|██▋       | 53/200 [22:09<52:30, 21.43s/it]Best trial: 44. Best value: 0.521173:  26%|██▋       | 53/200 [22:30<52:30, 21.43s/it]Best trial: 44. Best value: 0.521173:  27%|██▋       | 54/200 [22:30<51:48, 21.29s/it]Best trial: 44. Best value: 0.521173:  27%|██▋       | 54/200 [22:53<51:48, 21.29s/it]Best trial: 44. Best value: 0.521173:  28%|██▊       | 55/200 [22:53<52:18, 21.65s/it]Best trial: 44. Best value: 0.521173:  28%|██▊       | 55/200 [23:20<52:18, 21.65s/it]Best trial: 44. Best value: 0.521173:  28%|██▊       | 56/200 [23:20<55:44, 23.23s/it]Best trial: 44. Best value: 0.521173:  28%|██▊       | 56/200 [24:24<55:44, 23.23s/it]Best trial: 44. Best value: 0.521173:  28%|██▊       | 57/200 [24:24<1:24:45, 35.56s/it]Best trial: 44. Best value: 0.521173:  28%|██▊       | 57/200 [24:49<1:24:45, 35.56s/it]Best trial: 44. Best value: 0.521173:  29%|██▉       | 58/200 [24:49<1:16:39, 32.39s/it]Best trial: 44. Best value: 0.521173:  29%|██▉       | 58/200 [25:11<1:16:39, 32.39s/it]Best trial: 44. Best value: 0.521173:  30%|██▉       | 59/200 [25:11<1:08:31, 29.16s/it]Best trial: 44. Best value: 0.521173:  30%|██▉       | 59/200 [25:32<1:08:31, 29.16s/it]Best trial: 44. Best value: 0.521173:  30%|███       | 60/200 [25:32<1:02:21, 26.72s/it]Best trial: 44. Best value: 0.521173:  30%|███       | 60/200 [26:02<1:02:21, 26.72s/it]Best trial: 44. Best value: 0.521173:  30%|███       | 61/200 [26:02<1:04:32, 27.86s/it]Best trial: 44. Best value: 0.521173:  30%|███       | 61/200 [26:23<1:04:32, 27.86s/it]Best trial: 44. Best value: 0.521173:  31%|███       | 62/200 [26:23<59:23, 25.83s/it]  Best trial: 44. Best value: 0.521173:  31%|███       | 62/200 [26:49<59:23, 25.83s/it]Best trial: 44. Best value: 0.521173:  32%|███▏      | 63/200 [26:49<58:56, 25.81s/it]Best trial: 44. Best value: 0.521173:  32%|███▏      | 63/200 [27:09<58:56, 25.81s/it]Best trial: 44. Best value: 0.521173:  32%|███▏      | 64/200 [27:09<54:32, 24.06s/it]Best trial: 44. Best value: 0.521173:  32%|███▏      | 64/200 [27:29<54:32, 24.06s/it]Best trial: 44. Best value: 0.521173:  32%|███▎      | 65/200 [27:29<51:02, 22.68s/it]Best trial: 44. Best value: 0.521173:  32%|███▎      | 65/200 [27:46<51:02, 22.68s/it]Best trial: 44. Best value: 0.521173:  33%|███▎      | 66/200 [27:46<47:05, 21.08s/it]Best trial: 44. Best value: 0.521173:  33%|███▎      | 66/200 [28:10<47:05, 21.08s/it]Best trial: 44. Best value: 0.521173:  34%|███▎      | 67/200 [28:10<48:27, 21.86s/it]Best trial: 44. Best value: 0.521173:  34%|███▎      | 67/200 [28:44<48:27, 21.86s/it]Best trial: 44. Best value: 0.521173:  34%|███▍      | 68/200 [28:44<56:17, 25.59s/it]Best trial: 44. Best value: 0.521173:  34%|███▍      | 68/200 [29:00<56:17, 25.59s/it]Best trial: 44. Best value: 0.521173:  34%|███▍      | 69/200 [29:00<49:40, 22.75s/it]Best trial: 44. Best value: 0.521173:  34%|███▍      | 69/200 [29:18<49:40, 22.75s/it]Best trial: 44. Best value: 0.521173:  35%|███▌      | 70/200 [29:18<45:59, 21.23s/it]Best trial: 44. Best value: 0.521173:  35%|███▌      | 70/200 [29:33<45:59, 21.23s/it]Best trial: 44. Best value: 0.521173:  36%|███▌      | 71/200 [29:33<41:30, 19.31s/it]Best trial: 44. Best value: 0.521173:  36%|███▌      | 71/200 [29:49<41:30, 19.31s/it]Best trial: 44. Best value: 0.521173:  36%|███▌      | 72/200 [29:49<39:38, 18.59s/it]Best trial: 44. Best value: 0.521173:  36%|███▌      | 72/200 [30:06<39:38, 18.59s/it]Best trial: 44. Best value: 0.521173:  36%|███▋      | 73/200 [30:06<38:07, 18.01s/it]Best trial: 44. Best value: 0.521173:  36%|███▋      | 73/200 [30:22<38:07, 18.01s/it]Best trial: 44. Best value: 0.521173:  37%|███▋      | 74/200 [30:22<36:34, 17.41s/it]Best trial: 44. Best value: 0.521173:  37%|███▋      | 74/200 [30:38<36:34, 17.41s/it]Best trial: 44. Best value: 0.521173:  38%|███▊      | 75/200 [30:38<35:31, 17.05s/it]Best trial: 44. Best value: 0.521173:  38%|███▊      | 75/200 [30:55<35:31, 17.05s/it]Best trial: 44. Best value: 0.521173:  38%|███▊      | 76/200 [30:55<34:42, 16.80s/it]Best trial: 44. Best value: 0.521173:  38%|███▊      | 76/200 [31:11<34:42, 16.80s/it]Best trial: 44. Best value: 0.521173:  38%|███▊      | 77/200 [31:11<34:11, 16.68s/it]Best trial: 44. Best value: 0.521173:  38%|███▊      | 77/200 [31:28<34:11, 16.68s/it]Best trial: 44. Best value: 0.521173:  39%|███▉      | 78/200 [31:28<34:16, 16.86s/it]Best trial: 44. Best value: 0.521173:  39%|███▉      | 78/200 [31:43<34:16, 16.86s/it]Best trial: 44. Best value: 0.521173:  40%|███▉      | 79/200 [31:43<32:42, 16.22s/it]Best trial: 44. Best value: 0.521173:  40%|███▉      | 79/200 [32:04<32:42, 16.22s/it]Best trial: 44. Best value: 0.521173:  40%|████      | 80/200 [32:04<35:17, 17.65s/it]Best trial: 44. Best value: 0.521173:  40%|████      | 80/200 [32:20<35:17, 17.65s/it]Best trial: 44. Best value: 0.521173:  40%|████      | 81/200 [32:20<34:08, 17.21s/it]Best trial: 44. Best value: 0.521173:  40%|████      | 81/200 [32:34<34:08, 17.21s/it]Best trial: 44. Best value: 0.521173:  41%|████      | 82/200 [32:34<32:05, 16.32s/it]Best trial: 44. Best value: 0.521173:  41%|████      | 82/200 [32:51<32:05, 16.32s/it]Best trial: 44. Best value: 0.521173:  42%|████▏     | 83/200 [32:51<31:58, 16.40s/it]Best trial: 44. Best value: 0.521173:  42%|████▏     | 83/200 [33:07<31:58, 16.40s/it]Best trial: 44. Best value: 0.521173:  42%|████▏     | 84/200 [33:07<31:37, 16.36s/it]Best trial: 44. Best value: 0.521173:  42%|████▏     | 84/200 [33:32<31:37, 16.36s/it]Best trial: 44. Best value: 0.521173:  42%|████▎     | 85/200 [33:32<36:24, 18.99s/it]Best trial: 44. Best value: 0.521173:  42%|████▎     | 85/200 [33:48<36:24, 18.99s/it]Best trial: 44. Best value: 0.521173:  43%|████▎     | 86/200 [33:48<34:11, 17.99s/it]Best trial: 44. Best value: 0.521173:  43%|████▎     | 86/200 [34:03<34:11, 17.99s/it]Best trial: 44. Best value: 0.521173:  44%|████▎     | 87/200 [34:03<32:00, 17.00s/it]Best trial: 44. Best value: 0.521173:  44%|████▎     | 87/200 [34:31<32:00, 17.00s/it]Best trial: 44. Best value: 0.521173:  44%|████▍     | 88/200 [34:31<38:14, 20.49s/it]Best trial: 44. Best value: 0.521173:  44%|████▍     | 88/200 [34:48<38:14, 20.49s/it]Best trial: 44. Best value: 0.521173:  44%|████▍     | 89/200 [34:48<35:46, 19.34s/it]Best trial: 44. Best value: 0.521173:  44%|████▍     | 89/200 [35:25<35:46, 19.34s/it]Best trial: 44. Best value: 0.521173:  45%|████▌     | 90/200 [35:25<45:13, 24.67s/it]Best trial: 44. Best value: 0.521173:  45%|████▌     | 90/200 [35:44<45:13, 24.67s/it]Best trial: 44. Best value: 0.521173:  46%|████▌     | 91/200 [35:44<41:27, 22.82s/it]Best trial: 44. Best value: 0.521173:  46%|████▌     | 91/200 [35:58<41:27, 22.82s/it]Best trial: 44. Best value: 0.521173:  46%|████▌     | 92/200 [35:58<36:39, 20.37s/it]Best trial: 44. Best value: 0.521173:  46%|████▌     | 92/200 [36:12<36:39, 20.37s/it]Best trial: 44. Best value: 0.521173:  46%|████▋     | 93/200 [36:12<32:42, 18.34s/it]Best trial: 44. Best value: 0.521173:  46%|████▋     | 93/200 [36:29<32:42, 18.34s/it]Best trial: 44. Best value: 0.521173:  47%|████▋     | 94/200 [36:29<31:57, 18.09s/it]Best trial: 44. Best value: 0.521173:  47%|████▋     | 94/200 [36:43<31:57, 18.09s/it]Best trial: 44. Best value: 0.521173:  48%|████▊     | 95/200 [36:43<29:22, 16.78s/it]Best trial: 44. Best value: 0.521173:  48%|████▊     | 95/200 [37:03<29:22, 16.78s/it]Best trial: 44. Best value: 0.521173:  48%|████▊     | 96/200 [37:03<30:53, 17.82s/it]Best trial: 44. Best value: 0.521173:  48%|████▊     | 96/200 [37:18<30:53, 17.82s/it]Best trial: 44. Best value: 0.521173:  48%|████▊     | 97/200 [37:18<29:04, 16.93s/it]Best trial: 44. Best value: 0.521173:  48%|████▊     | 97/200 [37:35<29:04, 16.93s/it]Best trial: 44. Best value: 0.521173:  49%|████▉     | 98/200 [37:35<28:57, 17.03s/it]Best trial: 44. Best value: 0.521173:  49%|████▉     | 98/200 [37:58<28:57, 17.03s/it]Best trial: 44. Best value: 0.521173:  50%|████▉     | 99/200 [37:58<31:18, 18.60s/it]Best trial: 44. Best value: 0.521173:  50%|████▉     | 99/200 [38:19<31:18, 18.60s/it]Best trial: 44. Best value: 0.521173:  50%|█████     | 100/200 [38:19<32:07, 19.27s/it]Best trial: 44. Best value: 0.521173:  50%|█████     | 100/200 [38:46<32:07, 19.27s/it]Best trial: 44. Best value: 0.521173:  50%|█████     | 101/200 [38:46<35:52, 21.74s/it]Best trial: 44. Best value: 0.521173:  50%|█████     | 101/200 [39:03<35:52, 21.74s/it]Best trial: 44. Best value: 0.521173:  51%|█████     | 102/200 [39:03<33:13, 20.34s/it]Best trial: 44. Best value: 0.521173:  51%|█████     | 102/200 [39:19<33:13, 20.34s/it]Best trial: 44. Best value: 0.521173:  52%|█████▏    | 103/200 [39:19<30:50, 19.08s/it]Best trial: 44. Best value: 0.521173:  52%|█████▏    | 103/200 [39:33<30:50, 19.08s/it]Best trial: 44. Best value: 0.521173:  52%|█████▏    | 104/200 [39:33<27:51, 17.41s/it]Best trial: 44. Best value: 0.521173:  52%|█████▏    | 104/200 [39:48<27:51, 17.41s/it]Best trial: 44. Best value: 0.521173:  52%|█████▎    | 105/200 [39:48<26:34, 16.78s/it]Best trial: 44. Best value: 0.521173:  52%|█████▎    | 105/200 [40:06<26:34, 16.78s/it]Best trial: 44. Best value: 0.521173:  53%|█████▎    | 106/200 [40:06<26:49, 17.13s/it]Best trial: 44. Best value: 0.521173:  53%|█████▎    | 106/200 [40:20<26:49, 17.13s/it]Best trial: 44. Best value: 0.521173:  54%|█████▎    | 107/200 [40:20<25:03, 16.16s/it]Best trial: 44. Best value: 0.521173:  54%|█████▎    | 107/200 [40:36<25:03, 16.16s/it]Best trial: 44. Best value: 0.521173:  54%|█████▍    | 108/200 [40:36<24:47, 16.17s/it]Best trial: 44. Best value: 0.521173:  54%|█████▍    | 108/200 [40:50<24:47, 16.17s/it]Best trial: 44. Best value: 0.521173:  55%|█████▍    | 109/200 [40:50<23:38, 15.59s/it]Best trial: 44. Best value: 0.521173:  55%|█████▍    | 109/200 [41:05<23:38, 15.59s/it]Best trial: 44. Best value: 0.521173:  55%|█████▌    | 110/200 [41:05<23:04, 15.38s/it]Best trial: 110. Best value: 0.526835:  55%|█████▌    | 110/200 [41:21<23:04, 15.38s/it]Best trial: 110. Best value: 0.526835:  56%|█████▌    | 111/200 [41:21<23:05, 15.57s/it]Best trial: 110. Best value: 0.526835:  56%|█████▌    | 111/200 [41:36<23:05, 15.57s/it]Best trial: 110. Best value: 0.526835:  56%|█████▌    | 112/200 [41:36<22:28, 15.32s/it]Best trial: 110. Best value: 0.526835:  56%|█████▌    | 112/200 [41:53<22:28, 15.32s/it]Best trial: 110. Best value: 0.526835:  56%|█████▋    | 113/200 [41:53<22:58, 15.85s/it]Best trial: 110. Best value: 0.526835:  56%|█████▋    | 113/200 [42:08<22:58, 15.85s/it]Best trial: 110. Best value: 0.526835:  57%|█████▋    | 114/200 [42:08<22:29, 15.69s/it]Best trial: 110. Best value: 0.526835:  57%|█████▋    | 114/200 [42:23<22:29, 15.69s/it]Best trial: 110. Best value: 0.526835:  57%|█████▊    | 115/200 [42:23<21:56, 15.49s/it]Best trial: 110. Best value: 0.526835:  57%|█████▊    | 115/200 [42:57<21:56, 15.49s/it]Best trial: 110. Best value: 0.526835:  58%|█████▊    | 116/200 [42:57<29:25, 21.02s/it]Best trial: 110. Best value: 0.526835:  58%|█████▊    | 116/200 [43:18<29:25, 21.02s/it]Best trial: 110. Best value: 0.526835:  58%|█████▊    | 117/200 [43:18<28:43, 20.77s/it]Best trial: 110. Best value: 0.526835:  58%|█████▊    | 117/200 [43:35<28:43, 20.77s/it]Best trial: 110. Best value: 0.526835:  59%|█████▉    | 118/200 [43:35<26:50, 19.64s/it]Best trial: 110. Best value: 0.526835:  59%|█████▉    | 118/200 [43:49<26:50, 19.64s/it]Best trial: 110. Best value: 0.526835:  60%|█████▉    | 119/200 [43:49<24:34, 18.21s/it]Best trial: 110. Best value: 0.526835:  60%|█████▉    | 119/200 [44:05<24:34, 18.21s/it]Best trial: 110. Best value: 0.526835:  60%|██████    | 120/200 [44:05<23:05, 17.32s/it]Best trial: 110. Best value: 0.526835:  60%|██████    | 120/200 [44:18<23:05, 17.32s/it]Best trial: 110. Best value: 0.526835:  60%|██████    | 121/200 [44:18<21:21, 16.22s/it]Best trial: 110. Best value: 0.526835:  60%|██████    | 121/200 [44:37<21:21, 16.22s/it]Best trial: 110. Best value: 0.526835:  61%|██████    | 122/200 [44:37<22:09, 17.05s/it]Best trial: 110. Best value: 0.526835:  61%|██████    | 122/200 [44:56<22:09, 17.05s/it]Best trial: 110. Best value: 0.526835:  62%|██████▏   | 123/200 [44:56<22:31, 17.55s/it]Best trial: 110. Best value: 0.526835:  62%|██████▏   | 123/200 [45:11<22:31, 17.55s/it]Best trial: 110. Best value: 0.526835:  62%|██████▏   | 124/200 [45:11<21:06, 16.66s/it]Best trial: 110. Best value: 0.526835:  62%|██████▏   | 124/200 [45:28<21:06, 16.66s/it]Best trial: 110. Best value: 0.526835:  62%|██████▎   | 125/200 [45:28<21:05, 16.87s/it]Best trial: 110. Best value: 0.526835:  62%|██████▎   | 125/200 [45:44<21:05, 16.87s/it]Best trial: 110. Best value: 0.526835:  63%|██████▎   | 126/200 [45:44<20:29, 16.61s/it]Best trial: 110. Best value: 0.526835:  63%|██████▎   | 126/200 [46:08<20:29, 16.61s/it]Best trial: 110. Best value: 0.526835:  64%|██████▎   | 127/200 [46:08<22:51, 18.79s/it]Best trial: 110. Best value: 0.526835:  64%|██████▎   | 127/200 [46:24<22:51, 18.79s/it]Best trial: 110. Best value: 0.526835:  64%|██████▍   | 128/200 [46:24<21:29, 17.91s/it]Best trial: 110. Best value: 0.526835:  64%|██████▍   | 128/200 [46:42<21:29, 17.91s/it]Best trial: 110. Best value: 0.526835:  64%|██████▍   | 129/200 [46:42<21:27, 18.13s/it]Best trial: 110. Best value: 0.526835:  64%|██████▍   | 129/200 [47:09<21:27, 18.13s/it]Best trial: 110. Best value: 0.526835:  65%|██████▌   | 130/200 [47:09<24:15, 20.79s/it]Best trial: 110. Best value: 0.526835:  65%|██████▌   | 130/200 [47:25<24:15, 20.79s/it]Best trial: 110. Best value: 0.526835:  66%|██████▌   | 131/200 [47:25<22:09, 19.26s/it]Best trial: 110. Best value: 0.526835:  66%|██████▌   | 131/200 [47:40<22:09, 19.26s/it]Best trial: 110. Best value: 0.526835:  66%|██████▌   | 132/200 [47:40<20:17, 17.90s/it]Best trial: 110. Best value: 0.526835:  66%|██████▌   | 132/200 [47:55<20:17, 17.90s/it]Best trial: 110. Best value: 0.526835:  66%|██████▋   | 133/200 [47:55<19:15, 17.24s/it]Best trial: 110. Best value: 0.526835:  66%|██████▋   | 133/200 [48:11<19:15, 17.24s/it]Best trial: 110. Best value: 0.526835:  67%|██████▋   | 134/200 [48:11<18:18, 16.65s/it]Best trial: 110. Best value: 0.526835:  67%|██████▋   | 134/200 [48:26<18:18, 16.65s/it]Best trial: 110. Best value: 0.526835:  68%|██████▊   | 135/200 [48:26<17:34, 16.22s/it]Best trial: 110. Best value: 0.526835:  68%|██████▊   | 135/200 [48:40<17:34, 16.22s/it]Best trial: 110. Best value: 0.526835:  68%|██████▊   | 136/200 [48:40<16:31, 15.49s/it]Best trial: 110. Best value: 0.526835:  68%|██████▊   | 136/200 [49:03<16:31, 15.49s/it]Best trial: 110. Best value: 0.526835:  68%|██████▊   | 137/200 [49:03<18:42, 17.81s/it]Best trial: 110. Best value: 0.526835:  68%|██████▊   | 137/200 [49:27<18:42, 17.81s/it]Best trial: 110. Best value: 0.526835:  69%|██████▉   | 138/200 [49:27<20:19, 19.66s/it]Best trial: 110. Best value: 0.526835:  69%|██████▉   | 138/200 [49:47<20:19, 19.66s/it]Best trial: 110. Best value: 0.526835:  70%|██████▉   | 139/200 [49:47<20:13, 19.90s/it]Best trial: 110. Best value: 0.526835:  70%|██████▉   | 139/200 [50:07<20:13, 19.90s/it]Best trial: 110. Best value: 0.526835:  70%|███████   | 140/200 [50:07<19:49, 19.83s/it]Best trial: 110. Best value: 0.526835:  70%|███████   | 140/200 [50:27<19:49, 19.83s/it]Best trial: 110. Best value: 0.526835:  70%|███████   | 141/200 [50:27<19:24, 19.74s/it]Best trial: 110. Best value: 0.526835:  70%|███████   | 141/200 [50:45<19:24, 19.74s/it]Best trial: 110. Best value: 0.526835:  71%|███████   | 142/200 [50:45<18:40, 19.32s/it]Best trial: 110. Best value: 0.526835:  71%|███████   | 142/200 [51:02<18:40, 19.32s/it]Best trial: 110. Best value: 0.526835:  72%|███████▏  | 143/200 [51:02<17:44, 18.68s/it]Best trial: 110. Best value: 0.526835:  72%|███████▏  | 143/200 [51:21<17:44, 18.68s/it]Best trial: 110. Best value: 0.526835:  72%|███████▏  | 144/200 [51:21<17:37, 18.88s/it]Best trial: 110. Best value: 0.526835:  72%|███████▏  | 144/200 [51:43<17:37, 18.88s/it]Best trial: 110. Best value: 0.526835:  72%|███████▎  | 145/200 [51:43<18:05, 19.74s/it]Best trial: 110. Best value: 0.526835:  72%|███████▎  | 145/200 [52:05<18:05, 19.74s/it]Best trial: 110. Best value: 0.526835:  73%|███████▎  | 146/200 [52:05<18:15, 20.29s/it]Best trial: 110. Best value: 0.526835:  73%|███████▎  | 146/200 [52:27<18:15, 20.29s/it]Best trial: 110. Best value: 0.526835:  74%|███████▎  | 147/200 [52:27<18:26, 20.88s/it]Best trial: 110. Best value: 0.526835:  74%|███████▎  | 147/200 [52:46<18:26, 20.88s/it]Best trial: 110. Best value: 0.526835:  74%|███████▍  | 148/200 [52:46<17:42, 20.44s/it]Best trial: 110. Best value: 0.526835:  74%|███████▍  | 148/200 [53:06<17:42, 20.44s/it]Best trial: 110. Best value: 0.526835:  74%|███████▍  | 149/200 [53:06<17:06, 20.13s/it]Best trial: 110. Best value: 0.526835:  74%|███████▍  | 149/200 [53:28<17:06, 20.13s/it]Best trial: 110. Best value: 0.526835:  75%|███████▌  | 150/200 [53:28<17:24, 20.88s/it]Best trial: 110. Best value: 0.526835:  75%|███████▌  | 150/200 [53:52<17:24, 20.88s/it]Best trial: 110. Best value: 0.526835:  76%|███████▌  | 151/200 [53:52<17:44, 21.73s/it]Best trial: 110. Best value: 0.526835:  76%|███████▌  | 151/200 [54:11<17:44, 21.73s/it]Best trial: 110. Best value: 0.526835:  76%|███████▌  | 152/200 [54:11<16:35, 20.74s/it]Best trial: 110. Best value: 0.526835:  76%|███████▌  | 152/200 [54:33<16:35, 20.74s/it]Best trial: 110. Best value: 0.526835:  76%|███████▋  | 153/200 [54:33<16:35, 21.17s/it]Best trial: 110. Best value: 0.526835:  76%|███████▋  | 153/200 [54:53<16:35, 21.17s/it]Best trial: 110. Best value: 0.526835:  77%|███████▋  | 154/200 [54:53<16:00, 20.88s/it]Best trial: 110. Best value: 0.526835:  77%|███████▋  | 154/200 [55:18<16:00, 20.88s/it]Best trial: 110. Best value: 0.526835:  78%|███████▊  | 155/200 [55:18<16:40, 22.24s/it]Best trial: 110. Best value: 0.526835:  78%|███████▊  | 155/200 [55:40<16:40, 22.24s/it]Best trial: 110. Best value: 0.526835:  78%|███████▊  | 156/200 [55:40<16:14, 22.15s/it]Best trial: 110. Best value: 0.526835:  78%|███████▊  | 156/200 [56:04<16:14, 22.15s/it]Best trial: 110. Best value: 0.526835:  78%|███████▊  | 157/200 [56:04<16:10, 22.57s/it]Best trial: 110. Best value: 0.526835:  78%|███████▊  | 157/200 [56:27<16:10, 22.57s/it]Best trial: 110. Best value: 0.526835:  79%|███████▉  | 158/200 [56:27<15:49, 22.62s/it]Best trial: 110. Best value: 0.526835:  79%|███████▉  | 158/200 [56:48<15:49, 22.62s/it]Best trial: 110. Best value: 0.526835:  80%|███████▉  | 159/200 [56:48<15:18, 22.39s/it]Best trial: 110. Best value: 0.526835:  80%|███████▉  | 159/200 [57:10<15:18, 22.39s/it]Best trial: 110. Best value: 0.526835:  80%|████████  | 160/200 [57:10<14:50, 22.25s/it]Best trial: 110. Best value: 0.526835:  80%|████████  | 160/200 [57:29<14:50, 22.25s/it]Best trial: 110. Best value: 0.526835:  80%|████████  | 161/200 [57:29<13:40, 21.04s/it]Best trial: 110. Best value: 0.526835:  80%|████████  | 161/200 [57:49<13:40, 21.04s/it]Best trial: 110. Best value: 0.526835:  81%|████████  | 162/200 [57:49<13:06, 20.69s/it]Best trial: 110. Best value: 0.526835:  81%|████████  | 162/200 [58:07<13:06, 20.69s/it]Best trial: 110. Best value: 0.526835:  82%|████████▏ | 163/200 [58:07<12:16, 19.91s/it]Best trial: 110. Best value: 0.526835:  82%|████████▏ | 163/200 [58:24<12:16, 19.91s/it]Best trial: 110. Best value: 0.526835:  82%|████████▏ | 164/200 [58:24<11:28, 19.13s/it]Best trial: 110. Best value: 0.526835:  82%|████████▏ | 164/200 [58:46<11:28, 19.13s/it]Best trial: 110. Best value: 0.526835:  82%|████████▎ | 165/200 [58:46<11:38, 19.96s/it]Best trial: 110. Best value: 0.526835:  82%|████████▎ | 165/200 [59:07<11:38, 19.96s/it]Best trial: 110. Best value: 0.526835:  83%|████████▎ | 166/200 [59:07<11:32, 20.38s/it]Best trial: 110. Best value: 0.526835:  83%|████████▎ | 166/200 [59:25<11:32, 20.38s/it]Best trial: 110. Best value: 0.526835:  84%|████████▎ | 167/200 [59:25<10:47, 19.61s/it]Best trial: 110. Best value: 0.526835:  84%|████████▎ | 167/200 [59:43<10:47, 19.61s/it]Best trial: 110. Best value: 0.526835:  84%|████████▍ | 168/200 [59:43<10:12, 19.13s/it]Best trial: 110. Best value: 0.526835:  84%|████████▍ | 168/200 [1:00:00<10:12, 19.13s/it]Best trial: 110. Best value: 0.526835:  84%|████████▍ | 169/200 [1:00:00<09:36, 18.61s/it]Best trial: 110. Best value: 0.526835:  84%|████████▍ | 169/200 [1:00:21<09:36, 18.61s/it]Best trial: 110. Best value: 0.526835:  85%|████████▌ | 170/200 [1:00:21<09:37, 19.26s/it]Best trial: 110. Best value: 0.526835:  85%|████████▌ | 170/200 [1:00:39<09:37, 19.26s/it]Best trial: 110. Best value: 0.526835:  86%|████████▌ | 171/200 [1:00:39<09:10, 18.98s/it]Best trial: 110. Best value: 0.526835:  86%|████████▌ | 171/200 [1:00:58<09:10, 18.98s/it]Best trial: 110. Best value: 0.526835:  86%|████████▌ | 172/200 [1:00:58<08:47, 18.82s/it]Best trial: 110. Best value: 0.526835:  86%|████████▌ | 172/200 [1:01:19<08:47, 18.82s/it]Best trial: 110. Best value: 0.526835:  86%|████████▋ | 173/200 [1:01:19<08:46, 19.48s/it]Best trial: 110. Best value: 0.526835:  86%|████████▋ | 173/200 [1:01:36<08:46, 19.48s/it]Best trial: 110. Best value: 0.526835:  87%|████████▋ | 174/200 [1:01:36<08:11, 18.90s/it]Best trial: 110. Best value: 0.526835:  87%|████████▋ | 174/200 [1:01:54<08:11, 18.90s/it]Best trial: 110. Best value: 0.526835:  88%|████████▊ | 175/200 [1:01:54<07:45, 18.62s/it]Best trial: 110. Best value: 0.526835:  88%|████████▊ | 175/200 [1:02:13<07:45, 18.62s/it]Best trial: 110. Best value: 0.526835:  88%|████████▊ | 176/200 [1:02:13<07:28, 18.71s/it]Best trial: 110. Best value: 0.526835:  88%|████████▊ | 176/200 [1:02:32<07:28, 18.71s/it]Best trial: 110. Best value: 0.526835:  88%|████████▊ | 177/200 [1:02:32<07:09, 18.67s/it]Best trial: 110. Best value: 0.526835:  88%|████████▊ | 177/200 [1:02:58<07:09, 18.67s/it]Best trial: 110. Best value: 0.526835:  89%|████████▉ | 178/200 [1:02:58<07:38, 20.84s/it]Best trial: 110. Best value: 0.526835:  89%|████████▉ | 178/200 [1:03:16<07:38, 20.84s/it]Best trial: 110. Best value: 0.526835:  90%|████████▉ | 179/200 [1:03:16<07:01, 20.08s/it]Best trial: 110. Best value: 0.526835:  90%|████████▉ | 179/200 [1:03:36<07:01, 20.08s/it]Best trial: 110. Best value: 0.526835:  90%|█████████ | 180/200 [1:03:36<06:38, 19.92s/it]Best trial: 110. Best value: 0.526835:  90%|█████████ | 180/200 [1:04:03<06:38, 19.92s/it]Best trial: 110. Best value: 0.526835:  90%|█████████ | 181/200 [1:04:03<07:00, 22.15s/it]Best trial: 110. Best value: 0.526835:  90%|█████████ | 181/200 [1:04:24<07:00, 22.15s/it]Best trial: 110. Best value: 0.526835:  91%|█████████ | 182/200 [1:04:24<06:29, 21.66s/it]Best trial: 110. Best value: 0.526835:  91%|█████████ | 182/200 [1:04:46<06:29, 21.66s/it]Best trial: 110. Best value: 0.526835:  92%|█████████▏| 183/200 [1:04:46<06:12, 21.89s/it]Best trial: 110. Best value: 0.526835:  92%|█████████▏| 183/200 [1:05:06<06:12, 21.89s/it]Best trial: 110. Best value: 0.526835:  92%|█████████▏| 184/200 [1:05:06<05:42, 21.39s/it]Best trial: 110. Best value: 0.526835:  92%|█████████▏| 184/200 [1:05:27<05:42, 21.39s/it]Best trial: 110. Best value: 0.526835:  92%|█████████▎| 185/200 [1:05:27<05:16, 21.08s/it]Best trial: 110. Best value: 0.526835:  92%|█████████▎| 185/200 [1:05:45<05:16, 21.08s/it]Best trial: 110. Best value: 0.526835:  93%|█████████▎| 186/200 [1:05:45<04:43, 20.22s/it]Best trial: 110. Best value: 0.526835:  93%|█████████▎| 186/200 [1:06:05<04:43, 20.22s/it]Best trial: 110. Best value: 0.526835:  94%|█████████▎| 187/200 [1:06:05<04:23, 20.29s/it]Best trial: 110. Best value: 0.526835:  94%|█████████▎| 187/200 [1:06:27<04:23, 20.29s/it]Best trial: 110. Best value: 0.526835:  94%|█████████▍| 188/200 [1:06:27<04:07, 20.61s/it]Best trial: 110. Best value: 0.526835:  94%|█████████▍| 188/200 [1:06:48<04:07, 20.61s/it]Best trial: 110. Best value: 0.526835:  94%|█████████▍| 189/200 [1:06:48<03:49, 20.90s/it]Best trial: 110. Best value: 0.526835:  94%|█████████▍| 189/200 [1:07:14<03:49, 20.90s/it]Best trial: 110. Best value: 0.526835:  95%|█████████▌| 190/200 [1:07:14<03:42, 22.29s/it]Best trial: 110. Best value: 0.526835:  95%|█████████▌| 190/200 [1:07:32<03:42, 22.29s/it]Best trial: 110. Best value: 0.526835:  96%|█████████▌| 191/200 [1:07:32<03:09, 21.01s/it]Best trial: 110. Best value: 0.526835:  96%|█████████▌| 191/200 [1:07:51<03:09, 21.01s/it]Best trial: 110. Best value: 0.526835:  96%|█████████▌| 192/200 [1:07:51<02:43, 20.46s/it]Best trial: 110. Best value: 0.526835:  96%|█████████▌| 192/200 [1:08:15<02:43, 20.46s/it]Best trial: 110. Best value: 0.526835:  96%|█████████▋| 193/200 [1:08:15<02:30, 21.46s/it]Best trial: 110. Best value: 0.526835:  96%|█████████▋| 193/200 [1:08:40<02:30, 21.46s/it]Best trial: 110. Best value: 0.526835:  97%|█████████▋| 194/200 [1:08:40<02:15, 22.57s/it]Best trial: 110. Best value: 0.526835:  97%|█████████▋| 194/200 [1:09:03<02:15, 22.57s/it]Best trial: 110. Best value: 0.526835:  98%|█████████▊| 195/200 [1:09:03<01:53, 22.75s/it]Best trial: 110. Best value: 0.526835:  98%|█████████▊| 195/200 [1:09:27<01:53, 22.75s/it]Best trial: 110. Best value: 0.526835:  98%|█████████▊| 196/200 [1:09:27<01:31, 22.98s/it]Best trial: 110. Best value: 0.526835:  98%|█████████▊| 196/200 [1:09:52<01:31, 22.98s/it]Best trial: 110. Best value: 0.526835:  98%|█████████▊| 197/200 [1:09:52<01:11, 23.77s/it]Best trial: 110. Best value: 0.526835:  98%|█████████▊| 197/200 [1:10:12<01:11, 23.77s/it]Best trial: 110. Best value: 0.526835:  99%|█████████▉| 198/200 [1:10:12<00:45, 22.72s/it]Best trial: 110. Best value: 0.526835:  99%|█████████▉| 198/200 [1:10:37<00:45, 22.72s/it]Best trial: 110. Best value: 0.526835: 100%|█████████▉| 199/200 [1:10:37<00:23, 23.41s/it]Best trial: 110. Best value: 0.526835: 100%|█████████▉| 199/200 [1:11:01<00:23, 23.41s/it]Best trial: 110. Best value: 0.526835: 100%|██████████| 200/200 [1:11:01<00:00, 23.30s/it]Best trial: 110. Best value: 0.526835: 100%|██████████| 200/200 [1:11:01<00:00, 21.31s/it]
05:58:12 [INFO] models.training.ordinal_trainer: Best params: {'bootstrap_type': 'Bayesian', 'grow_policy': 'SymmetricTree', 'depth': 5, 'iterations': 342, 'learning_rate': 0.01727052915683226, 'border_count': 62, 'l2_leaf_reg': 0.1217979416367658, 'min_data_in_leaf': 17, 'random_strength': 1.0249960403123626, 'colsample_bylevel': 0.3493567420964586, 'bagging_temperature': 0.7696494821515892}
05:58:12 [INFO] models.training.ordinal_trainer: Best Within-2 Rate: 0.5268
05:58:13 [INFO] models.training.ordinal_trainer:   Threshold -11: trained (pos_rate=93.9%)
05:58:15 [INFO] models.training.ordinal_trainer:   Threshold -10: trained (pos_rate=92.6%)
05:58:18 [INFO] models.training.ordinal_trainer:   Threshold -9: trained (pos_rate=90.3%)
05:58:20 [INFO] models.training.ordinal_trainer:   Threshold -8: trained (pos_rate=88.6%)
05:58:24 [INFO] models.training.ordinal_trainer:   Threshold -7: trained (pos_rate=86.2%)
05:58:25 [INFO] models.training.ordinal_trainer:   Threshold -6: trained (pos_rate=83.8%)
05:58:27 [INFO] models.training.ordinal_trainer:   Threshold -5: trained (pos_rate=80.3%)
05:58:28 [INFO] models.training.ordinal_trainer:   Threshold -4: trained (pos_rate=77.8%)
05:58:29 [INFO] models.training.ordinal_trainer:   Threshold -3: trained (pos_rate=72.6%)
05:58:31 [INFO] models.training.ordinal_trainer:   Threshold -2: trained (pos_rate=69.7%)
05:58:34 [INFO] models.training.ordinal_trainer:   Threshold -1: trained (pos_rate=64.1%)
05:58:37 [INFO] models.training.ordinal_trainer:   Threshold +0: trained (pos_rate=59.1%)
05:58:41 [INFO] models.training.ordinal_trainer:   Threshold +1: trained (pos_rate=43.7%)
05:58:43 [INFO] models.training.ordinal_trainer:   Threshold +2: trained (pos_rate=37.1%)
05:58:46 [INFO] models.training.ordinal_trainer:   Threshold +3: trained (pos_rate=29.8%)
05:58:50 [INFO] models.training.ordinal_trainer:   Threshold +4: trained (pos_rate=25.2%)
05:58:51 [INFO] models.training.ordinal_trainer:   Threshold +5: trained (pos_rate=21.0%)
05:58:56 [INFO] models.training.ordinal_trainer:   Threshold +6: trained (pos_rate=18.1%)
05:58:58 [INFO] models.training.ordinal_trainer:   Threshold +7: trained (pos_rate=14.3%)
05:59:03 [INFO] models.training.ordinal_trainer:   Threshold +8: trained (pos_rate=11.5%)
05:59:07 [INFO] models.training.ordinal_trainer:   Threshold +9: trained (pos_rate=9.4%)
05:59:09 [INFO] models.training.ordinal_trainer:   Threshold +10: trained (pos_rate=8.1%)
05:59:12 [INFO] models.training.ordinal_trainer:   Threshold +11: trained (pos_rate=6.0%)
05:59:15 [INFO] models.training.ordinal_trainer:   Threshold +12: trained (pos_rate=4.8%)
05:59:15 [INFO] models.training.ordinal_trainer: Ordinal training complete: 24 classifiers
05:59:17 [INFO] models.training.ordinal_trainer: Saved ordinal model to models/saved/philadelphia/ordinal_catboost_optuna.pkl
05:59:17 [INFO] __main__: 
Saved model to models/saved/philadelphia/ordinal_catboost_optuna.pkl
05:59:17 [INFO] __main__: Saved best params to models/saved/philadelphia/best_params.json
05:59:17 [INFO] __main__: Saved final metrics to models/saved/philadelphia/final_metrics_philadelphia.json

============================================================
EVALUATION
============================================================

Test Set Metrics:
----------------------------------------
  delta_accuracy: 0.1400
  delta_mae: 4.3244
  off_by_1_rate: 0.1653
  off_by_2plus_rate: 0.6947
  within_1_rate: 0.3053
  within_2_rate: 0.4119

============================================================
FEATURE IMPORTANCE
============================================================

Top 30 Features:
                       feature  importance
0         log_abs_obs_fcst_gap    8.092803
1             obs_fcst_max_gap    7.053413
2         obs_fcst_gap_squared    6.236211
3      temp_zscore_vs_forecast    6.103396
4               fcst_obs_ratio    5.630640
5         fcst_peak_hour_float    4.153888
6        fcst_prev_hour_of_max    3.900404
7             delta_vcmax_lag1    3.325177
8      confidence_weighted_gap    3.293257
9     fcst_peak_band_width_min    2.627757
10       fcst_multi_t1_t2_diff    1.979037
11       gap_x_hours_remaining    1.848785
12            remaining_upside    1.831559
13  minutes_since_max_observed    1.815829
14         fcst_cloudcover_max    1.799486
15    fcst_remaining_potential    1.795534
16             fcst_prev_std_f    1.657213
17        fcst_cloudcover_mean    1.633500
18           fcst_humidity_min    1.496577
19         fcst_cloudcover_min    1.344300
20         max_evening_f_sofar    1.260454
21          log_hours_to_close    1.141790
22                     doy_cos    1.088955
23         max_morning_f_sofar    1.042559
24           err_max_pos_sofar    0.978791
25          fcst_humidity_mean    0.941912
26             above_fcst_flag    0.934188
27                      t_base    0.905776
28          log_intraday_range    0.832573
29  expected_delta_uncertainty    0.751361

----------------------------------------
Station-city feature importance:
                         feature  importance
92    station_city_max_gap_sofar    0.151501
103  station_city_mean_gap_sofar    0.086376
108       station_city_gap_trend    0.045507
113         station_city_gap_std    0.019848
123  station_city_gap_x_fcst_gap    0.005341
156        station_city_temp_gap    0.000000
  station_city_max_gap_sofar: rank 93/201
  station_city_mean_gap_sofar: rank 104/201
  station_city_gap_trend: rank 109/201
  station_city_gap_std: rank 114/201
  station_city_gap_x_fcst_gap: rank 124/201
  station_city_temp_gap: rank 157/201

----------------------------------------
Multi-horizon feature importance:
                  feature  importance
10  fcst_multi_t1_t2_diff    1.979037
47   fcst_multi_range_pct    0.381761
58          fcst_multi_cv    0.321698
59       fcst_multi_drift    0.304652
64       fcst_multi_range    0.283423
66      fcst_multi_median    0.268187
68         fcst_multi_ema    0.261241
78        fcst_multi_mean    0.216037
93         fcst_multi_std    0.147176
  fcst_multi_t1_t2_diff: rank 11/201
  fcst_multi_range_pct: rank 48/201
  fcst_multi_cv: rank 59/201
  fcst_multi_drift: rank 60/201
  fcst_multi_range: rank 65/201
  fcst_multi_median: rank 67/201
  fcst_multi_ema: rank 69/201
  fcst_multi_mean: rank 79/201
  fcst_multi_std: rank 94/201

============================================================
SUMMARY
============================================================
City: philadelphia
Model: models/saved/philadelphia/ordinal_catboost_optuna.pkl
Params: models/saved/philadelphia/best_params.json
Metrics: models/saved/philadelphia/final_metrics_philadelphia.json
Training samples: 389,772
Test samples: 97,128
Optuna trials: 200
Best params: {'bootstrap_type': 'Bayesian', 'grow_policy': 'SymmetricTree', 'depth': 5, 'iterations': 342, 'learning_rate': 0.01727052915683226, 'border_count': 62, 'l2_leaf_reg': 0.1217979416367658, 'min_data_in_leaf': 17, 'random_strength': 1.0249960403123626, 'colsample_bylevel': 0.3493567420964586, 'bagging_temperature': 0.7696494821515892}

Key Metrics:
  Accuracy: 14.0%
  MAE: 4.32
  Within 1: 30.5%
  Within 2: 41.2%

============================================================
DONE
============================================================
