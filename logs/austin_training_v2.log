20:11:58 [INFO] __main__: ============================================================
20:11:58 [INFO] __main__: AUSTIN Optuna Training (3 trials)
20:11:58 [INFO] __main__: ============================================================
20:11:59 [INFO] src.db.connection: Database engine created: localhost:5434/kalshi_weather
20:11:59 [INFO] __main__: Available data: 2023-01-01 to 2025-11-27
20:11:59 [INFO] __main__: Total days: 1062
20:11:59 [INFO] __main__: Training: 2023-01-01 to 2025-04-28 (850 days)
20:11:59 [INFO] __main__: Testing:  2025-04-29 to 2025-11-27 (212 days)
20:11:59 [INFO] __main__: 
Building training dataset...
20:11:59 [INFO] __main__: Building dataset for austin: 2023-01-01 to 2025-04-28 (849 days)
20:11:59 [INFO] __main__: Using 14 parallel workers
20:11:59 [INFO] __main__: include_station_city=True
20:11:59 [INFO] __main__: Split into 29 chunks
20:11:59 [INFO] src.db.connection: Database engine created: localhost:5434/kalshi_weather
20:11:59 [INFO] src.db.connection: Database engine created: localhost:5434/kalshi_weather
20:11:59 [INFO] src.db.connection: Database engine created: localhost:5434/kalshi_weather
20:11:59 [INFO] src.db.connection: Database engine created: localhost:5434/kalshi_weather
20:11:59 [INFO] src.db.connection: Database engine created: localhost:5434/kalshi_weather
20:11:59 [INFO] src.db.connection: Database engine created: localhost:5434/kalshi_weather
20:11:59 [INFO] src.db.connection: Database engine created: localhost:5434/kalshi_weather
20:11:59 [INFO] src.db.connection: Database engine created: localhost:5434/kalshi_weather
20:11:59 [INFO] models.data.dataset: Building dataset for austin...
20:11:59 [INFO] models.data.dataset: Building dataset for austin...
20:11:59 [INFO] models.data.dataset: Building dataset for austin...
20:11:59 [INFO] models.data.dataset: Building dataset for austin...
20:11:59 [INFO] models.data.dataset: Building dataset for austin...
20:11:59 [INFO] models.data.dataset: Building dataset for austin...
20:11:59 [INFO] models.data.dataset: Building dataset for austin...
20:11:59 [INFO] models.data.dataset: Building dataset for austin...
20:11:59 [INFO] src.db.connection: Database engine created: localhost:5434/kalshi_weather
20:11:59 [INFO] src.db.connection: Database engine created: localhost:5434/kalshi_weather
20:11:59 [INFO] src.db.connection: Database engine created: localhost:5434/kalshi_weather
20:11:59 [INFO] models.data.dataset: Building dataset for austin...
20:11:59 [INFO] models.data.dataset: Building dataset for austin...
20:11:59 [INFO] src.db.connection: Database engine created: localhost:5434/kalshi_weather
20:11:59 [INFO] src.db.connection: Database engine created: localhost:5434/kalshi_weather
20:11:59 [INFO] src.db.connection: Database engine created: localhost:5434/kalshi_weather
20:11:59 [INFO] models.data.dataset: Building dataset for austin...
20:11:59 [INFO] models.data.dataset: Building dataset for austin...
20:11:59 [INFO] models.data.dataset: Building dataset for austin...
20:11:59 [INFO] models.data.dataset: Building dataset for austin...
20:11:59 [INFO] models.data.loader: Loaded 30 settlement records for austin from 2023-01-31 to 2023-03-01
20:11:59 [INFO] models.data.loader: Loaded 30 settlement records for austin from 2023-06-30 to 2023-07-29
20:11:59 [INFO] models.data.loader: Loaded 30 settlement records for austin from 2023-01-01 to 2023-01-30
20:11:59 [INFO] models.data.loader: Loaded 30 settlement records for austin from 2023-05-31 to 2023-06-29
20:11:59 [INFO] models.data.loader: Loaded 30 settlement records for austin from 2023-07-30 to 2023-08-28
20:11:59 [INFO] models.data.loader: Loaded 30 settlement records for austin from 2023-05-01 to 2023-05-30
20:11:59 [INFO] models.data.loader: Loaded 30 settlement records for austin from 2023-09-28 to 2023-10-27
20:11:59 [INFO] models.data.loader: Loaded 30 settlement records for austin from 2023-08-29 to 2023-09-27
20:11:59 [INFO] models.data.loader: Loaded 30 settlement records for austin from 2023-10-28 to 2023-11-26
20:11:59 [INFO] models.data.loader: Loaded 30 settlement records for austin from 2023-04-01 to 2023-04-30
20:11:59 [INFO] models.data.loader: Loaded 30 settlement records for austin from 2024-01-26 to 2024-02-24
20:11:59 [INFO] models.data.loader: Loaded 30 settlement records for austin from 2023-03-02 to 2023-03-31
20:11:59 [INFO] models.data.loader: Loaded 30 settlement records for austin from 2023-11-27 to 2023-12-26
20:11:59 [INFO] models.data.loader: Loaded 30 settlement records for austin from 2023-12-27 to 2024-01-25
20:12:00 [INFO] models.data.loader: Loaded 8928 VC observations for austin from 2023-07-29 to 2023-08-28
20:12:00 [INFO] models.data.loader: Loaded 8928 VC observations for austin from 2024-01-25 to 2024-02-24
20:12:00 [INFO] models.data.loader: Loaded 8928 VC observations for austin from 2023-09-27 to 2023-10-27
20:12:00 [INFO] models.data.loader: Loaded 8916 VC observations for austin from 2023-03-01 to 2023-03-31
20:12:00 [INFO] models.data.loader: Loaded 8928 VC observations for austin from 2023-11-26 to 2023-12-26
20:12:00 [INFO] models.data.loader: Loaded 8928 VC observations for austin from 2023-03-31 to 2023-04-30
20:12:00 [INFO] models.data.loader: Loaded 8928 VC observations for austin from 2023-05-30 to 2023-06-29
20:12:00 [INFO] models.data.loader: Loaded 8928 VC observations for austin from 2023-04-30 to 2023-05-30
20:12:00 [INFO] models.data.loader: Loaded 8940 VC observations for austin from 2023-10-27 to 2023-11-26
20:12:00 [INFO] models.data.loader: Loaded 8928 VC observations for austin from 2023-12-26 to 2024-01-25
20:12:00 [INFO] models.data.loader: Loaded 8712 VC observations for austin from 2022-12-31 to 2023-01-30
20:12:00 [INFO] models.data.loader: Loaded 8928 VC observations for austin from 2023-08-28 to 2023-09-27
20:12:00 [INFO] models.data.loader: Loaded 8928 VC observations for austin from 2023-06-29 to 2023-07-29
20:12:00 [INFO] models.data.loader: Loaded 8928 VC observations for austin from 2023-01-30 to 2023-03-01
20:17:31 [INFO] models.data.dataset: Built 13680 snapshots total
20:17:31 [INFO] src.db.connection: Database engine created: localhost:5434/kalshi_weather
20:17:31 [INFO] models.data.dataset: Building dataset for austin...
20:17:31 [INFO] __main__: Chunk 1/29: 2023-04-01 to 2023-04-30, 13,680 rows, 30 days
20:17:31 [INFO] models.data.loader: Loaded 30 settlement records for austin from 2024-02-25 to 2024-03-25
20:17:32 [INFO] models.data.loader: Loaded 8916 VC observations for austin from 2024-02-24 to 2024-03-25
20:17:33 [INFO] models.data.dataset: Built 13584 snapshots total
20:17:34 [INFO] src.db.connection: Database engine created: localhost:5434/kalshi_weather
20:17:34 [INFO] models.data.dataset: Building dataset for austin...
20:17:34 [INFO] __main__: Chunk 2/29: 2023-01-01 to 2023-01-30, 13,584 rows, 30 days
20:17:34 [INFO] models.data.loader: Loaded 30 settlement records for austin from 2024-03-26 to 2024-04-24
20:17:34 [INFO] models.data.loader: Loaded 8928 VC observations for austin from 2024-03-25 to 2024-04-24
20:17:36 [INFO] models.data.dataset: Built 13680 snapshots total
20:17:36 [INFO] models.data.dataset: Built 13680 snapshots total
20:17:36 [INFO] __main__: Chunk 3/29: 2023-01-31 to 2023-03-01, 13,680 rows, 30 days
20:17:36 [INFO] src.db.connection: Database engine created: localhost:5434/kalshi_weather
20:17:36 [INFO] models.data.dataset: Building dataset for austin...
20:17:36 [INFO] models.data.loader: Loaded 30 settlement records for austin from 2024-04-25 to 2024-05-24
20:17:36 [INFO] __main__: Chunk 4/29: 2023-03-02 to 2023-03-31, 13,680 rows, 30 days
20:17:36 [INFO] src.db.connection: Database engine created: localhost:5434/kalshi_weather
20:17:36 [INFO] models.data.dataset: Building dataset for austin...
20:17:36 [INFO] models.data.loader: Loaded 30 settlement records for austin from 2024-05-25 to 2024-06-23
20:17:36 [INFO] models.data.loader: Loaded 8928 VC observations for austin from 2024-04-24 to 2024-05-24
20:17:36 [INFO] models.data.loader: Loaded 8928 VC observations for austin from 2024-05-24 to 2024-06-23
20:18:03 [INFO] models.data.dataset: Built 13680 snapshots total
20:18:04 [INFO] __main__: Chunk 5/29: 2023-05-01 to 2023-05-30, 13,680 rows, 30 days
20:18:04 [INFO] src.db.connection: Database engine created: localhost:5434/kalshi_weather
20:18:04 [INFO] models.data.dataset: Building dataset for austin...
20:18:04 [INFO] models.data.loader: Loaded 30 settlement records for austin from 2024-06-24 to 2024-07-23
20:18:05 [INFO] models.data.loader: Loaded 8928 VC observations for austin from 2024-06-23 to 2024-07-23
20:18:16 [INFO] models.data.dataset: Built 13680 snapshots total
20:18:16 [INFO] __main__: Chunk 6/29: 2023-12-27 to 2024-01-25, 13,680 rows, 30 days
20:18:16 [INFO] src.db.connection: Database engine created: localhost:5434/kalshi_weather
20:18:16 [INFO] models.data.dataset: Building dataset for austin...
20:18:16 [INFO] models.data.loader: Loaded 30 settlement records for austin from 2024-07-24 to 2024-08-22
20:18:16 [INFO] models.data.loader: Loaded 8928 VC observations for austin from 2024-07-23 to 2024-08-22
20:18:21 [INFO] models.data.dataset: Built 13680 snapshots total
20:18:22 [INFO] __main__: Chunk 7/29: 2023-10-28 to 2023-11-26, 13,680 rows, 30 days
20:18:22 [INFO] src.db.connection: Database engine created: localhost:5434/kalshi_weather
20:18:22 [INFO] models.data.dataset: Building dataset for austin...
20:18:22 [INFO] models.data.loader: Loaded 30 settlement records for austin from 2024-08-23 to 2024-09-21
20:18:22 [INFO] models.data.loader: Loaded 8928 VC observations for austin from 2024-08-22 to 2024-09-21
20:18:23 [INFO] models.data.dataset: Built 13680 snapshots total
20:18:24 [INFO] __main__: Chunk 8/29: 2023-09-28 to 2023-10-27, 13,680 rows, 30 days
20:18:24 [INFO] src.db.connection: Database engine created: localhost:5434/kalshi_weather
20:18:24 [INFO] models.data.dataset: Building dataset for austin...
20:18:24 [INFO] models.data.loader: Loaded 30 settlement records for austin from 2024-09-22 to 2024-10-21
20:18:24 [INFO] models.data.dataset: Built 13680 snapshots total
20:18:24 [INFO] models.data.loader: Loaded 8928 VC observations for austin from 2024-09-21 to 2024-10-21
20:18:25 [INFO] __main__: Chunk 9/29: 2023-07-30 to 2023-08-28, 13,680 rows, 30 days
20:18:25 [INFO] src.db.connection: Database engine created: localhost:5434/kalshi_weather
20:18:25 [INFO] models.data.dataset: Building dataset for austin...
20:18:25 [INFO] models.data.loader: Loaded 30 settlement records for austin from 2024-10-22 to 2024-11-20
20:18:25 [INFO] models.data.loader: Loaded 8940 VC observations for austin from 2024-10-21 to 2024-11-20
20:18:26 [INFO] models.data.dataset: Built 13680 snapshots total
20:18:26 [INFO] models.data.dataset: Built 13680 snapshots total
20:18:27 [INFO] __main__: Chunk 10/29: 2023-06-30 to 2023-07-29, 13,680 rows, 30 days
20:18:27 [INFO] src.db.connection: Database engine created: localhost:5434/kalshi_weather
20:18:27 [INFO] models.data.dataset: Building dataset for austin...
20:18:27 [INFO] models.data.loader: Loaded 30 settlement records for austin from 2024-11-21 to 2024-12-20
20:18:27 [INFO] __main__: Chunk 11/29: 2023-11-27 to 2023-12-26, 13,680 rows, 30 days
20:18:27 [INFO] src.db.connection: Database engine created: localhost:5434/kalshi_weather
20:18:27 [INFO] models.data.dataset: Building dataset for austin...
20:18:27 [INFO] models.data.loader: Loaded 30 settlement records for austin from 2024-12-21 to 2025-01-19
20:18:27 [INFO] models.data.loader: Loaded 8928 VC observations for austin from 2024-11-20 to 2024-12-20
20:18:27 [INFO] models.data.loader: Loaded 8928 VC observations for austin from 2024-12-20 to 2025-01-19
20:18:29 [INFO] models.data.dataset: Built 13680 snapshots total
20:18:30 [INFO] __main__: Chunk 12/29: 2023-05-31 to 2023-06-29, 13,680 rows, 30 days
20:18:30 [INFO] src.db.connection: Database engine created: localhost:5434/kalshi_weather
20:18:30 [INFO] models.data.dataset: Building dataset for austin...
20:18:30 [INFO] models.data.loader: Loaded 30 settlement records for austin from 2025-01-20 to 2025-02-18
20:18:30 [INFO] models.data.loader: Loaded 8928 VC observations for austin from 2025-01-19 to 2025-02-18
20:18:32 [INFO] models.data.dataset: Built 13680 snapshots total
20:18:33 [INFO] src.db.connection: Database engine created: localhost:5434/kalshi_weather
20:18:33 [INFO] models.data.dataset: Building dataset for austin...
20:18:33 [INFO] __main__: Chunk 13/29: 2023-08-29 to 2023-09-27, 13,680 rows, 30 days
20:18:33 [INFO] models.data.loader: Loaded 30 settlement records for austin from 2025-02-19 to 2025-03-20
20:18:33 [INFO] models.data.loader: Loaded 8916 VC observations for austin from 2025-02-18 to 2025-03-20
20:18:33 [INFO] models.data.dataset: Built 13680 snapshots total
20:18:34 [INFO] __main__: Chunk 14/29: 2024-01-26 to 2024-02-24, 13,680 rows, 30 days
20:18:34 [INFO] src.db.connection: Database engine created: localhost:5434/kalshi_weather
20:18:34 [INFO] models.data.dataset: Building dataset for austin...
20:18:34 [INFO] models.data.loader: Loaded 30 settlement records for austin from 2025-03-21 to 2025-04-19
20:18:34 [INFO] models.data.loader: Loaded 8928 VC observations for austin from 2025-03-20 to 2025-04-19
20:23:52 [INFO] models.data.dataset: Built 13680 snapshots total
20:23:53 [INFO] __main__: Chunk 15/29: 2024-03-26 to 2024-04-24, 13,680 rows, 30 days
20:23:53 [INFO] src.db.connection: Database engine created: localhost:5434/kalshi_weather
20:23:53 [INFO] models.data.dataset: Building dataset for austin...
20:23:53 [INFO] models.data.loader: Loaded 9 settlement records for austin from 2025-04-20 to 2025-04-28
20:23:54 [INFO] models.data.loader: Loaded 2880 VC observations for austin from 2025-04-19 to 2025-04-28
20:23:56 [INFO] models.data.dataset: Built 13680 snapshots total
20:23:56 [INFO] models.data.dataset: Built 13680 snapshots total
20:23:56 [INFO] __main__: Chunk 16/29: 2024-05-25 to 2024-06-23, 13,680 rows, 30 days
20:23:56 [INFO] __main__: Chunk 17/29: 2024-04-25 to 2024-05-24, 13,680 rows, 30 days
20:23:56 [INFO] models.data.dataset: Built 13680 snapshots total
20:23:57 [INFO] __main__: Chunk 18/29: 2024-02-25 to 2024-03-25, 13,680 rows, 30 days
20:24:15 [INFO] models.data.dataset: Built 13680 snapshots total
20:24:15 [INFO] __main__: Chunk 19/29: 2024-06-24 to 2024-07-23, 13,680 rows, 30 days
20:24:27 [INFO] models.data.dataset: Built 13680 snapshots total
20:24:27 [INFO] __main__: Chunk 20/29: 2024-07-24 to 2024-08-22, 13,680 rows, 30 days
20:24:38 [INFO] models.data.dataset: Built 13680 snapshots total
20:24:38 [INFO] __main__: Chunk 21/29: 2024-08-23 to 2024-09-21, 13,680 rows, 30 days
20:24:39 [INFO] models.data.dataset: Built 13680 snapshots total
20:24:39 [INFO] __main__: Chunk 22/29: 2024-11-21 to 2024-12-20, 13,680 rows, 30 days
20:24:43 [INFO] models.data.dataset: Built 13680 snapshots total
20:24:43 [INFO] __main__: Chunk 23/29: 2024-10-22 to 2024-11-20, 13,680 rows, 30 days
20:24:45 [INFO] models.data.dataset: Built 13680 snapshots total
20:24:45 [INFO] models.data.dataset: Built 13680 snapshots total
20:24:46 [INFO] __main__: Chunk 24/29: 2024-09-22 to 2024-10-21, 13,680 rows, 30 days
20:24:46 [INFO] __main__: Chunk 25/29: 2024-12-21 to 2025-01-19, 13,680 rows, 30 days
20:24:46 [INFO] models.data.dataset: Built 13680 snapshots total
20:24:47 [INFO] __main__: Chunk 26/29: 2025-01-20 to 2025-02-18, 13,680 rows, 30 days
20:24:48 [INFO] models.data.dataset: Built 13680 snapshots total
20:24:49 [INFO] __main__: Chunk 27/29: 2025-02-19 to 2025-03-20, 13,680 rows, 30 days
20:24:55 [INFO] models.data.dataset: Built 13680 snapshots total
20:24:56 [INFO] __main__: Chunk 28/29: 2025-03-21 to 2025-04-19, 13,680 rows, 30 days
20:25:26 [INFO] models.data.dataset: Built 4104 snapshots total
20:25:26 [INFO] __main__: Chunk 29/29: 2025-04-20 to 2025-04-28, 4,104 rows, 9 days
20:25:27 [INFO] __main__: All chunks completed in 807.4s
/home/halsted/Documents/python/weather_updated/scripts/train_city_ordinal_optuna.py:188: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  df_combined = pd.concat(dfs, ignore_index=True)
20:25:29 [INFO] __main__: Combined dataset: 387,048 rows, 849 days
20:25:29 [INFO] __main__: 
Building test dataset...
20:25:29 [INFO] __main__: Building dataset for austin: 2025-04-29 to 2025-11-27 (213 days)
20:25:29 [INFO] __main__: Using 12 parallel workers
20:25:29 [INFO] __main__: include_station_city=True
20:25:29 [INFO] __main__: Split into 27 chunks
20:25:29 [INFO] src.db.connection: Database engine created: localhost:5434/kalshi_weather
20:25:29 [INFO] src.db.connection: Database engine created: localhost:5434/kalshi_weather
20:25:29 [INFO] src.db.connection: Database engine created: localhost:5434/kalshi_weather
20:25:29 [INFO] models.data.dataset: Building dataset for austin...
20:25:29 [INFO] src.db.connection: Database engine created: localhost:5434/kalshi_weather
20:25:29 [INFO] src.db.connection: Database engine created: localhost:5434/kalshi_weather
20:25:29 [INFO] src.db.connection: Database engine created: localhost:5434/kalshi_weather
20:25:29 [INFO] models.data.dataset: Building dataset for austin...
20:25:29 [INFO] models.data.dataset: Building dataset for austin...
20:25:29 [INFO] models.data.dataset: Building dataset for austin...
20:25:29 [INFO] src.db.connection: Database engine created: localhost:5434/kalshi_weather
20:25:29 [INFO] src.db.connection: Database engine created: localhost:5434/kalshi_weather
20:25:29 [INFO] models.data.dataset: Building dataset for austin...
20:25:29 [INFO] src.db.connection: Database engine created: localhost:5434/kalshi_weather
20:25:29 [INFO] src.db.connection: Database engine created: localhost:5434/kalshi_weather
20:25:29 [INFO] models.data.dataset: Building dataset for austin...
20:25:29 [INFO] src.db.connection: Database engine created: localhost:5434/kalshi_weather
20:25:29 [INFO] models.data.dataset: Building dataset for austin...
20:25:29 [INFO] models.data.dataset: Building dataset for austin...
20:25:29 [INFO] models.data.dataset: Building dataset for austin...
20:25:29 [INFO] models.data.dataset: Building dataset for austin...
20:25:29 [INFO] src.db.connection: Database engine created: localhost:5434/kalshi_weather
20:25:29 [INFO] models.data.dataset: Building dataset for austin...
20:25:29 [INFO] models.data.dataset: Building dataset for austin...
20:25:29 [INFO] models.data.loader: Loaded 8 settlement records for austin from 2025-05-15 to 2025-05-22
20:25:29 [INFO] models.data.loader: Loaded 8 settlement records for austin from 2025-04-29 to 2025-05-06
20:25:29 [INFO] models.data.loader: Loaded 8 settlement records for austin from 2025-05-23 to 2025-05-30
20:25:29 [INFO] models.data.loader: Loaded 8 settlement records for austin from 2025-05-31 to 2025-06-07
20:25:29 [INFO] models.data.loader: Loaded 8 settlement records for austin from 2025-06-16 to 2025-06-23
20:25:29 [INFO] models.data.loader: Loaded 8 settlement records for austin from 2025-06-08 to 2025-06-15
20:25:29 [INFO] models.data.loader: Loaded 8 settlement records for austin from 2025-07-18 to 2025-07-25
20:25:29 [INFO] models.data.loader: Loaded 8 settlement records for austin from 2025-07-10 to 2025-07-17
20:25:29 [INFO] models.data.loader: Loaded 8 settlement records for austin from 2025-05-07 to 2025-05-14
20:25:29 [INFO] models.data.loader: Loaded 8 settlement records for austin from 2025-07-02 to 2025-07-09
20:25:29 [INFO] models.data.loader: Loaded 8 settlement records for austin from 2025-06-24 to 2025-07-01
20:25:29 [INFO] models.data.loader: Loaded 8 settlement records for austin from 2025-07-26 to 2025-08-02
20:25:29 [INFO] models.data.loader: Loaded 2592 VC observations for austin from 2025-07-01 to 2025-07-09
20:25:29 [INFO] models.data.loader: Loaded 2592 VC observations for austin from 2025-07-17 to 2025-07-25
20:25:29 [INFO] models.data.loader: Loaded 2592 VC observations for austin from 2025-05-06 to 2025-05-14
20:25:29 [INFO] models.data.loader: Loaded 2592 VC observations for austin from 2025-07-25 to 2025-08-02
20:25:29 [INFO] models.data.loader: Loaded 2592 VC observations for austin from 2025-05-14 to 2025-05-22
20:25:29 [INFO] models.data.loader: Loaded 2592 VC observations for austin from 2025-04-28 to 2025-05-06
20:25:29 [INFO] models.data.loader: Loaded 2592 VC observations for austin from 2025-06-23 to 2025-07-01
20:25:29 [INFO] models.data.loader: Loaded 2592 VC observations for austin from 2025-07-09 to 2025-07-17
20:25:29 [INFO] models.data.loader: Loaded 2592 VC observations for austin from 2025-05-30 to 2025-06-07
20:25:29 [INFO] models.data.loader: Loaded 2592 VC observations for austin from 2025-06-15 to 2025-06-23
20:25:29 [INFO] models.data.loader: Loaded 2592 VC observations for austin from 2025-05-22 to 2025-05-30
20:25:29 [INFO] models.data.loader: Loaded 2592 VC observations for austin from 2025-06-07 to 2025-06-15
20:27:05 [INFO] models.data.dataset: Built 3648 snapshots total
20:27:05 [INFO] src.db.connection: Database engine created: localhost:5434/kalshi_weather
20:27:05 [INFO] models.data.dataset: Building dataset for austin...
20:27:05 [INFO] __main__: Chunk 1/27: 2025-07-18 to 2025-07-25, 3,648 rows, 8 days
20:27:05 [INFO] models.data.loader: Loaded 8 settlement records for austin from 2025-08-03 to 2025-08-10
20:27:05 [INFO] models.data.loader: Loaded 2592 VC observations for austin from 2025-08-02 to 2025-08-10
20:27:06 [INFO] models.data.dataset: Built 3648 snapshots total
20:27:06 [INFO] models.data.dataset: Built 3648 snapshots total
20:27:06 [INFO] src.db.connection: Database engine created: localhost:5434/kalshi_weather
20:27:06 [INFO] models.data.dataset: Building dataset for austin...
20:27:06 [INFO] __main__: Chunk 2/27: 2025-04-29 to 2025-05-06, 3,648 rows, 8 days
20:27:06 [INFO] src.db.connection: Database engine created: localhost:5434/kalshi_weather
20:27:06 [INFO] models.data.dataset: Building dataset for austin...
20:27:06 [INFO] __main__: Chunk 3/27: 2025-06-24 to 2025-07-01, 3,648 rows, 8 days
20:27:07 [INFO] models.data.loader: Loaded 8 settlement records for austin from 2025-08-11 to 2025-08-18
20:27:07 [INFO] models.data.loader: Loaded 8 settlement records for austin from 2025-08-19 to 2025-08-26
20:27:07 [INFO] models.data.loader: Loaded 2592 VC observations for austin from 2025-08-10 to 2025-08-18
20:27:07 [INFO] models.data.loader: Loaded 2592 VC observations for austin from 2025-08-18 to 2025-08-26
20:27:07 [INFO] models.data.dataset: Built 3648 snapshots total
20:27:07 [INFO] src.db.connection: Database engine created: localhost:5434/kalshi_weather
20:27:07 [INFO] models.data.dataset: Building dataset for austin...
20:27:07 [INFO] __main__: Chunk 4/27: 2025-07-02 to 2025-07-09, 3,648 rows, 8 days
20:27:07 [INFO] models.data.loader: Loaded 8 settlement records for austin from 2025-08-27 to 2025-09-03
20:27:08 [INFO] models.data.loader: Loaded 2592 VC observations for austin from 2025-08-26 to 2025-09-03
20:27:08 [INFO] models.data.dataset: Built 3648 snapshots total
20:27:08 [INFO] src.db.connection: Database engine created: localhost:5434/kalshi_weather
20:27:08 [INFO] models.data.dataset: Building dataset for austin...
20:27:08 [INFO] __main__: Chunk 5/27: 2025-05-15 to 2025-05-22, 3,648 rows, 8 days
20:27:08 [INFO] models.data.loader: Loaded 8 settlement records for austin from 2025-09-04 to 2025-09-11
20:27:08 [INFO] models.data.loader: Loaded 2592 VC observations for austin from 2025-09-03 to 2025-09-11
20:27:09 [INFO] models.data.dataset: Built 3648 snapshots total
20:27:09 [INFO] src.db.connection: Database engine created: localhost:5434/kalshi_weather
20:27:09 [INFO] models.data.dataset: Building dataset for austin...
20:27:09 [INFO] __main__: Chunk 6/27: 2025-05-23 to 2025-05-30, 3,648 rows, 8 days
20:27:09 [INFO] models.data.loader: Loaded 8 settlement records for austin from 2025-09-12 to 2025-09-19
20:27:09 [INFO] models.data.dataset: Built 3648 snapshots total
20:27:09 [INFO] src.db.connection: Database engine created: localhost:5434/kalshi_weather
20:27:09 [INFO] models.data.dataset: Building dataset for austin...
20:27:09 [INFO] __main__: Chunk 7/27: 2025-07-10 to 2025-07-17, 3,648 rows, 8 days
20:27:09 [INFO] models.data.loader: Loaded 8 settlement records for austin from 2025-09-20 to 2025-09-27
20:27:10 [INFO] models.data.loader: Loaded 2592 VC observations for austin from 2025-09-11 to 2025-09-19
20:27:10 [INFO] models.data.loader: Loaded 2592 VC observations for austin from 2025-09-19 to 2025-09-27
20:27:10 [INFO] models.data.dataset: Built 3648 snapshots total
20:27:10 [INFO] src.db.connection: Database engine created: localhost:5434/kalshi_weather
20:27:10 [INFO] models.data.dataset: Building dataset for austin...
20:27:10 [INFO] __main__: Chunk 8/27: 2025-06-08 to 2025-06-15, 3,648 rows, 8 days
20:27:10 [INFO] models.data.loader: Loaded 8 settlement records for austin from 2025-09-28 to 2025-10-05
20:27:10 [INFO] models.data.dataset: Built 3648 snapshots total
20:27:11 [INFO] src.db.connection: Database engine created: localhost:5434/kalshi_weather
20:27:11 [INFO] models.data.dataset: Building dataset for austin...
20:27:11 [INFO] __main__: Chunk 9/27: 2025-05-07 to 2025-05-14, 3,648 rows, 8 days
20:27:11 [INFO] models.data.loader: Loaded 8 settlement records for austin from 2025-10-06 to 2025-10-13
20:27:11 [INFO] models.data.loader: Loaded 2592 VC observations for austin from 2025-09-27 to 2025-10-05
20:27:11 [INFO] models.data.dataset: Built 3648 snapshots total
20:27:11 [INFO] src.db.connection: Database engine created: localhost:5434/kalshi_weather
20:27:11 [INFO] models.data.dataset: Building dataset for austin...
20:27:11 [INFO] __main__: Chunk 10/27: 2025-07-26 to 2025-08-02, 3,648 rows, 8 days
20:27:11 [INFO] models.data.loader: Loaded 8 settlement records for austin from 2025-10-14 to 2025-10-21
20:27:11 [INFO] models.data.loader: Loaded 2592 VC observations for austin from 2025-10-05 to 2025-10-13
20:27:11 [INFO] models.data.loader: Loaded 2592 VC observations for austin from 2025-10-13 to 2025-10-21
20:27:14 [INFO] models.data.dataset: Built 3648 snapshots total
20:27:14 [INFO] models.data.dataset: Built 3648 snapshots total
20:27:14 [INFO] src.db.connection: Database engine created: localhost:5434/kalshi_weather
20:27:14 [INFO] models.data.dataset: Building dataset for austin...
20:27:14 [INFO] __main__: Chunk 11/27: 2025-06-16 to 2025-06-23, 3,648 rows, 8 days
20:27:14 [INFO] models.data.loader: Loaded 8 settlement records for austin from 2025-10-22 to 2025-10-29
20:27:14 [INFO] src.db.connection: Database engine created: localhost:5434/kalshi_weather
20:27:14 [INFO] models.data.dataset: Building dataset for austin...
20:27:14 [INFO] __main__: Chunk 12/27: 2025-05-31 to 2025-06-07, 3,648 rows, 8 days
20:27:14 [INFO] models.data.loader: Loaded 8 settlement records for austin from 2025-10-30 to 2025-11-06
20:27:15 [INFO] models.data.loader: Loaded 2592 VC observations for austin from 2025-10-21 to 2025-10-29
20:27:15 [INFO] models.data.loader: Loaded 2604 VC observations for austin from 2025-10-29 to 2025-11-06
20:28:40 [INFO] models.data.dataset: Built 3648 snapshots total
20:28:40 [INFO] src.db.connection: Database engine created: localhost:5434/kalshi_weather
20:28:40 [INFO] models.data.dataset: Building dataset for austin...
20:28:40 [INFO] __main__: Chunk 13/27: 2025-08-03 to 2025-08-10, 3,648 rows, 8 days
20:28:41 [INFO] models.data.loader: Loaded 8 settlement records for austin from 2025-11-07 to 2025-11-14
20:28:41 [INFO] models.data.loader: Loaded 2592 VC observations for austin from 2025-11-06 to 2025-11-14
20:28:43 [INFO] models.data.dataset: Built 3648 snapshots total
20:28:43 [INFO] src.db.connection: Database engine created: localhost:5434/kalshi_weather
20:28:43 [INFO] models.data.dataset: Building dataset for austin...
20:28:43 [INFO] __main__: Chunk 14/27: 2025-08-19 to 2025-08-26, 3,648 rows, 8 days
20:28:43 [INFO] models.data.loader: Loaded 8 settlement records for austin from 2025-11-15 to 2025-11-22
20:28:43 [INFO] models.data.dataset: Built 3648 snapshots total
20:28:43 [INFO] models.data.loader: Loaded 2592 VC observations for austin from 2025-11-14 to 2025-11-22
20:28:43 [INFO] src.db.connection: Database engine created: localhost:5434/kalshi_weather
20:28:43 [INFO] models.data.dataset: Building dataset for austin...
20:28:43 [INFO] __main__: Chunk 15/27: 2025-08-11 to 2025-08-18, 3,648 rows, 8 days
20:28:43 [INFO] models.data.loader: Loaded 5 settlement records for austin from 2025-11-23 to 2025-11-27
20:28:44 [INFO] models.data.dataset: Built 3648 snapshots total
20:28:44 [INFO] models.data.loader: Loaded 1728 VC observations for austin from 2025-11-22 to 2025-11-27
20:28:44 [INFO] __main__: Chunk 16/27: 2025-09-12 to 2025-09-19, 3,648 rows, 8 days
20:28:45 [INFO] models.data.dataset: Built 3648 snapshots total
20:28:45 [INFO] __main__: Chunk 17/27: 2025-09-20 to 2025-09-27, 3,648 rows, 8 days
20:28:45 [INFO] models.data.dataset: Built 3648 snapshots total
20:28:45 [INFO] __main__: Chunk 18/27: 2025-08-27 to 2025-09-03, 3,648 rows, 8 days
20:28:46 [INFO] models.data.dataset: Built 3648 snapshots total
20:28:46 [INFO] __main__: Chunk 19/27: 2025-09-28 to 2025-10-05, 3,648 rows, 8 days
20:28:46 [INFO] models.data.dataset: Built 3648 snapshots total
20:28:46 [INFO] __main__: Chunk 20/27: 2025-09-04 to 2025-09-11, 3,648 rows, 8 days
20:28:47 [INFO] models.data.dataset: Built 3648 snapshots total
20:28:47 [INFO] __main__: Chunk 21/27: 2025-10-14 to 2025-10-21, 3,648 rows, 8 days
20:28:48 [INFO] models.data.dataset: Built 3648 snapshots total
20:28:48 [INFO] __main__: Chunk 22/27: 2025-10-06 to 2025-10-13, 3,648 rows, 8 days
20:28:50 [INFO] models.data.dataset: Built 3648 snapshots total
20:28:50 [INFO] __main__: Chunk 23/27: 2025-10-30 to 2025-11-06, 3,648 rows, 8 days
20:28:50 [INFO] models.data.dataset: Built 3648 snapshots total
20:28:50 [INFO] __main__: Chunk 24/27: 2025-10-22 to 2025-10-29, 3,648 rows, 8 days
20:29:34 [INFO] models.data.dataset: Built 2280 snapshots total
20:29:34 [INFO] __main__: Chunk 25/27: 2025-11-23 to 2025-11-27, 2,280 rows, 5 days
20:29:59 [INFO] models.data.dataset: Built 3648 snapshots total
20:30:00 [INFO] __main__: Chunk 26/27: 2025-11-07 to 2025-11-14, 3,648 rows, 8 days
20:30:02 [INFO] models.data.dataset: Built 3648 snapshots total
20:30:02 [INFO] __main__: Chunk 27/27: 2025-11-15 to 2025-11-22, 3,648 rows, 8 days
20:30:02 [INFO] __main__: All chunks completed in 273.5s
/home/halsted/Documents/python/weather_updated/scripts/train_city_ordinal_optuna.py:188: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  df_combined = pd.concat(dfs, ignore_index=True)
20:30:02 [INFO] __main__: Combined dataset: 97,128 rows, 213 days
20:30:03 [INFO] __main__: Cached datasets to models/saved/austin
20:30:03 [INFO] __main__: 
Training samples: 387,048
20:30:03 [INFO] __main__: Training days: 849
20:30:03 [INFO] __main__: Test samples: 97,128
20:30:03 [INFO] __main__: Test days: 213
20:30:03 [INFO] __main__: 
Station-city features: ['station_city_temp_gap', 'station_city_max_gap_sofar', 'station_city_mean_gap_sofar', 'station_city_gap_std', 'station_city_gap_trend']
20:30:03 [INFO] __main__:   station_city_temp_gap: 386,952/387,048 non-null (100.0%)
20:30:03 [INFO] __main__:   station_city_max_gap_sofar: 386,952/387,048 non-null (100.0%)
20:30:03 [INFO] __main__:   station_city_mean_gap_sofar: 386,952/387,048 non-null (100.0%)
20:30:03 [INFO] __main__:   station_city_gap_std: 386,952/387,048 non-null (100.0%)
20:30:03 [INFO] __main__:   station_city_gap_trend: 386,946/387,048 non-null (100.0%)
20:30:03 [INFO] __main__: 
Multi-horizon features: ['fcst_multi_std', 'fcst_multi_mean', 'fcst_multi_drift']
20:30:03 [INFO] __main__:   fcst_multi_std: 387,048/387,048 non-null (100.0%)
20:30:03 [INFO] __main__:   fcst_multi_mean: 387,048/387,048 non-null (100.0%)
20:30:03 [INFO] __main__:   fcst_multi_drift: 0/387,048 non-null (0.0%)
20:30:03 [INFO] models.training.ordinal_trainer: Training ordinal model (catboost) on 387048 samples
20:30:03 [WARNING] models.training.base_trainer: Missing columns (will fill with NaN): ['settle_f_lag1', 'settle_f_lag2', 'settle_f_lag7', 'vc_max_f_lag1', 'vc_max_f_lag7', 'delta_vcmax_lag1']
20:30:04 [INFO] models.training.ordinal_trainer: City delta range: [-10, 10]
20:30:04 [INFO] models.training.ordinal_trainer: Training 20 threshold classifiers: [-9, -8, -7, -6, -5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
20:30:04 [INFO] models.training.ordinal_trainer: Starting Optuna tuning with 3 trials

============================================================
OPTUNA TRAINING (3 trials)
============================================================
  0%|          | 0/3 [00:00<?, ?it/s]Best trial: 0. Best value: 0.906278:   0%|          | 0/3 [00:12<?, ?it/s]Best trial: 0. Best value: 0.906278:  33%|███▎      | 1/3 [00:12<00:24, 12.29s/it]Best trial: 0. Best value: 0.906278:  33%|███▎      | 1/3 [00:26<00:24, 12.29s/it]Best trial: 0. Best value: 0.906278:  67%|██████▋   | 2/3 [00:26<00:13, 13.49s/it]Best trial: 0. Best value: 0.906278:  67%|██████▋   | 2/3 [00:37<00:13, 13.49s/it]Best trial: 0. Best value: 0.906278: 100%|██████████| 3/3 [00:37<00:00, 12.40s/it]Best trial: 0. Best value: 0.906278: 100%|██████████| 3/3 [00:37<00:00, 12.57s/it]
20:30:42 [INFO] models.training.ordinal_trainer: Best params: {'bootstrap_type': 'Bayesian', 'depth': 4, 'iterations': 355, 'learning_rate': 0.04370785966589845, 'border_count': 94, 'l2_leaf_reg': 5.420869976640164, 'min_data_in_leaf': 29, 'random_strength': 1.2756080300633206, 'colsample_bylevel': 0.6722757296297908, 'bagging_temperature': 0.14495089756686863}
20:30:42 [INFO] models.training.ordinal_trainer: Best AUC: 0.9063
20:30:42 [WARNING] models.training.base_trainer: Missing columns (will fill with NaN): ['settle_f_lag1', 'settle_f_lag2', 'settle_f_lag7', 'vc_max_f_lag1', 'vc_max_f_lag7', 'delta_vcmax_lag1']
20:30:44 [INFO] models.training.ordinal_trainer:   Threshold -9: trained (pos_rate=92.4%)
20:30:44 [WARNING] models.training.base_trainer: Missing columns (will fill with NaN): ['settle_f_lag1', 'settle_f_lag2', 'settle_f_lag7', 'vc_max_f_lag1', 'vc_max_f_lag7', 'delta_vcmax_lag1']
20:30:46 [INFO] models.training.ordinal_trainer:   Threshold -8: trained (pos_rate=91.5%)
20:30:46 [WARNING] models.training.base_trainer: Missing columns (will fill with NaN): ['settle_f_lag1', 'settle_f_lag2', 'settle_f_lag7', 'vc_max_f_lag1', 'vc_max_f_lag7', 'delta_vcmax_lag1']
20:30:47 [INFO] models.training.ordinal_trainer:   Threshold -7: trained (pos_rate=89.5%)
20:30:47 [WARNING] models.training.base_trainer: Missing columns (will fill with NaN): ['settle_f_lag1', 'settle_f_lag2', 'settle_f_lag7', 'vc_max_f_lag1', 'vc_max_f_lag7', 'delta_vcmax_lag1']
20:30:49 [INFO] models.training.ordinal_trainer:   Threshold -6: trained (pos_rate=88.4%)
20:30:49 [WARNING] models.training.base_trainer: Missing columns (will fill with NaN): ['settle_f_lag1', 'settle_f_lag2', 'settle_f_lag7', 'vc_max_f_lag1', 'vc_max_f_lag7', 'delta_vcmax_lag1']
20:30:50 [INFO] models.training.ordinal_trainer:   Threshold -5: trained (pos_rate=85.8%)
20:30:50 [WARNING] models.training.base_trainer: Missing columns (will fill with NaN): ['settle_f_lag1', 'settle_f_lag2', 'settle_f_lag7', 'vc_max_f_lag1', 'vc_max_f_lag7', 'delta_vcmax_lag1']
20:30:52 [INFO] models.training.ordinal_trainer:   Threshold -4: trained (pos_rate=83.6%)
20:30:52 [WARNING] models.training.base_trainer: Missing columns (will fill with NaN): ['settle_f_lag1', 'settle_f_lag2', 'settle_f_lag7', 'vc_max_f_lag1', 'vc_max_f_lag7', 'delta_vcmax_lag1']
20:30:53 [INFO] models.training.ordinal_trainer:   Threshold -3: trained (pos_rate=80.0%)
20:30:53 [WARNING] models.training.base_trainer: Missing columns (will fill with NaN): ['settle_f_lag1', 'settle_f_lag2', 'settle_f_lag7', 'vc_max_f_lag1', 'vc_max_f_lag7', 'delta_vcmax_lag1']
20:30:55 [INFO] models.training.ordinal_trainer:   Threshold -2: trained (pos_rate=76.7%)
20:30:55 [WARNING] models.training.base_trainer: Missing columns (will fill with NaN): ['settle_f_lag1', 'settle_f_lag2', 'settle_f_lag7', 'vc_max_f_lag1', 'vc_max_f_lag7', 'delta_vcmax_lag1']
20:30:57 [INFO] models.training.ordinal_trainer:   Threshold -1: trained (pos_rate=70.9%)
20:30:57 [WARNING] models.training.base_trainer: Missing columns (will fill with NaN): ['settle_f_lag1', 'settle_f_lag2', 'settle_f_lag7', 'vc_max_f_lag1', 'vc_max_f_lag7', 'delta_vcmax_lag1']
20:31:00 [INFO] models.training.ordinal_trainer:   Threshold +0: trained (pos_rate=65.0%)
20:31:00 [WARNING] models.training.base_trainer: Missing columns (will fill with NaN): ['settle_f_lag1', 'settle_f_lag2', 'settle_f_lag7', 'vc_max_f_lag1', 'vc_max_f_lag7', 'delta_vcmax_lag1']
20:31:02 [INFO] models.training.ordinal_trainer:   Threshold +1: trained (pos_rate=46.4%)
20:31:02 [WARNING] models.training.base_trainer: Missing columns (will fill with NaN): ['settle_f_lag1', 'settle_f_lag2', 'settle_f_lag7', 'vc_max_f_lag1', 'vc_max_f_lag7', 'delta_vcmax_lag1']
20:31:05 [INFO] models.training.ordinal_trainer:   Threshold +2: trained (pos_rate=38.1%)
20:31:05 [WARNING] models.training.base_trainer: Missing columns (will fill with NaN): ['settle_f_lag1', 'settle_f_lag2', 'settle_f_lag7', 'vc_max_f_lag1', 'vc_max_f_lag7', 'delta_vcmax_lag1']
20:31:09 [INFO] models.training.ordinal_trainer:   Threshold +3: trained (pos_rate=30.2%)
20:31:09 [WARNING] models.training.base_trainer: Missing columns (will fill with NaN): ['settle_f_lag1', 'settle_f_lag2', 'settle_f_lag7', 'vc_max_f_lag1', 'vc_max_f_lag7', 'delta_vcmax_lag1']
20:31:11 [INFO] models.training.ordinal_trainer:   Threshold +4: trained (pos_rate=25.4%)
20:31:12 [WARNING] models.training.base_trainer: Missing columns (will fill with NaN): ['settle_f_lag1', 'settle_f_lag2', 'settle_f_lag7', 'vc_max_f_lag1', 'vc_max_f_lag7', 'delta_vcmax_lag1']
20:31:14 [INFO] models.training.ordinal_trainer:   Threshold +5: trained (pos_rate=19.9%)
20:31:14 [WARNING] models.training.base_trainer: Missing columns (will fill with NaN): ['settle_f_lag1', 'settle_f_lag2', 'settle_f_lag7', 'vc_max_f_lag1', 'vc_max_f_lag7', 'delta_vcmax_lag1']
20:31:16 [INFO] models.training.ordinal_trainer:   Threshold +6: trained (pos_rate=16.9%)
20:31:16 [WARNING] models.training.base_trainer: Missing columns (will fill with NaN): ['settle_f_lag1', 'settle_f_lag2', 'settle_f_lag7', 'vc_max_f_lag1', 'vc_max_f_lag7', 'delta_vcmax_lag1']
20:31:18 [INFO] models.training.ordinal_trainer:   Threshold +7: trained (pos_rate=13.8%)
20:31:18 [WARNING] models.training.base_trainer: Missing columns (will fill with NaN): ['settle_f_lag1', 'settle_f_lag2', 'settle_f_lag7', 'vc_max_f_lag1', 'vc_max_f_lag7', 'delta_vcmax_lag1']
20:31:19 [INFO] models.training.ordinal_trainer:   Threshold +8: trained (pos_rate=11.8%)
20:31:19 [WARNING] models.training.base_trainer: Missing columns (will fill with NaN): ['settle_f_lag1', 'settle_f_lag2', 'settle_f_lag7', 'vc_max_f_lag1', 'vc_max_f_lag7', 'delta_vcmax_lag1']
20:31:21 [INFO] models.training.ordinal_trainer:   Threshold +9: trained (pos_rate=9.2%)
20:31:21 [WARNING] models.training.base_trainer: Missing columns (will fill with NaN): ['settle_f_lag1', 'settle_f_lag2', 'settle_f_lag7', 'vc_max_f_lag1', 'vc_max_f_lag7', 'delta_vcmax_lag1']
20:31:24 [INFO] models.training.ordinal_trainer:   Threshold +10: trained (pos_rate=8.0%)
20:31:24 [INFO] models.training.ordinal_trainer: Ordinal training complete: 20 classifiers
20:31:24 [WARNING] models.training.base_trainer: Missing columns (will fill with NaN): ['settle_f_lag1', 'settle_f_lag2', 'settle_f_lag7', 'vc_max_f_lag1', 'vc_max_f_lag7', 'delta_vcmax_lag1']
20:31:25 [INFO] models.training.ordinal_trainer: Saved ordinal model to models/saved/austin/ordinal_catboost_optuna.pkl
20:31:25 [INFO] __main__: 
Saved model to models/saved/austin/ordinal_catboost_optuna.pkl
20:31:25 [INFO] __main__: Saved best params to models/saved/austin/best_params.json
20:31:25 [INFO] __main__: Saved final metrics to models/saved/austin/final_metrics_austin.json

============================================================
EVALUATION
============================================================

Test Set Metrics:
----------------------------------------
  delta_accuracy: 0.2628
  delta_mae: 1.9643
  off_by_1_rate: 0.2686
  off_by_2plus_rate: 0.4685
  within_1_rate: 0.5315
  within_2_rate: 0.7295

============================================================
FEATURE IMPORTANCE
============================================================

Top 30 Features:
                     feature  importance
0           obs_fcst_max_gap   33.564465
1          num_samples_sofar   10.193258
2            above_fcst_flag    5.705943
3            fcst_prev_std_f    4.999999
4                   week_sin    2.926609
5          err_max_pos_sofar    2.890611
6                    doy_sin    2.773116
7            fcst_multi_mean    2.198269
8             fcst_multi_std    1.960794
9                    doy_cos    1.784319
10           fcst_prev_q75_f    1.714997
11       fcst_prev_frac_part    1.314795
12  pred_plateau_20min_sofar    1.281953
13           fcst_prev_q50_f    1.270254
14     fcst_prev_hour_of_max    1.241726
15           minutes_ge_base    1.225112
16     max_afternoon_f_sofar    1.173658
17       max_evening_f_sofar    1.119557
18                     month    1.115910
19            vc_max_f_sofar    1.082175
20           fcst_prev_q90_f    0.991689
21                  week_cos    0.973835
22           fcst_prev_max_f    0.964868
23             edge_max_flag    0.948513
24        vc_frac_part_sofar    0.841425
25                    t_base    0.811769
26      pred_floor_max_sofar    0.722775
27            vc_q90_f_sofar    0.682412
28        max_run_ge_base_m1    0.649731
29           t_forecast_base    0.585742

----------------------------------------
Multi-horizon feature importance:
             feature  importance
7    fcst_multi_mean    2.198269
8     fcst_multi_std    1.960794
81  fcst_multi_drift    0.000000
  fcst_multi_mean: rank 8/92
  fcst_multi_std: rank 9/92
  fcst_multi_drift: rank 82/92

============================================================
SUMMARY
============================================================
City: austin
Model: models/saved/austin/ordinal_catboost_optuna.pkl
Params: models/saved/austin/best_params.json
Metrics: models/saved/austin/final_metrics_austin.json
Training samples: 387,048
Test samples: 97,128
Optuna trials: 3
Best params: {'bootstrap_type': 'Bayesian', 'depth': 4, 'iterations': 355, 'learning_rate': 0.04370785966589845, 'border_count': 94, 'l2_leaf_reg': 5.420869976640164, 'min_data_in_leaf': 29, 'random_strength': 1.2756080300633206, 'colsample_bylevel': 0.6722757296297908, 'bagging_temperature': 0.14495089756686863}

Key Metrics:
  Accuracy: 26.3%
  MAE: 1.96
  Within 1: 53.1%
  Within 2: 72.9%

============================================================
DONE
============================================================
