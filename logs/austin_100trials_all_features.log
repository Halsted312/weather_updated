nohup: ignoring input
14:32:13 [INFO] __main__: ============================================================
14:32:13 [INFO] __main__: AUSTIN Optuna Training (100 trials)
14:32:13 [INFO] __main__: ============================================================
14:32:13 [INFO] src.db.connection: Database engine created: localhost:5434/kalshi_weather
14:32:14 [INFO] __main__: Available data: 2023-01-01 to 2025-11-27
14:32:14 [INFO] __main__: Total days: 1062
14:32:14 [INFO] __main__: Training: 2023-01-01 to 2025-04-28 (850 days)
14:32:14 [INFO] __main__: Testing:  2025-04-29 to 2025-11-27 (212 days)
14:32:14 [INFO] __main__: Loading cached datasets...
14:32:14 [INFO] __main__: Loaded train: 129,928 rows, test: 32,376 rows
14:32:14 [INFO] __main__: 
Training samples: 129,928
14:32:14 [INFO] __main__: Training days: 855
14:32:14 [INFO] __main__: Test samples: 32,376
14:32:14 [INFO] __main__: Test days: 213
14:32:14 [INFO] __main__: 
Station-city features: ['station_city_temp_gap', 'station_city_max_gap_sofar', 'station_city_mean_gap_sofar', 'station_city_gap_std', 'station_city_gap_trend']
14:32:14 [INFO] __main__:   station_city_temp_gap: 129,896/129,928 non-null (100.0%)
14:32:14 [INFO] __main__:   station_city_max_gap_sofar: 129,896/129,928 non-null (100.0%)
14:32:14 [INFO] __main__:   station_city_mean_gap_sofar: 129,896/129,928 non-null (100.0%)
14:32:14 [INFO] __main__:   station_city_gap_std: 129,896/129,928 non-null (100.0%)
14:32:14 [INFO] __main__:   station_city_gap_trend: 129,894/129,928 non-null (100.0%)
14:32:14 [INFO] __main__: 
Multi-horizon features: ['fcst_multi_mean', 'fcst_multi_median', 'fcst_multi_ema', 'fcst_multi_std', 'fcst_multi_range', 'fcst_multi_t1_t2_diff', 'fcst_multi_drift']
14:32:14 [INFO] __main__:   fcst_multi_mean: 129,928/129,928 non-null (100.0%)
14:32:14 [INFO] __main__:   fcst_multi_median: 129,928/129,928 non-null (100.0%)
14:32:14 [INFO] __main__:   fcst_multi_ema: 129,928/129,928 non-null (100.0%)
14:32:14 [INFO] __main__:   fcst_multi_std: 129,928/129,928 non-null (100.0%)
14:32:14 [INFO] __main__:   fcst_multi_range: 129,928/129,928 non-null (100.0%)
14:32:14 [INFO] __main__:   fcst_multi_t1_t2_diff: 129,928/129,928 non-null (100.0%)
14:32:14 [INFO] __main__:   fcst_multi_drift: 129,928/129,928 non-null (100.0%)
14:32:16 [INFO] models.training.ordinal_trainer: Training ordinal model (catboost) on 129928 samples
14:32:16 [INFO] models.training.ordinal_trainer: City delta range: [-10, 10]
14:32:16 [INFO] models.training.ordinal_trainer: Training 20 threshold classifiers: [-9, -8, -7, -6, -5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
14:32:16 [INFO] models.training.ordinal_trainer: Starting Optuna tuning with 100 trials

============================================================
OPTUNA TRAINING (100 trials)
============================================================
  0%|          | 0/100 [00:00<?, ?it/s]Best trial: 0. Best value: 0.896193:   0%|          | 0/100 [00:03<?, ?it/s]Best trial: 0. Best value: 0.896193:   1%|          | 1/100 [00:03<06:32,  3.97s/it]Best trial: 1. Best value: 0.899879:   1%|          | 1/100 [00:08<06:32,  3.97s/it]Best trial: 1. Best value: 0.899879:   2%|▏         | 2/100 [00:08<06:48,  4.17s/it]Best trial: 2. Best value: 0.903226:   2%|▏         | 2/100 [00:14<06:48,  4.17s/it]Best trial: 2. Best value: 0.903226:   3%|▎         | 3/100 [00:14<08:20,  5.16s/it]Best trial: 2. Best value: 0.903226:   3%|▎         | 3/100 [00:18<08:20,  5.16s/it]Best trial: 2. Best value: 0.903226:   4%|▍         | 4/100 [00:18<07:24,  4.63s/it]Best trial: 2. Best value: 0.903226:   4%|▍         | 4/100 [00:21<07:24,  4.63s/it]Best trial: 2. Best value: 0.903226:   5%|▌         | 5/100 [00:21<06:36,  4.17s/it]Best trial: 2. Best value: 0.903226:   5%|▌         | 5/100 [00:25<06:36,  4.17s/it]Best trial: 2. Best value: 0.903226:   6%|▌         | 6/100 [00:25<06:15,  3.99s/it]Best trial: 2. Best value: 0.903226:   6%|▌         | 6/100 [00:28<06:15,  3.99s/it]Best trial: 2. Best value: 0.903226:   7%|▋         | 7/100 [00:28<05:45,  3.72s/it]Best trial: 2. Best value: 0.903226:   7%|▋         | 7/100 [00:33<05:45,  3.72s/it]Best trial: 2. Best value: 0.903226:   8%|▊         | 8/100 [00:33<06:06,  3.99s/it]Best trial: 2. Best value: 0.903226:   8%|▊         | 8/100 [00:36<06:06,  3.99s/it]Best trial: 2. Best value: 0.903226:   9%|▉         | 9/100 [00:36<05:39,  3.73s/it]Best trial: 2. Best value: 0.903226:   9%|▉         | 9/100 [00:40<05:39,  3.73s/it]Best trial: 2. Best value: 0.903226:  10%|█         | 10/100 [00:40<05:58,  3.98s/it]Best trial: 2. Best value: 0.903226:  10%|█         | 10/100 [00:46<05:58,  3.98s/it]Best trial: 2. Best value: 0.903226:  11%|█         | 11/100 [00:46<06:48,  4.59s/it]Best trial: 2. Best value: 0.903226:  11%|█         | 11/100 [00:51<06:48,  4.59s/it]Best trial: 2. Best value: 0.903226:  12%|█▏        | 12/100 [00:51<06:38,  4.53s/it]Best trial: 2. Best value: 0.903226:  12%|█▏        | 12/100 [00:56<06:38,  4.53s/it]Best trial: 2. Best value: 0.903226:  13%|█▎        | 13/100 [00:56<06:43,  4.64s/it]Best trial: 2. Best value: 0.903226:  13%|█▎        | 13/100 [00:59<06:43,  4.64s/it]Best trial: 2. Best value: 0.903226:  14%|█▍        | 14/100 [00:59<06:12,  4.33s/it]Best trial: 2. Best value: 0.903226:  14%|█▍        | 14/100 [01:03<06:12,  4.33s/it]Best trial: 2. Best value: 0.903226:  15%|█▌        | 15/100 [01:03<05:58,  4.22s/it]Best trial: 2. Best value: 0.903226:  15%|█▌        | 15/100 [01:08<05:58,  4.22s/it]Best trial: 2. Best value: 0.903226:  16%|█▌        | 16/100 [01:08<06:01,  4.30s/it]Best trial: 16. Best value: 0.904929:  16%|█▌        | 16/100 [01:14<06:01,  4.30s/it]Best trial: 16. Best value: 0.904929:  17%|█▋        | 17/100 [01:14<06:36,  4.78s/it]Best trial: 16. Best value: 0.904929:  17%|█▋        | 17/100 [01:18<06:36,  4.78s/it]Best trial: 16. Best value: 0.904929:  18%|█▊        | 18/100 [01:18<06:28,  4.74s/it]Best trial: 16. Best value: 0.904929:  18%|█▊        | 18/100 [01:24<06:28,  4.74s/it]Best trial: 16. Best value: 0.904929:  19%|█▉        | 19/100 [01:24<06:46,  5.01s/it]Best trial: 16. Best value: 0.904929:  19%|█▉        | 19/100 [01:28<06:46,  5.01s/it]Best trial: 16. Best value: 0.904929:  20%|██        | 20/100 [01:28<06:17,  4.72s/it]Best trial: 16. Best value: 0.904929:  20%|██        | 20/100 [01:35<06:17,  4.72s/it]Best trial: 16. Best value: 0.904929:  21%|██        | 21/100 [01:35<07:05,  5.39s/it]Best trial: 16. Best value: 0.904929:  21%|██        | 21/100 [01:39<07:05,  5.39s/it]Best trial: 16. Best value: 0.904929:  22%|██▏       | 22/100 [01:39<06:42,  5.16s/it]Best trial: 16. Best value: 0.904929:  22%|██▏       | 22/100 [01:43<06:42,  5.16s/it]Best trial: 16. Best value: 0.904929:  23%|██▎       | 23/100 [01:43<05:58,  4.66s/it]Best trial: 16. Best value: 0.904929:  23%|██▎       | 23/100 [01:47<05:58,  4.66s/it]Best trial: 16. Best value: 0.904929:  24%|██▍       | 24/100 [01:47<05:41,  4.49s/it]Best trial: 16. Best value: 0.904929:  24%|██▍       | 24/100 [01:54<05:41,  4.49s/it]Best trial: 16. Best value: 0.904929:  25%|██▌       | 25/100 [01:54<06:28,  5.18s/it]Best trial: 16. Best value: 0.904929:  25%|██▌       | 25/100 [01:58<06:28,  5.18s/it]Best trial: 16. Best value: 0.904929:  26%|██▌       | 26/100 [01:58<05:55,  4.81s/it]Best trial: 16. Best value: 0.904929:  26%|██▌       | 26/100 [02:02<05:55,  4.81s/it]Best trial: 16. Best value: 0.904929:  27%|██▋       | 27/100 [02:02<05:26,  4.48s/it]Best trial: 16. Best value: 0.904929:  27%|██▋       | 27/100 [02:05<05:26,  4.48s/it]Best trial: 16. Best value: 0.904929:  28%|██▊       | 28/100 [02:05<04:55,  4.10s/it]Best trial: 16. Best value: 0.904929:  28%|██▊       | 28/100 [02:09<04:55,  4.10s/it]Best trial: 16. Best value: 0.904929:  29%|██▉       | 29/100 [02:09<05:00,  4.23s/it]Best trial: 16. Best value: 0.904929:  29%|██▉       | 29/100 [02:16<05:00,  4.23s/it]Best trial: 16. Best value: 0.904929:  30%|███       | 30/100 [02:16<05:44,  4.92s/it]Best trial: 30. Best value: 0.905319:  30%|███       | 30/100 [02:22<05:44,  4.92s/it]Best trial: 30. Best value: 0.905319:  31%|███       | 31/100 [02:22<06:15,  5.45s/it]Best trial: 30. Best value: 0.905319:  31%|███       | 31/100 [02:28<06:15,  5.45s/it]Best trial: 30. Best value: 0.905319:  32%|███▏      | 32/100 [02:28<06:11,  5.46s/it]Best trial: 30. Best value: 0.905319:  32%|███▏      | 32/100 [02:33<06:11,  5.46s/it]Best trial: 30. Best value: 0.905319:  33%|███▎      | 33/100 [02:33<06:02,  5.41s/it]Best trial: 30. Best value: 0.905319:  33%|███▎      | 33/100 [02:38<06:02,  5.41s/it]Best trial: 30. Best value: 0.905319:  34%|███▍      | 34/100 [02:38<05:39,  5.14s/it]Best trial: 30. Best value: 0.905319:  34%|███▍      | 34/100 [02:42<05:39,  5.14s/it]Best trial: 30. Best value: 0.905319:  35%|███▌      | 35/100 [02:42<05:08,  4.75s/it]Best trial: 30. Best value: 0.905319:  35%|███▌      | 35/100 [02:48<05:08,  4.75s/it]Best trial: 30. Best value: 0.905319:  36%|███▌      | 36/100 [02:48<05:27,  5.12s/it]Best trial: 30. Best value: 0.905319:  36%|███▌      | 36/100 [02:53<05:27,  5.12s/it]Best trial: 30. Best value: 0.905319:  37%|███▋      | 37/100 [02:53<05:23,  5.13s/it]Best trial: 30. Best value: 0.905319:  37%|███▋      | 37/100 [02:58<05:23,  5.13s/it]Best trial: 30. Best value: 0.905319:  38%|███▊      | 38/100 [02:58<05:25,  5.24s/it]Best trial: 30. Best value: 0.905319:  38%|███▊      | 38/100 [03:03<05:25,  5.24s/it]Best trial: 30. Best value: 0.905319:  39%|███▉      | 39/100 [03:03<05:12,  5.11s/it]Best trial: 30. Best value: 0.905319:  39%|███▉      | 39/100 [03:07<05:12,  5.11s/it]Best trial: 30. Best value: 0.905319:  40%|████      | 40/100 [03:07<04:54,  4.90s/it]Best trial: 30. Best value: 0.905319:  40%|████      | 40/100 [03:13<04:54,  4.90s/it]Best trial: 30. Best value: 0.905319:  41%|████      | 41/100 [03:13<04:59,  5.07s/it]Best trial: 30. Best value: 0.905319:  41%|████      | 41/100 [03:17<04:59,  5.07s/it]Best trial: 30. Best value: 0.905319:  42%|████▏     | 42/100 [03:17<04:32,  4.70s/it]Best trial: 30. Best value: 0.905319:  42%|████▏     | 42/100 [03:20<04:32,  4.70s/it]Best trial: 30. Best value: 0.905319:  43%|████▎     | 43/100 [03:20<04:06,  4.32s/it]Best trial: 30. Best value: 0.905319:  43%|████▎     | 43/100 [03:23<04:06,  4.32s/it]Best trial: 30. Best value: 0.905319:  44%|████▍     | 44/100 [03:23<03:43,  4.00s/it]Best trial: 30. Best value: 0.905319:  44%|████▍     | 44/100 [03:29<03:43,  4.00s/it]Best trial: 30. Best value: 0.905319:  45%|████▌     | 45/100 [03:29<04:07,  4.51s/it]Best trial: 30. Best value: 0.905319:  45%|████▌     | 45/100 [03:33<04:07,  4.51s/it]Best trial: 30. Best value: 0.905319:  46%|████▌     | 46/100 [03:33<03:51,  4.28s/it]Best trial: 30. Best value: 0.905319:  46%|████▌     | 46/100 [03:36<03:51,  4.28s/it]Best trial: 30. Best value: 0.905319:  47%|████▋     | 47/100 [03:36<03:28,  3.93s/it]Best trial: 30. Best value: 0.905319:  47%|████▋     | 47/100 [03:42<03:28,  3.93s/it]Best trial: 30. Best value: 0.905319:  48%|████▊     | 48/100 [03:42<04:00,  4.63s/it]Best trial: 30. Best value: 0.905319:  48%|████▊     | 48/100 [03:48<04:00,  4.63s/it]Best trial: 30. Best value: 0.905319:  49%|████▉     | 49/100 [03:48<04:05,  4.82s/it]Best trial: 49. Best value: 0.907621:  49%|████▉     | 49/100 [03:52<04:05,  4.82s/it]Best trial: 49. Best value: 0.907621:  50%|█████     | 50/100 [03:52<03:58,  4.77s/it]Best trial: 49. Best value: 0.907621:  50%|█████     | 50/100 [03:57<03:58,  4.77s/it]Best trial: 49. Best value: 0.907621:  51%|█████     | 51/100 [03:57<03:50,  4.70s/it]Best trial: 49. Best value: 0.907621:  51%|█████     | 51/100 [04:01<03:50,  4.70s/it]Best trial: 49. Best value: 0.907621:  52%|█████▏    | 52/100 [04:01<03:34,  4.48s/it]Best trial: 49. Best value: 0.907621:  52%|█████▏    | 52/100 [04:04<03:34,  4.48s/it]Best trial: 49. Best value: 0.907621:  53%|█████▎    | 53/100 [04:04<03:18,  4.23s/it]Best trial: 49. Best value: 0.907621:  53%|█████▎    | 53/100 [04:12<03:18,  4.23s/it]Best trial: 49. Best value: 0.907621:  54%|█████▍    | 54/100 [04:12<04:01,  5.25s/it]Best trial: 49. Best value: 0.907621:  54%|█████▍    | 54/100 [04:16<04:01,  5.25s/it]Best trial: 49. Best value: 0.907621:  55%|█████▌    | 55/100 [04:16<03:39,  4.88s/it]Best trial: 49. Best value: 0.907621:  55%|█████▌    | 55/100 [04:20<03:39,  4.88s/it]Best trial: 49. Best value: 0.907621:  56%|█████▌    | 56/100 [04:20<03:19,  4.53s/it]Best trial: 49. Best value: 0.907621:  56%|█████▌    | 56/100 [04:25<03:19,  4.53s/it]Best trial: 49. Best value: 0.907621:  57%|█████▋    | 57/100 [04:25<03:24,  4.76s/it]Best trial: 49. Best value: 0.907621:  57%|█████▋    | 57/100 [04:29<03:24,  4.76s/it]Best trial: 49. Best value: 0.907621:  58%|█████▊    | 58/100 [04:29<03:11,  4.55s/it]Best trial: 49. Best value: 0.907621:  58%|█████▊    | 58/100 [04:36<03:11,  4.55s/it]Best trial: 49. Best value: 0.907621:  59%|█████▉    | 59/100 [04:36<03:32,  5.18s/it]Best trial: 49. Best value: 0.907621:  59%|█████▉    | 59/100 [04:40<03:32,  5.18s/it]Best trial: 49. Best value: 0.907621:  60%|██████    | 60/100 [04:40<03:16,  4.90s/it]Best trial: 49. Best value: 0.907621:  60%|██████    | 60/100 [04:45<03:16,  4.90s/it]Best trial: 49. Best value: 0.907621:  61%|██████    | 61/100 [04:45<03:16,  5.03s/it]Best trial: 49. Best value: 0.907621:  61%|██████    | 61/100 [04:50<03:16,  5.03s/it]Best trial: 49. Best value: 0.907621:  62%|██████▏   | 62/100 [04:50<03:02,  4.79s/it]Best trial: 49. Best value: 0.907621:  62%|██████▏   | 62/100 [04:53<03:02,  4.79s/it]Best trial: 49. Best value: 0.907621:  63%|██████▎   | 63/100 [04:53<02:46,  4.51s/it]Best trial: 49. Best value: 0.907621:  63%|██████▎   | 63/100 [04:57<02:46,  4.51s/it]Best trial: 49. Best value: 0.907621:  64%|██████▍   | 64/100 [04:57<02:37,  4.39s/it]Best trial: 49. Best value: 0.907621:  64%|██████▍   | 64/100 [05:02<02:37,  4.39s/it]Best trial: 49. Best value: 0.907621:  65%|██████▌   | 65/100 [05:02<02:37,  4.49s/it]Best trial: 49. Best value: 0.907621:  65%|██████▌   | 65/100 [05:06<02:37,  4.49s/it]Best trial: 49. Best value: 0.907621:  66%|██████▌   | 66/100 [05:06<02:29,  4.41s/it]Best trial: 49. Best value: 0.907621:  66%|██████▌   | 66/100 [05:11<02:29,  4.41s/it]Best trial: 49. Best value: 0.907621:  67%|██████▋   | 67/100 [05:11<02:28,  4.49s/it]Best trial: 67. Best value: 0.908857:  67%|██████▋   | 67/100 [05:16<02:28,  4.49s/it]Best trial: 67. Best value: 0.908857:  68%|██████▊   | 68/100 [05:16<02:28,  4.65s/it]Best trial: 67. Best value: 0.908857:  68%|██████▊   | 68/100 [05:20<02:28,  4.65s/it]Best trial: 67. Best value: 0.908857:  69%|██████▉   | 69/100 [05:20<02:19,  4.51s/it]Best trial: 67. Best value: 0.908857:  69%|██████▉   | 69/100 [05:24<02:19,  4.51s/it]Best trial: 67. Best value: 0.908857:  70%|███████   | 70/100 [05:24<02:07,  4.25s/it]Best trial: 67. Best value: 0.908857:  70%|███████   | 70/100 [05:28<02:07,  4.25s/it]Best trial: 67. Best value: 0.908857:  71%|███████   | 71/100 [05:28<02:01,  4.18s/it]Best trial: 67. Best value: 0.908857:  71%|███████   | 71/100 [05:32<02:01,  4.18s/it]Best trial: 67. Best value: 0.908857:  72%|███████▏  | 72/100 [05:32<01:57,  4.21s/it]Best trial: 67. Best value: 0.908857:  72%|███████▏  | 72/100 [05:36<01:57,  4.21s/it]Best trial: 67. Best value: 0.908857:  73%|███████▎  | 73/100 [05:36<01:47,  4.00s/it]Best trial: 67. Best value: 0.908857:  73%|███████▎  | 73/100 [05:40<01:47,  4.00s/it]Best trial: 67. Best value: 0.908857:  74%|███████▍  | 74/100 [05:40<01:49,  4.20s/it]Best trial: 67. Best value: 0.908857:  74%|███████▍  | 74/100 [05:44<01:49,  4.20s/it]Best trial: 67. Best value: 0.908857:  75%|███████▌  | 75/100 [05:44<01:42,  4.09s/it]Best trial: 67. Best value: 0.908857:  75%|███████▌  | 75/100 [05:48<01:42,  4.09s/it]Best trial: 67. Best value: 0.908857:  76%|███████▌  | 76/100 [05:48<01:35,  3.98s/it]Best trial: 67. Best value: 0.908857:  76%|███████▌  | 76/100 [05:52<01:35,  3.98s/it]Best trial: 67. Best value: 0.908857:  77%|███████▋  | 77/100 [05:52<01:35,  4.14s/it]Best trial: 67. Best value: 0.908857:  77%|███████▋  | 77/100 [05:57<01:35,  4.14s/it]Best trial: 67. Best value: 0.908857:  78%|███████▊  | 78/100 [05:57<01:34,  4.32s/it]Best trial: 67. Best value: 0.908857:  78%|███████▊  | 78/100 [06:03<01:34,  4.32s/it]Best trial: 67. Best value: 0.908857:  79%|███████▉  | 79/100 [06:03<01:41,  4.82s/it]Best trial: 67. Best value: 0.908857:  79%|███████▉  | 79/100 [06:07<01:41,  4.82s/it]Best trial: 67. Best value: 0.908857:  80%|████████  | 80/100 [06:07<01:30,  4.52s/it]Best trial: 67. Best value: 0.908857:  80%|████████  | 80/100 [06:10<01:30,  4.52s/it]Best trial: 67. Best value: 0.908857:  81%|████████  | 81/100 [06:10<01:19,  4.18s/it]Best trial: 67. Best value: 0.908857:  81%|████████  | 81/100 [06:15<01:19,  4.18s/it]Best trial: 67. Best value: 0.908857:  82%|████████▏ | 82/100 [06:15<01:17,  4.29s/it]Best trial: 67. Best value: 0.908857:  82%|████████▏ | 82/100 [06:19<01:17,  4.29s/it]Best trial: 67. Best value: 0.908857:  83%|████████▎ | 83/100 [06:19<01:14,  4.35s/it]Best trial: 67. Best value: 0.908857:  83%|████████▎ | 83/100 [06:24<01:14,  4.35s/it]Best trial: 67. Best value: 0.908857:  84%|████████▍ | 84/100 [06:24<01:09,  4.33s/it]Best trial: 67. Best value: 0.908857:  84%|████████▍ | 84/100 [06:29<01:09,  4.33s/it]Best trial: 67. Best value: 0.908857:  85%|████████▌ | 85/100 [06:29<01:08,  4.57s/it]Best trial: 67. Best value: 0.908857:  85%|████████▌ | 85/100 [06:33<01:08,  4.57s/it]Best trial: 67. Best value: 0.908857:  86%|████████▌ | 86/100 [06:33<01:02,  4.47s/it]Best trial: 67. Best value: 0.908857:  86%|████████▌ | 86/100 [06:37<01:02,  4.47s/it]Best trial: 67. Best value: 0.908857:  87%|████████▋ | 87/100 [06:37<00:54,  4.22s/it]Best trial: 67. Best value: 0.908857:  87%|████████▋ | 87/100 [06:40<00:54,  4.22s/it]Best trial: 67. Best value: 0.908857:  88%|████████▊ | 88/100 [06:40<00:48,  4.01s/it]Best trial: 67. Best value: 0.908857:  88%|████████▊ | 88/100 [06:46<00:48,  4.01s/it]Best trial: 67. Best value: 0.908857:  89%|████████▉ | 89/100 [06:46<00:50,  4.55s/it]Best trial: 67. Best value: 0.908857:  89%|████████▉ | 89/100 [06:50<00:50,  4.55s/it]Best trial: 67. Best value: 0.908857:  90%|█████████ | 90/100 [06:50<00:45,  4.50s/it]Best trial: 67. Best value: 0.908857:  90%|█████████ | 90/100 [06:56<00:45,  4.50s/it]Best trial: 67. Best value: 0.908857:  91%|█████████ | 91/100 [06:56<00:43,  4.83s/it]Best trial: 67. Best value: 0.908857:  91%|█████████ | 91/100 [07:01<00:43,  4.83s/it]Best trial: 67. Best value: 0.908857:  92%|█████████▏| 92/100 [07:01<00:39,  4.94s/it]Best trial: 67. Best value: 0.908857:  92%|█████████▏| 92/100 [07:08<00:39,  4.94s/it]Best trial: 67. Best value: 0.908857:  93%|█████████▎| 93/100 [07:08<00:39,  5.58s/it]Best trial: 67. Best value: 0.908857:  93%|█████████▎| 93/100 [07:14<00:39,  5.58s/it]Best trial: 67. Best value: 0.908857:  94%|█████████▍| 94/100 [07:14<00:32,  5.49s/it]Best trial: 67. Best value: 0.908857:  94%|█████████▍| 94/100 [07:23<00:32,  5.49s/it]Best trial: 67. Best value: 0.908857:  95%|█████████▌| 95/100 [07:23<00:32,  6.58s/it]Best trial: 67. Best value: 0.908857:  95%|█████████▌| 95/100 [07:27<00:32,  6.58s/it]Best trial: 67. Best value: 0.908857:  96%|█████████▌| 96/100 [07:27<00:24,  6.03s/it]Best trial: 67. Best value: 0.908857:  96%|█████████▌| 96/100 [07:34<00:24,  6.03s/it]Best trial: 67. Best value: 0.908857:  97%|█████████▋| 97/100 [07:34<00:18,  6.20s/it]Best trial: 67. Best value: 0.908857:  97%|█████████▋| 97/100 [07:41<00:18,  6.20s/it]Best trial: 67. Best value: 0.908857:  98%|█████████▊| 98/100 [07:41<00:12,  6.29s/it]Best trial: 67. Best value: 0.908857:  98%|█████████▊| 98/100 [07:45<00:12,  6.29s/it]Best trial: 67. Best value: 0.908857:  99%|█████████▉| 99/100 [07:45<00:05,  5.80s/it]Best trial: 67. Best value: 0.908857:  99%|█████████▉| 99/100 [07:51<00:05,  5.80s/it]Best trial: 67. Best value: 0.908857: 100%|██████████| 100/100 [07:51<00:00,  5.74s/it]Best trial: 67. Best value: 0.908857: 100%|██████████| 100/100 [07:51<00:00,  4.71s/it]
14:40:07 [INFO] models.training.ordinal_trainer: Best params: {'bootstrap_type': 'Bayesian', 'depth': 7, 'iterations': 288, 'learning_rate': 0.04367780297897269, 'border_count': 44, 'l2_leaf_reg': 5.797728866380467, 'min_data_in_leaf': 12, 'random_strength': 1.7928441287391275, 'colsample_bylevel': 0.500026845784181, 'bagging_temperature': 0.8416275189327992}
14:40:07 [INFO] models.training.ordinal_trainer: Best AUC: 0.9089
14:40:07 [WARNING] models.training.ordinal_trainer: Threshold -9: extreme imbalance (pos_rate=1.0000), using constant predictor
14:40:07 [WARNING] models.training.ordinal_trainer: Threshold -8: extreme imbalance (pos_rate=1.0000), using constant predictor
14:40:07 [WARNING] models.training.ordinal_trainer: Threshold -7: extreme imbalance (pos_rate=1.0000), using constant predictor
14:40:07 [WARNING] models.training.ordinal_trainer: Threshold -6: extreme imbalance (pos_rate=1.0000), using constant predictor
14:40:07 [WARNING] models.training.ordinal_trainer: Threshold -5: extreme imbalance (pos_rate=1.0000), using constant predictor
14:40:07 [WARNING] models.training.ordinal_trainer: Threshold -4: extreme imbalance (pos_rate=1.0000), using constant predictor
14:40:07 [WARNING] models.training.ordinal_trainer: Threshold -3: extreme imbalance (pos_rate=1.0000), using constant predictor
14:40:07 [WARNING] models.training.ordinal_trainer: Threshold -2: extreme imbalance (pos_rate=1.0000), using constant predictor
14:40:09 [INFO] models.training.ordinal_trainer:   Threshold -1: trained (pos_rate=71.0%)
14:40:11 [INFO] models.training.ordinal_trainer:   Threshold +0: trained (pos_rate=65.1%)
14:40:12 [INFO] models.training.ordinal_trainer:   Threshold +1: trained (pos_rate=46.6%)
14:40:14 [INFO] models.training.ordinal_trainer:   Threshold +2: trained (pos_rate=38.3%)
14:40:14 [INFO] models.training.ordinal_trainer:   Threshold +3: trained (pos_rate=30.4%)
14:40:16 [INFO] models.training.ordinal_trainer:   Threshold +4: trained (pos_rate=25.6%)
14:40:17 [INFO] models.training.ordinal_trainer:   Threshold +5: trained (pos_rate=20.0%)
14:40:18 [INFO] models.training.ordinal_trainer:   Threshold +6: trained (pos_rate=17.1%)
14:40:19 [INFO] models.training.ordinal_trainer:   Threshold +7: trained (pos_rate=13.9%)
14:40:20 [INFO] models.training.ordinal_trainer:   Threshold +8: trained (pos_rate=11.9%)
14:40:21 [INFO] models.training.ordinal_trainer:   Threshold +9: trained (pos_rate=9.4%)
14:40:22 [INFO] models.training.ordinal_trainer:   Threshold +10: trained (pos_rate=8.1%)
14:40:22 [INFO] models.training.ordinal_trainer: Ordinal training complete: 20 classifiers
14:40:22 [INFO] models.training.ordinal_trainer: Saved ordinal model to models/saved/austin/ordinal_catboost_optuna.pkl
14:40:22 [INFO] __main__: 
Saved model to models/saved/austin/ordinal_catboost_optuna.pkl
14:40:22 [INFO] __main__: Saved best params to models/saved/austin/best_params.json
14:40:22 [INFO] __main__: Saved final metrics to models/saved/austin/final_metrics_austin.json

============================================================
EVALUATION
============================================================

Test Set Metrics:
----------------------------------------
  delta_accuracy: 0.2548
  delta_mae: 2.4142
  off_by_1_rate: 0.2675
  off_by_2plus_rate: 0.4777
  within_1_rate: 0.5223
  within_2_rate: 0.6961

============================================================
FEATURE IMPORTANCE
============================================================
Traceback (most recent call last):
  File "/mnt/slow_weather_updated/scripts/train_city_ordinal_optuna.py", line 436, in <module>
    sys.exit(main())
             ^^^^^^
  File "/mnt/slow_weather_updated/scripts/train_city_ordinal_optuna.py", line 384, in main
    fi = trainer.get_feature_importance()
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/slow_weather_updated/models/training/ordinal_trainer.py", line 542, in get_feature_importance
    imp = clf.get_feature_importance()
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'dict' object has no attribute 'get_feature_importance'
